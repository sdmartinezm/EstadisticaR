<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 17 Análisis de varianza | Estadística aplicada con R</title>
  <meta name="description" content="Capítulo 17 Análisis de varianza | Estadística aplicada con R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 17 Análisis de varianza | Estadística aplicada con R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 17 Análisis de varianza | Estadística aplicada con R" />
  
  
  



<meta name="date" content="2021-05-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon" />
<link rel="prev" href="interacciones-y-predictores-categóricos.html"/>
<link rel="next" href="diagnóstico-de-modelos.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística aplicada con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#convenciones"><i class="fa fa-check"></i><b>1.1</b> Convenciones</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>3</b> Introducción a <code>R</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#primeros-pasos"><i class="fa fa-check"></i><b>3.1</b> Primeros pasos</a></li>
<li class="chapter" data-level="3.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#cálculos-básicos"><i class="fa fa-check"></i><b>3.2</b> Cálculos básicos</a></li>
<li class="chapter" data-level="3.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#obteniendo-ayuda"><i class="fa fa-check"></i><b>3.3</b> Obteniendo ayuda</a></li>
<li class="chapter" data-level="3.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>3.4</b> Instalación de paquetes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datos-y-programación.html"><a href="datos-y-programación.html"><i class="fa fa-check"></i><b>4</b> Datos y programación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#tipos-de-datos"><i class="fa fa-check"></i><b>4.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="4.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#estructuras-de-datos"><i class="fa fa-check"></i><b>4.2</b> Estructuras de datos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectores"><i class="fa fa-check"></i><b>4.2.1</b> Vectores</a></li>
<li class="chapter" data-level="4.2.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectorización"><i class="fa fa-check"></i><b>4.2.2</b> Vectorización</a></li>
<li class="chapter" data-level="4.2.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#operadores-logicos"><i class="fa fa-check"></i><b>4.2.3</b> Operadores logicos</a></li>
<li class="chapter" data-level="4.2.4" data-path="datos-y-programación.html"><a href="datos-y-programación.html#más-vectorización"><i class="fa fa-check"></i><b>4.2.4</b> Más vectorización</a></li>
<li class="chapter" data-level="4.2.5" data-path="datos-y-programación.html"><a href="datos-y-programación.html#matrices"><i class="fa fa-check"></i><b>4.2.5</b> Matrices</a></li>
<li class="chapter" data-level="4.2.6" data-path="datos-y-programación.html"><a href="datos-y-programación.html#listas"><i class="fa fa-check"></i><b>4.2.6</b> Listas</a></li>
<li class="chapter" data-level="4.2.7" data-path="datos-y-programación.html"><a href="datos-y-programación.html#marcos-de-datos"><i class="fa fa-check"></i><b>4.2.7</b> Marcos de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#conceptos-básicos-de-programación"><i class="fa fa-check"></i><b>4.3</b> Conceptos básicos de programación</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#flujo-de-control"><i class="fa fa-check"></i><b>4.3.1</b> Flujo de control</a></li>
<li class="chapter" data-level="4.3.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#funciones"><i class="fa fa-check"></i><b>4.3.2</b> Funciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>5</b> Literature</a></li>
<li class="chapter" data-level="6" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>6</b> Methods</a></li>
<li class="chapter" data-level="7" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html"><i class="fa fa-check"></i><b>7</b> Resumen de datos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#resumen-estadístico"><i class="fa fa-check"></i><b>7.1</b> Resumen estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#tendencia-central"><i class="fa fa-check"></i>Tendencia central</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#dispersión"><i class="fa fa-check"></i>Dispersión</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#categórica"><i class="fa fa-check"></i>Categórica</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#graficas"><i class="fa fa-check"></i><b>7.2</b> Graficas</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#histogramas"><i class="fa fa-check"></i><b>7.2.1</b> Histogramas</a></li>
<li class="chapter" data-level="7.2.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-barras"><i class="fa fa-check"></i><b>7.2.2</b> Gráfico de barras</a></li>
<li class="chapter" data-level="7.2.3" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#diagramas-de-cajas"><i class="fa fa-check"></i><b>7.2.3</b> Diagramas de cajas</a></li>
<li class="chapter" data-level="7.2.4" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-dispersión"><i class="fa fa-check"></i><b>7.2.4</b> Gráfico de dispersión</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>8</b> Applications</a>
<ul>
<li class="chapter" data-level="8.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>8.1</b> Example one</a></li>
<li class="chapter" data-level="8.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>8.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html"><i class="fa fa-check"></i><b>9</b> Probabilidad y estadística en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#probabilidad-en-r"><i class="fa fa-check"></i><b>9.1</b> Probabilidad en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribuciones"><i class="fa fa-check"></i><b>9.1.1</b> Distribuciones</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#pruebas-de-hipótesis-en-r"><i class="fa fa-check"></i><b>9.2</b> Pruebas de hipótesis en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-revisión"><i class="fa fa-check"></i><b>9.2.1</b> Prueba t de una muestra: revisión</a></li>
<li class="chapter" data-level="9.2.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-ejemplo"><i class="fa fa-check"></i><b>9.2.2</b> Prueba t de una muestra: ejemplo</a></li>
<li class="chapter" data-level="9.2.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-revisión"><i class="fa fa-check"></i><b>9.2.3</b> Prueba t de dos muestras: revisión</a></li>
<li class="chapter" data-level="9.2.4" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-ejemplo"><i class="fa fa-check"></i><b>9.2.4</b> Prueba t de dos muestras: Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#simulación"><i class="fa fa-check"></i><b>9.3</b> Simulación</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#diferencias-emparejadas"><i class="fa fa-check"></i><b>9.3.1</b> Diferencias emparejadas</a></li>
<li class="chapter" data-level="9.3.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribución-de-una-media-muestral"><i class="fa fa-check"></i><b>9.3.2</b> Distribución de una media muestral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="recursos-r.html"><a href="recursos-r.html"><i class="fa fa-check"></i><b>10</b> Recursos <code>R</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="recursos-r.html"><a href="recursos-r.html#referencias-y-tutoriales-para-principiantes"><i class="fa fa-check"></i><b>10.1</b> Referencias y tutoriales para principiantes</a></li>
<li class="chapter" data-level="10.2" data-path="recursos-r.html"><a href="recursos-r.html#referencias-intermedias"><i class="fa fa-check"></i><b>10.2</b> Referencias intermedias</a></li>
<li class="chapter" data-level="10.3" data-path="recursos-r.html"><a href="recursos-r.html#referencias-avanzadas"><i class="fa fa-check"></i><b>10.3</b> Referencias avanzadas</a></li>
<li class="chapter" data-level="10.4" data-path="recursos-r.html"><a href="recursos-r.html#comparaciones-rápidas-con-otros-lenguajes"><i class="fa fa-check"></i><b>10.4</b> Comparaciones rápidas con otros lenguajes</a></li>
<li class="chapter" data-level="10.5" data-path="recursos-r.html"><a href="recursos-r.html#vídeos-de-rstudio-y-rmarkdown"><i class="fa fa-check"></i><b>10.5</b> Vídeos de RStudio y RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>11</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="12" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html"><i class="fa fa-check"></i><b>12</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="12.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelado"><i class="fa fa-check"></i><b>12.1</b> Modelado</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelo-de-regresión-lineal-simple"><i class="fa fa-check"></i><b>12.1.1</b> Modelo de regresión lineal simple</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-mínimos-cuadrados"><i class="fa fa-check"></i><b>12.2</b> Enfoque de mínimos cuadrados</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#haciendo-predicciones"><i class="fa fa-check"></i><b>12.2.1</b> Haciendo predicciones</a></li>
<li class="chapter" data-level="12.2.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#residuales"><i class="fa fa-check"></i><b>12.2.2</b> Residuales</a></li>
<li class="chapter" data-level="12.2.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#estimación-de-la-varianza"><i class="fa fa-check"></i><b>12.2.3</b> Estimación de la varianza</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#descomposición-de-variación"><i class="fa fa-check"></i><b>12.3</b> Descomposición de variación</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>12.3.1</b> Coeficiente de determinación</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#la-función-lm"><i class="fa fa-check"></i><b>12.4</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="12.5" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-estimación-de-máxima-verosimilitud-mle"><i class="fa fa-check"></i><b>12.5</b> Enfoque de estimación de máxima verosimilitud (MLE)</a></li>
<li class="chapter" data-level="12.6" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#simulando-slr"><i class="fa fa-check"></i><b>12.6</b> Simulando SLR</a></li>
<li class="chapter" data-level="12.7" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#historia"><i class="fa fa-check"></i><b>12.7</b> Historia</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html"><i class="fa fa-check"></i><b>13</b> Inferencia para regresión lineal simple</a>
<ul>
<li class="chapter" data-level="13.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#teorema-de-gauss-markov"><i class="fa fa-check"></i><b>13.1</b> Teorema de Gauss-Markov</a></li>
<li class="chapter" data-level="13.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#distribuciones-muestrales"><i class="fa fa-check"></i><b>13.2</b> Distribuciones muestrales</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#simular-distribuciones-muestrales"><i class="fa fa-check"></i><b>13.2.1</b> Simular distribuciones muestrales</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#errores-estándar"><i class="fa fa-check"></i><b>13.3</b> Errores estándar</a></li>
<li class="chapter" data-level="13.4" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-para-pendiente-e-intercepto"><i class="fa fa-check"></i><b>13.4</b> Intervalos de confianza para pendiente e Intercepto</a></li>
<li class="chapter" data-level="13.5" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>13.5</b> Pruebas de hipótesis</a></li>
<li class="chapter" data-level="13.6" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#ejemplo-cars"><i class="fa fa-check"></i><b>13.6</b> Ejemplo <code>cars</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-en-r"><i class="fa fa-check"></i><b>13.6.1</b> Pruebas en <code>R</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-t."><i class="fa fa-check"></i><b>13.6.2</b> Significancia de la regresión, prueba t.</a></li>
<li class="chapter" data-level="13.6.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-en-r"><i class="fa fa-check"></i><b>13.6.3</b> Intervalos de confianza en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>13.7</b> Intervalo de confianza para la respuesta Promedio</a></li>
<li class="chapter" data-level="13.8" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-predicción-para-nuevas-observaciones"><i class="fa fa-check"></i><b>13.8</b> Intervalo de predicción para nuevas observaciones</a></li>
<li class="chapter" data-level="13.9" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#bandas-de-confianza-y-predicción"><i class="fa fa-check"></i><b>13.9</b> Bandas de confianza y predicción</a></li>
<li class="chapter" data-level="13.10" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-f"><i class="fa fa-check"></i><b>13.10</b> Significancia de la regresión, prueba F</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>14</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="14.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#enfoque-matricial-para-la-regresión"><i class="fa fa-check"></i><b>14.1</b> Enfoque matricial para la regresión</a></li>
<li class="chapter" data-level="14.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#distribución-muestral"><i class="fa fa-check"></i><b>14.2</b> Distribución muestral</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#pruebas-de-un-solo-parámetro"><i class="fa fa-check"></i><b>14.2.1</b> Pruebas de un solo parámetro</a></li>
<li class="chapter" data-level="14.2.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>14.2.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="14.2.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza-para-la-respuesta-media"><i class="fa fa-check"></i><b>14.2.3</b> Intervalos de confianza para la respuesta media</a></li>
<li class="chapter" data-level="14.2.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-predicción"><i class="fa fa-check"></i><b>14.2.4</b> Intervalos de predicción</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#significancia-de-la-regresión"><i class="fa fa-check"></i><b>14.3</b> Significancia de la regresión</a></li>
<li class="chapter" data-level="14.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#modelos-anidados"><i class="fa fa-check"></i><b>14.4</b> Modelos anidados</a></li>
<li class="chapter" data-level="14.5" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#simulación-1"><i class="fa fa-check"></i><b>14.5</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html"><i class="fa fa-check"></i><b>15</b> Construcción del modelo</a>
<ul>
<li class="chapter" data-level="15.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia-forma-y-ajuste."><i class="fa fa-check"></i><b>15.1</b> Familia, forma, y ajuste.</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#ajuste."><i class="fa fa-check"></i><b>15.1.1</b> Ajuste.</a></li>
<li class="chapter" data-level="15.1.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#forma"><i class="fa fa-check"></i><b>15.1.2</b> Forma</a></li>
<li class="chapter" data-level="15.1.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia"><i class="fa fa-check"></i><b>15.1.3</b> Familia</a></li>
<li class="chapter" data-level="15.1.4" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#modelo-asumido-modelo-ajustado"><i class="fa fa-check"></i><b>15.1.4</b> Modelo asumido, modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación-versus-predicción"><i class="fa fa-check"></i><b>15.2</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación"><i class="fa fa-check"></i><b>15.2.1</b> Explicación</a></li>
<li class="chapter" data-level="15.2.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#predicción"><i class="fa fa-check"></i><b>15.2.2</b> Predicción</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#resumen"><i class="fa fa-check"></i><b>15.3</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html"><i class="fa fa-check"></i><b>16</b> Interacciones y predictores categóricos</a>
<ul>
<li class="chapter" data-level="16.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-ficticias-dummy"><i class="fa fa-check"></i><b>16.1</b> Variables ficticias (Dummy)</a></li>
<li class="chapter" data-level="16.2" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#interacciones"><i class="fa fa-check"></i><b>16.2</b> Interacciones</a></li>
<li class="chapter" data-level="16.3" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-factor"><i class="fa fa-check"></i><b>16.3</b> Variables factor</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#factores-con-más-de-dos-niveles"><i class="fa fa-check"></i><b>16.3.1</b> Factores con más de dos niveles</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#parametrización"><i class="fa fa-check"></i><b>16.4</b> Parametrización</a></li>
<li class="chapter" data-level="16.5" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#construcción-de-modelos-más-grandes"><i class="fa fa-check"></i><b>16.5</b> Construcción de modelos más grandes</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html"><i class="fa fa-check"></i><b>17</b> Análisis de varianza</a>
<ul>
<li class="chapter" data-level="17.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#experimentos"><i class="fa fa-check"></i><b>17.1</b> Experimentos</a></li>
<li class="chapter" data-level="17.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#prueba-t-de-dos-muestras"><i class="fa fa-check"></i><b>17.2</b> Prueba t de dos muestras</a></li>
<li class="chapter" data-level="17.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-una-vía"><i class="fa fa-check"></i><b>17.3</b> ANOVA de una vía</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#variables-factor-1"><i class="fa fa-check"></i><b>17.3.1</b> Variables factor</a></li>
<li class="chapter" data-level="17.3.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#algo-de-simulación"><i class="fa fa-check"></i><b>17.3.2</b> Algo de simulación</a></li>
<li class="chapter" data-level="17.3.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#potencia"><i class="fa fa-check"></i><b>17.3.3</b> Potencia</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#pruebas-post-hoc"><i class="fa fa-check"></i><b>17.4</b> Pruebas Post Hoc</a></li>
<li class="chapter" data-level="17.5" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-dos-vías"><i class="fa fa-check"></i><b>17.5</b> ANOVA de dos vías</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html"><i class="fa fa-check"></i><b>18</b> Diagnóstico de modelos</a>
<ul>
<li class="chapter" data-level="18.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#supuestos-del-modelo"><i class="fa fa-check"></i><b>18.1</b> Supuestos del modelo</a></li>
<li class="chapter" data-level="18.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#comprobación-de-supuestos"><i class="fa fa-check"></i><b>18.2</b> Comprobación de supuestos</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráfica-de-ajustados-versus-residuos"><i class="fa fa-check"></i><b>18.2.1</b> Gráfica de ajustados versus residuos</a></li>
<li class="chapter" data-level="18.2.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-breusch-pagan"><i class="fa fa-check"></i><b>18.2.2</b> Prueba de Breusch-Pagan</a></li>
<li class="chapter" data-level="18.2.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#histogramas-1"><i class="fa fa-check"></i><b>18.2.3</b> Histogramas</a></li>
<li class="chapter" data-level="18.2.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráficos-q-q"><i class="fa fa-check"></i><b>18.2.4</b> Gráficos Q-Q</a></li>
<li class="chapter" data-level="18.2.5" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-shapiro-wilk"><i class="fa fa-check"></i><b>18.2.5</b> Prueba de Shapiro-Wilk</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#observaciones-inusuales"><i class="fa fa-check"></i><b>18.3</b> Observaciones inusuales</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#apalancamiento"><i class="fa fa-check"></i><b>18.3.1</b> Apalancamiento</a></li>
<li class="chapter" data-level="18.3.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#valores-atípicos"><i class="fa fa-check"></i><b>18.3.2</b> Valores atípicos</a></li>
<li class="chapter" data-level="18.3.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#influencia"><i class="fa fa-check"></i><b>18.3.3</b> Influencia</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#ejemplos-de-análisis-de-datos"><i class="fa fa-check"></i><b>18.4</b> Ejemplos de análisis de datos</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#buenos-diagnósticos"><i class="fa fa-check"></i><b>18.4.1</b> Buenos diagnósticos</a></li>
<li class="chapter" data-level="18.4.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#diagnóstico-sospechoso"><i class="fa fa-check"></i><b>18.4.2</b> Diagnóstico sospechoso</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="transformaciones.html"><a href="transformaciones.html"><i class="fa fa-check"></i><b>19</b> Transformaciones</a>
<ul>
<li class="chapter" data-level="19.1" data-path="transformaciones.html"><a href="transformaciones.html#transformación-de-respuesta"><i class="fa fa-check"></i><b>19.1</b> Transformación de respuesta</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-estabilizadoras-de-varianza"><i class="fa fa-check"></i><b>19.1.1</b> Transformaciones estabilizadoras de varianza</a></li>
<li class="chapter" data-level="19.1.2" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-box-cox"><i class="fa fa-check"></i><b>19.1.2</b> Transformaciones de Box-Cox</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="transformaciones.html"><a href="transformaciones.html#transformación-del-predictor"><i class="fa fa-check"></i><b>19.2</b> Transformación del predictor</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="transformaciones.html"><a href="transformaciones.html#polinomios"><i class="fa fa-check"></i><b>19.2.1</b> Polinomios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-respuesta"><i class="fa fa-check"></i>Transformaciones de respuesta</a></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-predictores"><i class="fa fa-check"></i>Transformaciones de predictores</a>
<ul>
<li class="chapter" data-level="19.2.2" data-path="transformaciones.html"><a href="transformaciones.html#un-modelo-cuadrático"><i class="fa fa-check"></i><b>19.2.2</b> Un modelo cuadrático</a></li>
<li class="chapter" data-level="19.2.3" data-path="transformaciones.html"><a href="transformaciones.html#sobreajuste-y-extrapolación"><i class="fa fa-check"></i><b>19.2.3</b> Sobreajuste y extrapolación</a></li>
<li class="chapter" data-level="19.2.4" data-path="transformaciones.html"><a href="transformaciones.html#comparación-de-modelos-polinomiales"><i class="fa fa-check"></i><b>19.2.4</b> Comparación de modelos polinomiales</a></li>
<li class="chapter" data-level="19.2.5" data-path="transformaciones.html"><a href="transformaciones.html#poly-función-y-polinomios-ortogonales"><i class="fa fa-check"></i><b>19.2.5</b> <code>poly()</code> Función y polinomios ortogonales</a></li>
<li class="chapter" data-level="19.2.6" data-path="transformaciones.html"><a href="transformaciones.html#función-de-inhibición"><i class="fa fa-check"></i><b>19.2.6</b> Función de inhibición</a></li>
<li class="chapter" data-level="19.2.7" data-path="transformaciones.html"><a href="transformaciones.html#ejemplo-con-datos"><i class="fa fa-check"></i><b>19.2.7</b> Ejemplo con datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="colinealidad.html"><a href="colinealidad.html"><i class="fa fa-check"></i><b>20</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="20.1" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-exacta"><i class="fa fa-check"></i><b>20.1</b> Colinealidad exacta</a></li>
<li class="chapter" data-level="20.2" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-1"><i class="fa fa-check"></i><b>20.2</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="colinealidad.html"><a href="colinealidad.html#factor-de-inflación-de-la-varianza."><i class="fa fa-check"></i><b>20.2.1</b> Factor de inflación de la varianza.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="colinealidad.html"><a href="colinealidad.html#simulación-2"><i class="fa fa-check"></i><b>20.3</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html"><i class="fa fa-check"></i><b>21</b> Selección de variables y construcción de modelos</a>
<ul>
<li class="chapter" data-level="21.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-calidad"><i class="fa fa-check"></i><b>21.1</b> Criterio de calidad</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-de-akaike"><i class="fa fa-check"></i><b>21.1.1</b> Criterio de información de Akaike</a></li>
<li class="chapter" data-level="21.1.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-bayesiano"><i class="fa fa-check"></i><b>21.1.2</b> Criterio de información Bayesiano</a></li>
<li class="chapter" data-level="21.1.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#r-cuadrado-ajustado"><i class="fa fa-check"></i><b>21.1.3</b> R cuadrado ajustado</a></li>
<li class="chapter" data-level="21.1.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#rmse-con-validación-cruzada"><i class="fa fa-check"></i><b>21.1.4</b> RMSE con validación cruzada</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#procedimientos-de-selección"><i class="fa fa-check"></i><b>21.2</b> Procedimientos de selección</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-atrás-backward"><i class="fa fa-check"></i><b>21.2.1</b> Búsqueda hacia atrás (Backward)</a></li>
<li class="chapter" data-level="21.2.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-adelante-forward"><i class="fa fa-check"></i><b>21.2.2</b> Búsqueda hacia adelante (Forward)</a></li>
<li class="chapter" data-level="21.2.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-por-pasos-stepwise"><i class="fa fa-check"></i><b>21.2.3</b> Búsqueda por pasos (Stepwise)</a></li>
<li class="chapter" data-level="21.2.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-exhaustiva"><i class="fa fa-check"></i><b>21.2.4</b> Búsqueda exhaustiva</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#términos-de-orden-superior"><i class="fa fa-check"></i><b>21.3</b> Términos de orden superior</a></li>
<li class="chapter" data-level="21.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-versus-predicción-1"><i class="fa fa-check"></i><b>21.4</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-1"><i class="fa fa-check"></i><b>21.4.1</b> Explicación</a></li>
<li class="chapter" data-level="21.4.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#predicción-1"><i class="fa fa-check"></i><b>21.4.2</b> Predicción</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="regresión-logística.html"><a href="regresión-logística.html"><i class="fa fa-check"></i><b>22</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="22.1" data-path="regresión-logística.html"><a href="regresión-logística.html#modelos-lineales-generalizados"><i class="fa fa-check"></i><b>22.1</b> Modelos lineales generalizados</a></li>
<li class="chapter" data-level="22.2" data-path="regresión-logística.html"><a href="regresión-logística.html#respuesta-binaria"><i class="fa fa-check"></i><b>22.2</b> Respuesta binaria</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ajuste-de-la-regresión-logística"><i class="fa fa-check"></i><b>22.2.1</b> Ajuste de la regresión logística</a></li>
<li class="chapter" data-level="22.2.2" data-path="regresión-logística.html"><a href="regresión-logística.html#problemas-de-ajuste"><i class="fa fa-check"></i><b>22.2.2</b> Problemas de ajuste</a></li>
<li class="chapter" data-level="22.2.3" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplos-de-simulación"><i class="fa fa-check"></i><b>22.2.3</b> Ejemplos de simulación</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="regresión-logística.html"><a href="regresión-logística.html#trabajar-con-regresión-logística"><i class="fa fa-check"></i><b>22.3</b> Trabajar con regresión logística</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="regresión-logística.html"><a href="regresión-logística.html#pruebas-con-glms"><i class="fa fa-check"></i><b>22.3.1</b> Pruebas con GLMs</a></li>
<li class="chapter" data-level="22.3.2" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-wald"><i class="fa fa-check"></i><b>22.3.2</b> Prueba de Wald</a></li>
<li class="chapter" data-level="22.3.3" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>22.3.3</b> Prueba de razón de verosimilitud</a></li>
<li class="chapter" data-level="22.3.4" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-saheart"><i class="fa fa-check"></i><b>22.3.4</b> Ejemplo <code>SAheart</code></a></li>
<li class="chapter" data-level="22.3.5" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-1"><i class="fa fa-check"></i><b>22.3.5</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="22.3.6" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>22.3.6</b> Intervalos de confianza para la respuesta promedio</a></li>
<li class="chapter" data-level="22.3.7" data-path="regresión-logística.html"><a href="regresión-logística.html#sintaxis-de-la-fórmula"><i class="fa fa-check"></i><b>22.3.7</b> Sintaxis de la fórmula</a></li>
<li class="chapter" data-level="22.3.8" data-path="regresión-logística.html"><a href="regresión-logística.html#desviación"><i class="fa fa-check"></i><b>22.3.8</b> Desviación</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="regresión-logística.html"><a href="regresión-logística.html#clasificación"><i class="fa fa-check"></i><b>22.4</b> Clasificación</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-spam"><i class="fa fa-check"></i><b>22.4.1</b> Ejemplo <code>spam</code></a></li>
<li class="chapter" data-level="22.4.2" data-path="regresión-logística.html"><a href="regresión-logística.html#evaluar-clasificadores"><i class="fa fa-check"></i><b>22.4.2</b> Evaluar clasificadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="más-allá.html"><a href="más-allá.html"><i class="fa fa-check"></i><b>23</b> Más allá</a>
<ul>
<li class="chapter" data-level="23.1" data-path="más-allá.html"><a href="más-allá.html#rstudio"><i class="fa fa-check"></i><b>23.1</b> RStudio</a></li>
<li class="chapter" data-level="23.2" data-path="más-allá.html"><a href="más-allá.html#tidy-data"><i class="fa fa-check"></i><b>23.2</b> Tidy Data</a></li>
<li class="chapter" data-level="23.3" data-path="más-allá.html"><a href="más-allá.html#visualización"><i class="fa fa-check"></i><b>23.3</b> Visualización</a></li>
<li class="chapter" data-level="23.4" data-path="más-allá.html"><a href="más-allá.html#aplicaciones-web"><i class="fa fa-check"></i><b>23.4</b> Aplicaciones web</a></li>
<li class="chapter" data-level="23.5" data-path="más-allá.html"><a href="más-allá.html#diseño-experimental"><i class="fa fa-check"></i><b>23.5</b> Diseño experimental</a></li>
<li class="chapter" data-level="23.6" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-automático-machine-learning"><i class="fa fa-check"></i><b>23.6</b> Aprendizaje automático (Machine Learning)</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-profundo-deep-learning"><i class="fa fa-check"></i><b>23.6.1</b> Aprendizaje profundo (Deep Learning)</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="más-allá.html"><a href="más-allá.html#series-de-tiempo"><i class="fa fa-check"></i><b>23.7</b> Series de tiempo</a></li>
<li class="chapter" data-level="23.8" data-path="más-allá.html"><a href="más-allá.html#bayesiana"><i class="fa fa-check"></i><b>23.8</b> Bayesiana</a></li>
<li class="chapter" data-level="23.9" data-path="más-allá.html"><a href="más-allá.html#computación-de-alto-rendimiento."><i class="fa fa-check"></i><b>23.9</b> Computación de alto rendimiento.</a></li>
<li class="chapter" data-level="23.10" data-path="más-allá.html"><a href="más-allá.html#recursos-adicionales-de-r"><i class="fa fa-check"></i><b>23.10</b> Recursos adicionales de <code>R</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/appliedstats" target="blank">&copy; 2020 Adapatado de David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística aplicada con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="análisis-de-varianza" class="section level1" number="17">
<h1><span class="header-section-number">Capítulo 17</span> Análisis de varianza</h1>
<p><strong>Estado del capítulo:</strong> Este capítulo debe considerarse opcional para una primera lectura de este texto. Su inclusión es principalmente en beneficio de algunos cursos que utilizan el texto.</p>
<style type="text/css">
.table {

    width: 70%;
    margin-left:10%; 
    margin-right:10%;

}
</style>
<!-- TODO: use kable styling instead of custom CSS -->
<blockquote>
<p>“Para saber qué sucede cuando cambia algo, es necesario cambiarlo.”</p>
<p>— <strong>Box, Hunter, and Hunter</strong>, Statistics for Experimenters (1978)</p>
</blockquote>
<p>Hasta ahora, hemos construido modelos para respuestas numéricas, cuando los predictores son todos numéricos. Tomaremos un pequeño desvío para volver atrás y considerar modelos que <em>solo</em> tienen predictores <strong>categóricos</strong>. Un predictor categórico es una variable que toma solo un número finito de valores, que no están ordenados. Por ejemplo, una variable que toma como valores posibles <code>rojo</code>,<code>azul</code>, <code>verde</code> es categórica. En el contexto de usar una variable categórica como predictor, colocaría las observaciones en diferentes grupos (categorías).</p>
<p>También hemos estado tratando principalmente con datos de observación. Los métodos de esta sección son más útiles en entornos experimentales, pero aún funcionan con datos de observación. (Sin embargo, para determinar la causalidad, necesitamos experimentos).</p>
<div id="experimentos" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Experimentos</h2>
<p>La mayor diferencia entre un estudio observacional y un experimento es <em>cómo</em> se obtienen los datos del predictor. ¿Tiene el experimentador el control?</p>
<ul>
<li>En un estudio <strong>observacional</strong>, tanto los datos de respuesta como los predictores se obtienen mediante observación.</li>
<li>En un <strong>experimento</strong>, los datos del predictor son valores determinados por el experimentador. Se ejecuta el experimento y se observa la respuesta.</li>
</ul>
<p>En un experimento, los predictores, que son controlados por el experimentador, se denominan <strong>factores</strong>. Los posibles valores de estos factores se denominan <strong>niveles</strong>. Los sujetos se asignan <em>al azar</em> a un nivel de cada uno de los factores.</p>
<p>El diseño de experimentos podría ser un curso en sí mismo. El artículo de Wikipedia sobre <a href="https://en.wikipedia.org/wiki/Design_of_experiments" target="_blank">diseño de experimentos</a> ofrece una buena descripción general. Originalmente, la mayor parte de la metodología fue desarrollada para aplicaciones agrícolas por <a href="https://en.wikipedia.org/wiki/Ronald_Fisher" target="_blank">R. A. Fisher</a>, pero hoy todavía están en uso, ahora en una amplia variedad de áreas de aplicación. En particular, estos métodos han experimentado un resurgimiento como parte de las “pruebas A/B”.</p>
<!-- TODO: In the future, discuss the Morrow Plots: http://cropsci.illinois.edu/research/morrow -->
</div>
<div id="prueba-t-de-dos-muestras" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Prueba t de dos muestras</h2>
<p>El ejemplo más simple de un diseño experimental es la configuración de una prueba <span class="math inline">\(t\)</span> de dos muestras. Hay una variable de factor único con dos niveles que divide a los sujetos en dos grupos. A menudo, un nivel se considera el <strong>control</strong>, mientras que el otro es el <strong>tratamiento</strong>. Los sujetos se asignan aleatoriamente a uno de los dos grupos. Después de ser asignado a un grupo, cada sujeto tiene una cantidad medida, que es la variable de respuesta.</p>
<p>Matemáticamente, consideramos el modelo</p>
<p><span class="math display">\[
y_{ij} \sim N(\mu_i, \sigma^2)
\]</span></p>
<p>donde <span class="math inline">\(i= 1,2\)</span> para los dos grupos y <span class="math inline">\(j=1,2,\ldots n_i\)</span>. Aquí <span class="math inline">\(n_i\)</span> es el número de sujetos en el grupo <span class="math inline">\(i\)</span>. Entonces <span class="math inline">\(y_{13}\)</span> sería la medida para el tercer miembro del primer grupo.</p>
<p>Por tanto, las mediciones de los sujetos del grupo <span class="math inline">\(1\)</span> siguen una distribución normal con una media de <span class="math inline">\(\mu_1\)</span>.</p>
<p><span class="math display">\[
y_{1j} \sim N(\mu_1, \sigma^2)
\]</span></p>
<p>Luego, las mediciones de los sujetos en el grupo <span class="math inline">\(2\)</span> siguen una distribución normal con media <span class="math inline">\(\mu_2\)</span>.</p>
<p><span class="math display">\[
y_{2j} \sim N(\mu_2, \sigma^2)
\]</span></p>
<p>Este modelo hace una serie de suposiciones. Específicamente,</p>
<ul>
<li>Las observaciones siguen una distribución <strong>normal</strong>. La media de cada grupo es diferente.</li>
<li><strong>Varianza igual</strong> para cada grupo.</li>
<li><strong>Independencia</strong>. Lo cual es creíble si los grupos fueran asignados al azar.</li>
</ul>
<p>Más adelante, investigaremos los supuestos de varianza normal e igual. Por ahora, continuaremos asumiendo que son razonables.</p>
<p>La pregunta natural que se debe hacer: ¿hay alguna diferencia entre los dos grupos? La pregunta específica que responderemos: ¿Son diferentes las medias de los dos grupos?</p>
<p>Matemáticamente, es</p>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 \quad \text{vs} \quad H_1: \mu_1 \neq \mu_2
\]</span></p>
<p>Para el modelo establecido y asumiendo que la hipótesis nula es verdadera, el estadístico de prueba <span class="math inline">\(t\)</span> seguiría una distribución <span class="math inline">\(t\)</span> con <span class="math inline">\(n_1+n_2-2\)</span> grados de libertad.</p>
<p>Como ejemplo, suponga que estamos interesados en el efecto de la <a href="https://en.wikipedia.org/wiki/Melatonin" target="_blank">melatonina</a> sobre la duración del sueño. Un investigador obtiene una muestra aleatoria de 20 varones adultos. De estos sujetos, 10 se eligen al azar para el grupo de control, que recibirá un placebo. Los 10 restantes recibirán 5 mg de melatonina antes de acostarse. Luego se mide la duración del sueño en horas de cada sujeto. El investigador elige un nivel de significancia de <span class="math inline">\(\alpha=0.10\)</span>. ¿La melatonina afectó la duración del sueño?</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="análisis-de-varianza.html#cb799-1" aria-hidden="true" tabindex="-1"></a>melatonin</span></code></pre></div>
<pre><code>##        sleep       group
## 1   8.145150     control
## 2   7.522362 tratamiento
## 3   6.935754     control
## 4   8.959435 tratamiento
## 5   6.985122     control
## 6   8.072651 tratamiento
## 7   8.313826     control
## 8   8.086409 tratamiento
## 9   8.922108     control
## 10  8.124743 tratamiento
## 11  8.065844     control
## 12 10.943974 tratamiento
## 13  4.833367     control
## 14  7.865453 tratamiento
## 15  6.340014     control
## 16  8.963140 tratamiento
## 17  6.158896     control
## 18  5.012253 tratamiento
## 19  3.571440     control
## 20  9.784136 tratamiento</code></pre>
<p>Aquí, nos gustaría probar,</p>
<p><span class="math display">\[
H_0: \mu_C = \mu_T \quad \text{vs} \quad H_1: \mu_C \neq \mu_T
\]</span></p>
<p>Para hacerlo en <code>R</code>, usamos la función <code>t.test()</code>, con el argumento <code>var.equal</code> establecido en <code>TRUE</code>.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="análisis-de-varianza.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep <span class="sc">~</span> group, <span class="at">data =</span> melatonin, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  sleep by group
## t = -2.0854, df = 18, p-value = 0.05154
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.02378261  0.01117547
## sample estimates:
##     mean in group control mean in group tratamiento 
##                  6.827152                  8.333456</code></pre>
<p>A un nivel de significancia de <span class="math inline">\(\alpha=0.10\)</span>, rechazamos la hipótesis nula. Parece que la melatonina tuvo un efecto <strong>estadísticamente significativo</strong>. Tenga en cuenta que la significación estadística no siempre es la misma que la <strong>significación científica o práctica</strong>. Para determinar la importancia práctica, necesitamos investigar el <strong>tamaño del efecto</strong> en el contexto de la situación. Aquí, el tamaño del efecto es la diferencia de las medias muestrales.</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="análisis-de-varianza.html#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep <span class="sc">~</span> group, <span class="at">data =</span> melatonin, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##     mean in group control mean in group tratamiento 
##                  6.827152                  8.333456</code></pre>
<p>Aquí vemos que los sujetos del grupo de melatonina duermen un promedio de aproximadamente 1,5 horas más que el grupo de control. ¡Una hora y media de sueño es ciertamente importante!</p>
<p>Con un tamaño de muestra lo suficientemente grande, podríamos hacer un tamaño del efecto de, digamos, cuatro minutos estadísticamente significativo. ¿Vale la pena tomar una pastilla todas las noches para dormir cuatro minutos más? (Probablemente no.)</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="análisis-de-varianza.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(sleep <span class="sc">~</span> group, <span class="at">data =</span> melatonin, <span class="at">col =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-345-1.png" width="672" style="display: block; margin: auto;" /></p>
<!-- TODO: other parametarization, explain identify -->
</div>
<div id="anova-de-una-vía" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> ANOVA de una vía</h2>
<p>¿Y si hay más de dos grupos? Considere el modelo</p>
<p><span class="math display">\[
y_{ij} = \mu + \alpha_i + e_{ij}.
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\sum \alpha_i = 0
\]</span></p>
<p>y</p>
<p><span class="math display">\[
e_{ij} \sim N(0,\sigma^{2}).
\]</span></p>
<p>Aquí,</p>
<ul>
<li><span class="math inline">\(i = 1, 2, \ldots g\)</span> donde <span class="math inline">\(g\)</span> es el número de grupos.</li>
<li><span class="math inline">\(j = 1, 2, \ldots n_i\)</span> donde <span class="math inline">\(n_i\)</span> es el número de observaciones en el grupo <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Entonces el tamaño total de la muestra es</p>
<p><span class="math display">\[
N = \sum_{i = 1}^{g} n_i
\]</span></p>
<p>Las observaciones del grupo <span class="math inline">\(i\)</span> siguen una distribución normal</p>
<p><span class="math display">\[
y_{ij} \sim N(\mu_i,\sigma^{2})
\]</span></p>
<p>donde la media de cada grupo viene dada por</p>
<p><span class="math display">\[
\mu_i = \mu + \alpha_i.
\]</span></p>
<p>Aquí <span class="math inline">\(\alpha_i\)</span> mide el efecto del grupo <span class="math inline">\(i\)</span>. Es la diferencia entre la media general y la media del grupo <span class="math inline">\(i\)</span>.</p>
<p>Esencialmente, las suposiciones son las mismas que las del caso de dos muestras, sin embargo ahora, simplemente tenemos más grupos.</p>
<p>Al igual que en el caso de dos muestras, nuevamente nos gustaría probar si las medias de los grupos son iguales.</p>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 = \ldots \mu_g \quad \text{vs} \quad H_1: \text{ No todos los } \mu_i \text{ son iguales.}
\]</span></p>
<p>Observe que la alternativa simplemente indica que algunas de las medias no son iguales, no específicamente cuáles de las medias no son iguales. Más sobre eso después.</p>
<p>Alternativamente, podríamos escribir</p>
<p><span class="math display">\[
H_0: \alpha_1 = \alpha_2 = \ldots = \alpha_g = 0 \quad \text{vs} \quad H_1: \text{ No todos los } \alpha_i \text{ son } 0.
\]</span></p>
<p>Esta prueba se llama <strong>Análisis de varianza</strong>. El análisis de varianza (ANOVA) compara la variación debida a fuentes específicas (entre grupos) con la variación entre individuos que deberían ser similares (dentro de los grupos). En particular, ANOVA prueba si varias poblaciones tienen la misma media comparando qué tan alejadas están las medias de la muestra con cuánta variación hay dentro de las muestras. Usamos la variabilidad de medias para probar la igualdad de medias, de ahí el uso de <em>varianza</em> en el nombre para una prueba sobre medias.</p>
<p>Dejaremos fuera la mayoría de los detalles sobre cómo se realiza la estimación, pero veremos más adelante, que se realiza mediante mínimos cuadrados. Usaremos <code>R</code> para obtener estas estimaciones, pero en realidad son bastante simples. Basta pensar en las medias muestrales de los grupos.</p>
<ul>
<li><span class="math inline">\(\bar{y}_i\)</span> es la media muestral del grupo <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(\bar{y}\)</span> es la media muestral general.</li>
<li><span class="math inline">\(s_{i}^{2}\)</span> es la varianza muestral del grupo <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Luego descompondremos la varianza, como hemos visto antes en la regresión. La variación <strong>total</strong> mide cuánto varían las observaciones sobre la media general de la muestra, <em>ignorando los grupos</em>.</p>
<p><span class="math display">\[
SST = \sum_{i = 1}^{g} \sum_{j = 1}^{n_i} (y_{ij} - \bar{y})^2
\]</span></p>
<p>La variación <strong>entre</strong> grupos analiza qué tan lejos están las medias de la muestra individual de la media general de la muestra.</p>
<p><span class="math display">\[
SSB = \sum_{i = 1}^{g} \sum_{j = 1}^{n_i} (\bar{y}_i - \bar{y})^2 = \sum_{i = 1}^{g} n_i (\bar{y}_i - \bar{y})^2
\]</span></p>
<p>Por último, la variación <strong>dentro de</strong> grupo mide qué tan lejos están las observaciones de la media muestral de su grupo.</p>
<p><span class="math display">\[
SSW = \sum_{i = 1}^{g} \sum_{j = 1}^{n_i} (y_{ij} - \bar{y}_i)^2 = \sum_{i = 1}^{g} (n_i - 1) s_{i}^{2}
\]</span></p>
<p>Esto también podría pensarse como la suma de los cuadrados del error, donde <span class="math inline">\(y_{ij}\)</span> es una observación y <span class="math inline">\(\bar{y}_i\)</span> es su valor ajustado (predicho) del modelo.</p>
<p>Para desarrollar el estadístico de prueba para ANOVA, colocamos esta información en una tabla ANOVA.</p>
<table>
<thead>
<tr class="header">
<th>Fuente</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado medio</th>
<th><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Entre</td>
<td>SSB</td>
<td><span class="math inline">\(g - 1\)</span></td>
<td>SSB / DFB</td>
<td>MSB / MSW</td>
</tr>
<tr class="even">
<td>Dentro</td>
<td>SSW</td>
<td><span class="math inline">\(N - g\)</span></td>
<td>SSW / DFW</td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>SST</td>
<td><span class="math inline">\(N - 1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Rechazamos al hipótesis nula (medias iguales) cuando la estadística <span class="math inline">\(F\)</span> es grande. Esto ocurre cuando la variación entre grupos es grande en comparación con la variación dentro de los grupos. Bajo la hipótesis nula, la distribución del estadístico de prueba es <span class="math inline">\(F\)</span> con grados de libertad <span class="math inline">\(g-1\)</span> y <span class="math inline">\(N-g\)</span>.</p>
<!-- TODO: This should be a Shiny app. -->
<!-- TODO: Should output entire ANOVA table. -->
<!-- TODO: Do with ggplot2 and custom boxplots with show min, sd, mean, sd, max -->
<p>Observemos cómo se ve esto en algunas situaciones. En cada uno de los siguientes ejemplos, consideraremos muestrear 20 observaciones (<span class="math inline">\(n_i=20\)</span>) de tres poblaciones (grupos).</p>
<p>Primero, considere <span class="math inline">\(\mu_A = -5, \mu_B = 0, \mu_C = 5\)</span> con <span class="math inline">\(\sigma = 1\)</span>.</p>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-348-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>El panel de la izquierda muestra las tres distribuciones normales de las que estamos muestreando. Las marcas a lo largo del eje <span class="math inline">\(x\)</span> muestran las observaciones muestreadas al azar. El panel derecho vuelve a mostrar solo los valores muestreados en un gráico de caja. Tenga en cuenta que la línea media de los cuadros suele ser la mediana de la muestra. Estos diagramas de caja se han modificado para utilizar la media muestral.</p>
<p>Aquí, las medias de la muestra varían mucho alrededor de la media de la muestra general, que es la línea gris sólida en el panel derecho. Dentro de los grupos existe variabilidad, pero aún es obvio que las medias muestrales son muy diferentes.</p>
<p>Como resultado, obtenemos un estadístico de prueba <em>grande</em>, por lo tanto, un valor p <em>pequeño</em>.</p>
<ul>
<li><span class="math inline">\(F = 374.4469511\)</span></li>
<li><span class="math inline">\(\text{p-value} = 1.6349862\times 10^{-33}\)</span></li>
</ul>
<p>Ahora considere <span class="math inline">\(\mu_A = 0, \mu_B = 0, \mu_C = 0\)</span> con <span class="math inline">\(\sigma = 1\)</span>. Es decir, medias iguales para los grupos.</p>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-349-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Aquí, las medias de la muestra varían solo un poco alrededor de la media de la muestra general. Dentro de los grupos hay variabilidad, esta vez mucho mayor que la variabilidad de las medias muestrales.</p>
<p>Como resultado, obtenemos un estadístico de prueba <em>pequeño</em>, por lo tanto, un valor p <em>grande</em>.</p>
<ul>
<li><span class="math inline">\(F = 2.667892\)</span></li>
<li><span class="math inline">\(\text{p-value} = 0.0780579\)</span></li>
</ul>
<p>Los siguientes dos ejemplos muestran diferentes medias, con diferentes niveles de ruido. Observe cómo estos afectan el estadístico de prueba y el valor p.</p>
<ul>
<li><span class="math inline">\(\mu_A = -1, \mu_B = 0, \mu_C = 1, \sigma = 1\)</span></li>
</ul>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-350-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li><span class="math inline">\(F = 16.4879492\)</span></li>
<li><span class="math inline">\(\text{p-value} = 2.2378806\times 10^{-6}\)</span></li>
</ul>
<p>Arriba, no hay una separación obvia entre los grupos como en el primer ejemplo, pero aún es obvio que las medias son diferentes. Abajo, hay más ruido. Visualmente es algo difícil de decir, pero la prueba aún sugiere una diferencia de medias. (A un <span class="math inline">\(\alpha\)</span> de 0.05).</p>
<ul>
<li><span class="math inline">\(\mu_A = -1, \mu_B = 0, \mu_C = 1, \sigma = 2\)</span></li>
<li><span class="math inline">\(n_i = 20\)</span> para cada grupo.</li>
</ul>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-351-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li><span class="math inline">\(F = 4.6256472\)</span></li>
<li><span class="math inline">\(\text{p-value} = 0.0137529\)</span></li>
</ul>
<p>Consideremos un ejemplo con datos reales. Usaremos el conjunto de datos <code>coagulation</code> del paquete <code>faraway</code>. Aquí se administraron cuatro dietas diferentes (“A”, “B”, “C”, “D”) a una muestra aleatoria de 24 animales. Los sujetos fueron asignados aleatoriamente a una de las cuatro dietas. Para cada uno, se midió el tiempo de coagulación de la sangre en segundos.</p>
<p>Aquí nos gustaría probar</p>
<p><span class="math display">\[
H_0: \mu_A = \mu_B = \mu_C = \mu_D 
\]</span></p>
<p>donde, por ejemplo, <span class="math inline">\(\mu_A\)</span> es el tiempo medio de coagulación de la sangre para un animal que consumió la dieta <code>A</code>.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="análisis-de-varianza.html#cb806-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb806-2"><a href="análisis-de-varianza.html#cb806-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coagulation)</span></code></pre></div>
<pre><code>## [1] &quot;coag&quot; &quot;diet&quot;</code></pre>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="análisis-de-varianza.html#cb808-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coag <span class="sc">~</span> diet, <span class="at">data =</span> coagulation, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-352-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Primero cargamos los datos y creamos el gráfico de caja. La geáfica por sí sola sugiere una diferencia de medios. La función <code>aov()</code> se utiliza para obtener las sumas de cuadrados relevantes. Usando la función <code>summary()</code> en la salida de <code>aov()</code> se crea la tabla ANOVA deseada. (Sin la fila innecesaria para el total).</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="análisis-de-varianza.html#cb809-1" aria-hidden="true" tabindex="-1"></a>coag_aov <span class="ot">=</span> <span class="fu">aov</span>(coag <span class="sc">~</span> diet, <span class="at">data =</span> coagulation)</span>
<span id="cb809-2"><a href="análisis-de-varianza.html#cb809-2" aria-hidden="true" tabindex="-1"></a>coag_aov</span></code></pre></div>
<pre><code>## Call:
##    aov(formula = coag ~ diet, data = coagulation)
## 
## Terms:
##                 diet Residuals
## Sum of Squares   228       112
## Deg. of Freedom    3        20
## 
## Residual standard error: 2.366432
## Estimated effects may be unbalanced</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="análisis-de-varianza.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(coag_aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## diet         3    228    76.0   13.57 4.66e-05 ***
## Residuals   20    112     5.6                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Si lleváramos a cabo este experimento, habríamos especificado previamente un nivel de significancia. Sin embargo, observe que el valor p de esta prueba es increíblemente bajo, por lo que al usar cualquier nivel de significancia razonable rechazaríamos la hipótesis nula. Por lo tanto, creemos que las dietas tuvieron un efecto sobre el tiempo de coagulación de la sangre.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="análisis-de-varianza.html#cb813-1" aria-hidden="true" tabindex="-1"></a>diets <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">diet =</span> <span class="fu">unique</span>(coagulation<span class="sc">$</span>diet))</span>
<span id="cb813-2"><a href="análisis-de-varianza.html#cb813-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(diets, <span class="at">coag =</span> <span class="fu">predict</span>(coag_aov, diets))</span></code></pre></div>
<pre><code>##   diet coag
## 1    A   61
## 2    B   66
## 3    C   68
## 4    D   61</code></pre>
<p>Aquí, hemos creado un marco de datos con una fila para cada dieta. Al predecir en este marco de datos, obtenemos las medias muestrales de cada dieta (grupo).</p>
<div id="variables-factor-1" class="section level3" number="17.3.1">
<h3><span class="header-section-number">17.3.1</span> Variables factor</h3>
<p>Al realizar ANOVA en <code>R</code>, asegúrese de que la variable de agrupación sea una variable factor. Si no es así, es posible que el resultado no sea ANOVA, sino una regresión lineal con una variable predictora numérica.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="análisis-de-varianza.html#cb815-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb815-2"><a href="análisis-de-varianza.html#cb815-2" aria-hidden="true" tabindex="-1"></a>response <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">15</span>)</span>
<span id="cb815-3"><a href="análisis-de-varianza.html#cb815-3" aria-hidden="true" tabindex="-1"></a>group    <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb815-4"><a href="análisis-de-varianza.html#cb815-4" aria-hidden="true" tabindex="-1"></a>bad <span class="ot">=</span> <span class="fu">data.frame</span>(response, group)</span>
<span id="cb815-5"><a href="análisis-de-varianza.html#cb815-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(response <span class="sc">~</span> group, <span class="at">data =</span> bad)) <span class="co"># DF equivocado!</span></span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## group        1  0.017  0.0173   0.015  0.903
## Residuals   13 14.698  1.1306</code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="análisis-de-varianza.html#cb817-1" aria-hidden="true" tabindex="-1"></a>good <span class="ot">=</span> <span class="fu">data.frame</span>(response, <span class="at">group =</span> <span class="fu">as.factor</span>(group))</span>
<span id="cb817-2"><a href="análisis-de-varianza.html#cb817-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(response <span class="sc">~</span> group, <span class="at">data =</span> good))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## group        2  0.232  0.1158   0.096  0.909
## Residuals   12 14.484  1.2070</code></pre>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="análisis-de-varianza.html#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(bad<span class="sc">$</span>group)  <span class="co"># 1, 2 y 3 son números.</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="análisis-de-varianza.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(good<span class="sc">$</span>group) <span class="co"># 1, 2 y 3 son etiquetas.</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="algo-de-simulación" class="section level3" number="17.3.2">
<h3><span class="header-section-number">17.3.2</span> Algo de simulación</h3>
<p>Verificamos la distribución del estadístico de prueba bajo la hipótesis nula. Simulamos a partir de un modelo nulo (varianza igual) para obtener una distribución empírica del estadístico <span class="math inline">\(F\)</span>. Agregamos la curva para la distribución esperada.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="análisis-de-varianza.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb823-2"><a href="análisis-de-varianza.html#cb823-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-3"><a href="análisis-de-varianza.html#cb823-3" aria-hidden="true" tabindex="-1"></a>sim_anova <span class="ot">=</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mu_a =</span> <span class="dv">0</span>, <span class="at">mu_b =</span> <span class="dv">0</span>, <span class="at">mu_c =</span> <span class="dv">0</span>, <span class="at">mu_d =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb823-4"><a href="análisis-de-varianza.html#cb823-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb823-5"><a href="análisis-de-varianza.html#cb823-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># crear datos a partir del modelo ANOVA de una vía con cuatro grupos de igual tamaño</span></span>
<span id="cb823-6"><a href="análisis-de-varianza.html#cb823-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># respuesta simulada de una normal con media de grupo, varianza compartida</span></span>
<span id="cb823-7"><a href="análisis-de-varianza.html#cb823-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># la variable de grupo indica el grupo A, B, C o D</span></span>
<span id="cb823-8"><a href="análisis-de-varianza.html#cb823-8" aria-hidden="true" tabindex="-1"></a>  sim_data <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb823-9"><a href="análisis-de-varianza.html#cb823-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">response =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu_a, <span class="at">sd =</span> sigma),</span>
<span id="cb823-10"><a href="análisis-de-varianza.html#cb823-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu_b, <span class="at">sd =</span> sigma),</span>
<span id="cb823-11"><a href="análisis-de-varianza.html#cb823-11" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu_c, <span class="at">sd =</span> sigma),</span>
<span id="cb823-12"><a href="análisis-de-varianza.html#cb823-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu_d, <span class="at">sd =</span> sigma)),</span>
<span id="cb823-13"><a href="análisis-de-varianza.html#cb823-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="at">times =</span> n), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="at">times =</span> n), </span>
<span id="cb823-14"><a href="análisis-de-varianza.html#cb823-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="at">times =</span> n), <span class="fu">rep</span>(<span class="st">&quot;D&quot;</span>, <span class="at">times =</span> n))</span>
<span id="cb823-15"><a href="análisis-de-varianza.html#cb823-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb823-16"><a href="análisis-de-varianza.html#cb823-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb823-17"><a href="análisis-de-varianza.html#cb823-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># obtener el estadístico F y el valor p para probar la diferencia de medias</span></span>
<span id="cb823-18"><a href="análisis-de-varianza.html#cb823-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use lm en lugar de aov para un mejor formato de resultados</span></span>
<span id="cb823-19"><a href="análisis-de-varianza.html#cb823-19" aria-hidden="true" tabindex="-1"></a>  aov_results <span class="ot">=</span> <span class="fu">lm</span>(response <span class="sc">~</span> group, <span class="at">data =</span> sim_data)</span>
<span id="cb823-20"><a href="análisis-de-varianza.html#cb823-20" aria-hidden="true" tabindex="-1"></a>  f_stat <span class="ot">=</span> <span class="fu">glance</span>(aov_results)<span class="sc">$</span>statistic</span>
<span id="cb823-21"><a href="análisis-de-varianza.html#cb823-21" aria-hidden="true" tabindex="-1"></a>  p_val  <span class="ot">=</span> <span class="fu">glance</span>(aov_results)<span class="sc">$</span>p.value</span>
<span id="cb823-22"><a href="análisis-de-varianza.html#cb823-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb823-23"><a href="análisis-de-varianza.html#cb823-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># devuelve f_stat si stat=TRUE, de lo contrario, valor p</span></span>
<span id="cb823-24"><a href="análisis-de-varianza.html#cb823-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(stat, f_stat, p_val)</span>
<span id="cb823-25"><a href="análisis-de-varianza.html#cb823-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb823-26"><a href="análisis-de-varianza.html#cb823-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb823-27"><a href="análisis-de-varianza.html#cb823-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-28"><a href="análisis-de-varianza.html#cb823-28" aria-hidden="true" tabindex="-1"></a>f_stats <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">5000</span>, <span class="fu">sim_anova</span>(<span class="at">stat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb823-29"><a href="análisis-de-varianza.html#cb823-29" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(f_stats, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Distribución empírica de F&quot;</span>)</span>
<span id="cb823-30"><a href="análisis-de-varianza.html#cb823-30" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="dv">40</span> <span class="sc">-</span> <span class="dv">4</span>), <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-356-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="potencia" class="section level3" number="17.3.3">
<h3><span class="header-section-number">17.3.3</span> Potencia</h3>
<p>Ahora que estamos realizando experimentos, obtener más datos significa encontrar más sujetos de prueba, realizar más pruebas de laboratorio, etc. En otras palabras, costará más tiempo y dinero.</p>
<p>Nos gustaría diseñar nuestro experimento para que tengamos una buena posibilidad de detectar un tamaño de efecto interesante, sin gastar demasiado dinero. No tiene sentido ejecutar un experimento si hay muy pocas posibilidades de que tenga un resultado significativo que le interese. (Recuerde, no todos los resultados estadísticamente significativos tienen valor práctico).</p>
<p>Nos gustaría que la prueba ANOVA tuviera una <strong>potencia</strong> elevada para una hipótesis alternativa con un tamaño de efecto mínimo deseado.</p>
<p><span class="math display">\[
\text{Potencia } = P(\text{Rechazar } H_0 \mid H_0 \text{ Falso})
\]</span></p>
<p>Es decir, para una verdadera diferencia de medias que consideremos interesante, queremos que la prueba se rechace con alta probabilidad.</p>
<p>Varias cosas pueden afectar la potencia de una prueba:</p>
<ul>
<li><strong>Tamaño del efecto</strong>. Es más fácil detectar efectos mayores.</li>
<li><strong>Nivel de ruido</strong> <span class="math inline">\(\sigma\)</span>. Cuanto menos ruido, más fácil es detectar la señal (efecto). No tenemos mucha capacidad para controlar esto, excepto quizás para medir con mayor precisión.</li>
<li><strong>Nivel de significancia</strong> <span class="math inline">\(\alpha\)</span>. Un nivel de significancia más bajo hace que el rechazo sea más difícil. (Pero también permite menos falsos positivos).</li>
<li><strong>Tamaño de la muestra</strong>. Las muestras grandes significan efectos más fáciles de detectar.</li>
<li><strong>Diseño balanceado</strong>. Un número igual de observaciones por grupo conduce a una mayor potencia.</li>
</ul>
<p>Las siguientes simulaciones analizan el efecto del nivel de significancia, el tamaño del efecto y el nivel de ruido en la potencia de una prueba ANOVA <span class="math inline">\(F\)</span>. El ejercicio examinará el tamaño y el equilibrio de la muestra.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="análisis-de-varianza.html#cb824-1" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="fu">sim_anova</span>(<span class="at">mu_a =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">mu_b =</span> <span class="dv">0</span>, <span class="at">mu_c =</span> <span class="dv">0</span>, <span class="at">mu_d =</span> <span class="dv">1</span>,</span>
<span id="cb824-2"><a href="análisis-de-varianza.html#cb824-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma =</span> <span class="fl">1.5</span>, <span class="at">stat =</span> <span class="cn">FALSE</span>))</span>
<span id="cb824-3"><a href="análisis-de-varianza.html#cb824-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.663</code></pre>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="análisis-de-varianza.html#cb826-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.39</code></pre>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="análisis-de-varianza.html#cb828-1" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="fu">sim_anova</span>(<span class="at">mu_a =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">mu_b =</span> <span class="dv">0</span>, <span class="at">mu_c =</span> <span class="dv">0</span>, <span class="at">mu_d =</span> <span class="dv">1</span>,</span>
<span id="cb828-2"><a href="análisis-de-varianza.html#cb828-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma =</span> <span class="fl">2.0</span>, <span class="at">stat =</span> <span class="cn">FALSE</span>))</span>
<span id="cb828-3"><a href="análisis-de-varianza.html#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.408</code></pre>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="análisis-de-varianza.html#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.179</code></pre>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="análisis-de-varianza.html#cb832-1" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="fu">sim_anova</span>(<span class="at">mu_a =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">mu_b =</span> <span class="dv">0</span>, <span class="at">mu_c =</span> <span class="dv">0</span>, <span class="at">mu_d =</span> <span class="dv">2</span>,</span>
<span id="cb832-2"><a href="análisis-de-varianza.html#cb832-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sigma =</span> <span class="fl">2.0</span>, <span class="at">stat =</span> <span class="cn">FALSE</span>))</span>
<span id="cb832-3"><a href="análisis-de-varianza.html#cb832-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.964</code></pre>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="análisis-de-varianza.html#cb834-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p_vals <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.855</code></pre>
</div>
</div>
<div id="pruebas-post-hoc" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> Pruebas Post Hoc</h2>
<p>Suponga que rechazamos la hipótesis nula de la prueba ANOVA para medias iguales. Eso nos dice que las medias son diferentes. ¿Pero qué significa? ¿Todas ellas? ¿Algunas? La estrategia obvia es probar todas las posibles comparaciones de dos medias. Podemos hacer esto fácilmente en <code>R</code>.</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="análisis-de-varianza.html#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(coagulation, <span class="fu">pairwise.t.test</span>(coag, diet, <span class="at">p.adj =</span> <span class="st">&quot;none&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  coag and diet 
## 
##   A       B       C      
## B 0.00380 -       -      
## C 0.00018 0.15878 -      
## D 1.00000 0.00086 2.3e-05
## 
## P value adjustment method: none</code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="análisis-de-varianza.html#cb838-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise.t.test(coagulation$coag, coagulation$diet, p.adj = &quot;none&quot;)</span></span></code></pre></div>
<p>Observe que la función <code>pairwise.t.test()</code> no tiene un argumento <code>data</code>. Para evitar usar <code>attach()</code> o el operador <code>$</code>, introducimos la función <code>with()</code>. La línea comentada realizaría la misma operación.</p>
<p>También tenga en cuenta que estamos usando el argumento <code>p.adj = "none"</code>. ¿Qué es ésto? Un ajuste (en este caso no un ajuste) al valor p de cada prueba. ¿Por qué tendríamos que hacer esto?</p>
<p>El ajuste es un intento de corregir el <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem" target="_blank">problema de pruebas múltiples</a>. (Consulte también: <a href="https://xkcd.com/882/" target="_blank">XKCD relevante</a>.) Imagine que sabe de antemano que va a realizar 100 pruebas <span class="math inline">\(t\)</span>. Suponga que desea hacer esto con una tasa de falsos positivos de <span class="math inline">\(\alpha=0.05\)</span>. Si usamos este nivel de significancia para cada una de las 100 pruebas, entonces esperamos 5 falsos positivos. Eso significa que, con 100 pruebas, es casi seguro que tendremos al menos un error.</p>
<p>Lo que realmente nos gustaría es que la <a href="https://en.wikipedia.org/wiki/Family-wise_error_rate" target="_blank">tasa de error familiar</a> sea 0.05. Si consideramos que las 100 pruebas son un solo “experimento”, el FWER es la tasa de uno o más falsos positivos en el experimento completo (100 pruebas). Considérelo una tasa de error para un procedimiento completo, en lugar de una sola prueba.</p>
<p>Con esto en mente, uno de los ajustes más simples que podemos hacer es aumentar los valores p para cada prueba, dependiendo del número de pruebas. En particular, la corrección de Bonferroni simplemente se multiplica por el número de pruebas.</p>
<p><span class="math display">\[
\text{valor p-bonf} = \min(1, n_{tests} \cdot \text{valor p})
\]</span></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="análisis-de-varianza.html#cb839-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(coagulation, <span class="fu">pairwise.t.test</span>(coag, diet, <span class="at">p.adj =</span> <span class="st">&quot;bonferroni&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  coag and diet 
## 
##   A       B       C      
## B 0.02282 -       -      
## C 0.00108 0.95266 -      
## D 1.00000 0.00518 0.00014
## 
## P value adjustment method: bonferroni</code></pre>
<p>Vemos que estos valores p son mucho más altos que los valores p no ajustados, por lo tanto, es menos probable que rechacemos cada prueba. Como resultado, el FWER es 0.05, en lugar de una tasa de error de 0.05 para cada prueba.</p>
<p>Podemos simular el escenario de 100 pruebas para ilustrar este punto.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="análisis-de-varianza.html#cb841-1" aria-hidden="true" tabindex="-1"></a>get_p_val <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb841-2"><a href="análisis-de-varianza.html#cb841-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb841-3"><a href="análisis-de-varianza.html#cb841-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># crear datos para dos grupos, media igual </span></span>
<span id="cb841-4"><a href="análisis-de-varianza.html#cb841-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb841-5"><a href="análisis-de-varianza.html#cb841-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">10</span>))</span>
<span id="cb841-6"><a href="análisis-de-varianza.html#cb841-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb841-7"><a href="análisis-de-varianza.html#cb841-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Valor p de la prueba t cuando la nula es verdadera</span></span>
<span id="cb841-8"><a href="análisis-de-varianza.html#cb841-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>(<span class="fu">t.test</span>(y <span class="sc">~</span> g, <span class="at">var.equal =</span> <span class="cn">TRUE</span>))<span class="sc">$</span>p.value</span>
<span id="cb841-9"><a href="análisis-de-varianza.html#cb841-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb841-10"><a href="análisis-de-varianza.html#cb841-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb841-11"><a href="análisis-de-varianza.html#cb841-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-12"><a href="análisis-de-varianza.html#cb841-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb841-13"><a href="análisis-de-varianza.html#cb841-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-14"><a href="análisis-de-varianza.html#cb841-14" aria-hidden="true" tabindex="-1"></a><span class="co"># FWER con 100 pruebas</span></span>
<span id="cb841-15"><a href="análisis-de-varianza.html#cb841-15" aria-hidden="true" tabindex="-1"></a><span class="co"># tasa deseada = 0.05</span></span>
<span id="cb841-16"><a href="análisis-de-varianza.html#cb841-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sin ajuste</span></span>
<span id="cb841-17"><a href="análisis-de-varianza.html#cb841-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">any</span>(<span class="fu">replicate</span>(<span class="dv">100</span>, <span class="fu">get_p_val</span>()) <span class="sc">&lt;</span> <span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.994</code></pre>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="análisis-de-varianza.html#cb843-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FWER con 100 pruebas</span></span>
<span id="cb843-2"><a href="análisis-de-varianza.html#cb843-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tasa deseada = 0.05</span></span>
<span id="cb843-3"><a href="análisis-de-varianza.html#cb843-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ajuste bonferroni</span></span>
<span id="cb843-4"><a href="análisis-de-varianza.html#cb843-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">any</span>(<span class="fu">p.adjust</span>(<span class="fu">replicate</span>(<span class="dv">100</span>, <span class="fu">get_p_val</span>()), <span class="st">&quot;bonferroni&quot;</span>) <span class="sc">&lt;</span> <span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.058</code></pre>
<p>Para el caso específico de probar todas las diferencias medias de dos vías después de una prueba ANOVA, existen <a href="https://en.wikipedia.org/wiki/Post_hoc_analysis" target="_blank">varios métodos potenciales</a> para hacer un ajuste de este tipo. Los pros y los contras de los métodos potenciales están más allá del alcance de este curso. Elegimos un método por su facilidad de uso.</p>
<p>La diferencia de significancia de Tukey se puede aplicar directamente a un objeto que fue creado usando <code>aov()</code>. Ajustará los valores p de las comparaciones por pares de las medias para controlar el FWER, en este caso, para 0.05. Observe que también proporciona intervalos de confianza para la diferencia de las medias.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="análisis-de-varianza.html#cb845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(coag_aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = coag ~ diet, data = coagulation)
## 
## $diet
##     diff         lwr       upr     p adj
## B-A    5   0.7245544  9.275446 0.0183283
## C-A    7   2.7245544 11.275446 0.0009577
## D-A    0  -4.0560438  4.056044 1.0000000
## C-B    2  -1.8240748  5.824075 0.4766005
## D-B   -5  -8.5770944 -1.422906 0.0044114
## D-C   -7 -10.5770944 -3.422906 0.0001268</code></pre>
<p>Según estos resultados, no vemos ninguna diferencia entre <code>A</code> y <code>D</code>, así como entre <code>B</code> y <code>C</code>. Todas las demás comparaciones por pares son significativas. Si vuelve a la gráfica de caja original, estos resultados no deberían sorprender.</p>
<p>Además, podemos producir fácilmente un gráfico de estos intervalos de confianza.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="análisis-de-varianza.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(coag_aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-364-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>El creador de este método, <a href="https://en.wikipedia.org/wiki/John_Tukey" target="_blank">John Tukey</a>, es una figura importante en la historia de la ciencia de datos. Básicamente <a href="https://projecteuclid.org/euclid.aoms/1177704711" target="_blank">predijo el auge de la ciencia de datos hace más de 50 años</a>. Para ver algunas reflexiones retrospectivas sobre esos 50 años, consulte <a href="http://courses.csail.mit.edu/18.337/2015/docs/50YearsDataScience.pdf" target="_blank">este artículo de David Donoho</a>.</p>
</div>
<div id="anova-de-dos-vías" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> ANOVA de dos vías</h2>
<p>¿Qué pasa si hay más de una variable factor? ¿Por qué tenemos que limitarnos a experimentar con un solo factor? ¡Nosotros no! Considere el modelo</p>
<p><span class="math display">\[
y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha \beta)_{ij} + \epsilon_{ijk}.
\]</span></p>
<p>donde <span class="math inline">\(\epsilon_{ijk}\)</span> son variables aleatorias <span class="math inline">\(N(0, \sigma^2)\)</span>.</p>
<p>Agregamos restricciones</p>
<p><span class="math display">\[
\sum \alpha_i = 0 \quad \quad \sum \beta_j = 0.
\]</span></p>
<p>y</p>
<p><span class="math display">\[
(\alpha \beta)_{1j} + (\alpha \beta)_{2j} + (\alpha \beta)_{3j} = 0 \\
(\alpha \beta)_{i1} + (\alpha \beta)_{i2} + (\alpha \beta)_{i3} + (\alpha \beta)_{i4} = 0
\]</span></p>
<p>para cualquier <span class="math inline">\(i\)</span> o <span class="math inline">\(j\)</span>.</p>
<p>Aquí,</p>
<ul>
<li><span class="math inline">\(i=1,2, \ldots I\)</span> donde <span class="math inline">\(I\)</span> es el número de niveles del factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(j=1,2, \ldots J\)</span> donde <span class="math inline">\(J\)</span> es el número de niveles del factor <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\(k=1,2, \ldots K\)</span> donde <span class="math inline">\(K\)</span> es el número de réplicas por grupo.</li>
</ul>
<p>Aquí, podemos pensar en un grupo como una combinación de un nivel de cada uno de los factores. Entonces, por ejemplo, un grupo recibirá el nivel <span class="math inline">\(2\)</span> del factor <span class="math inline">\(A\)</span> y el nivel <span class="math inline">\(3\)</span> del factor <span class="math inline">\(B\)</span>. El número de réplicas es el número de sujetos en cada grupo. Por ejemplo, <span class="math inline">\(y_{135}\)</span> sería la medida para el quinto miembro (réplica) del grupo para el nivel <span class="math inline">\(1\)</span> del factor <span class="math inline">\(A\)</span> y el nivel <span class="math inline">\(3\)</span> del factor <span class="math inline">\(B\)</span>.</p>
<p>A esta configuración la llamamos <span class="math inline">\(I \times J\)</span> <strong>diseño factorial</strong> con réplicas de <span class="math inline">\(K\)</span>. (Nuestra notación actual solo permite réplicas iguales en cada grupo. No es difícil permitir réplicas diferentes para grupos diferentes, pero procederemos a usar réplicas iguales por grupo, lo cual, es deseable).</p>
<ul>
<li><span class="math inline">\(\alpha_i\)</span> mide el efecto del nivel <span class="math inline">\(i\)</span> del factor <span class="math inline">\(A\)</span>. A estos los llamamos los <strong>efectos principales</strong> del factor <span class="math inline">\(A\)</span>.</li>
<li><span class="math inline">\(\beta_j\)</span> mide el efecto del nivel <span class="math inline">\(j\)</span> del factor <span class="math inline">\(B\)</span>. A estos los llamamos los <strong>efectos principales</strong> del factor <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\((\alpha\beta)_{ij}\)</span> es un solo parámetro. Usamos <span class="math inline">\(\alpha\beta\)</span> para notar que este parámetro mide la <strong>interacción</strong> entre los dos efectos principales.</li>
</ul>
<p>Bajo esta configuración, hay varios modelos que podemos comparar. Considere un diseño factorial de <span class="math inline">\(2 \times 2\)</span>. Las siguientes tablas muestran las medias para cada uno de los posibles grupos de cada modelo.</p>
<p>Modelo de <strong>Interacción</strong>: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha \beta)_{ij} + \epsilon_{ijk}\)</span></p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Factor B, Nivel 1</strong></th>
<th><strong>Factor B, Nivel 2</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Factor A, Nivel 1</strong></td>
<td><span class="math inline">\(\mu + \alpha_1 + \beta_1 + (\alpha\beta)_{11}\)</span></td>
<td><span class="math inline">\(\mu + \alpha_1 + \beta_2 + (\alpha\beta)_{12}\)</span></td>
</tr>
<tr class="even">
<td><strong>Factor A, Nivel 2</strong></td>
<td><span class="math inline">\(\mu + \alpha_2 + \beta_1 + (\alpha\beta)_{21}\)</span></td>
<td><span class="math inline">\(\mu + \alpha_2 + \beta_2 + (\alpha\beta)_{22}\)</span></td>
</tr>
</tbody>
</table>
<p>Modelo <strong>Aditivo</strong>: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}\)</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>Factor B, Nivel 1</strong></th>
<th><strong>Factor B, Nivel 2</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Factor A, Nivel 1</strong></td>
<td><span class="math inline">\(\mu + \alpha_1 + \beta_1\)</span></td>
<td><span class="math inline">\(\mu + \alpha_1 + \beta_2\)</span></td>
</tr>
<tr class="even">
<td><strong>Factor A, Nivel 2</strong></td>
<td><span class="math inline">\(\mu + \alpha_2 + \beta_1\)</span></td>
<td><span class="math inline">\(\mu + \alpha_2 + \beta_2\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Factor B</strong> Modelo (una vía): <span class="math inline">\(y_{ijk} = \mu + \beta_j + \epsilon_{ijk}\)</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>Factor B, Nivel 1</strong></th>
<th><strong>Factor B, Nivel 2</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Factor A, Nivel 1</strong></td>
<td><span class="math inline">\(\mu + \beta_1\)</span></td>
<td><span class="math inline">\(\mu + \beta_2\)</span></td>
</tr>
<tr class="even">
<td><strong>Factor A, Nivel 2</strong></td>
<td><span class="math inline">\(\mu + \beta_1\)</span></td>
<td><span class="math inline">\(\mu + \beta_2\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Factor A</strong> Modelo (una vía): <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \epsilon_{ijk}\)</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>Factor B, Nivel 1</strong></th>
<th><strong>Factor B, Nivel 2</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Factor A, Nivel 1</strong></td>
<td><span class="math inline">\(\mu + \alpha_1\)</span></td>
<td><span class="math inline">\(\mu + \alpha_1\)</span></td>
</tr>
<tr class="even">
<td><strong>Factor A, Nivel 2</strong></td>
<td><span class="math inline">\(\mu + \alpha_2\)</span></td>
<td><span class="math inline">\(\mu + \alpha_2\)</span></td>
</tr>
</tbody>
</table>
<p>Modelo <strong>Nulo</strong> : <span class="math inline">\(y_{ijk} = \mu + \epsilon_{ijk}\)</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>Factor B, Nivel 1</strong></th>
<th><strong>Factor B, Nivel 2</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Factor A, Nivel 1</strong></td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td><strong>Factor A, Nivel 2</strong></td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
</tbody>
</table>
<p>La pregunta entonces es ¿cuál de estos modelos deberíamos usar si tenemos dos factores? La pregunta más importante a considerar es si debemos modelar la <strong>interacción</strong>. ¿Es el efecto del factor A <em>el mismo</em> para todos los niveles del factor B? en el modelo aditivo, sí. En el modelo de interacción, no. Ambos modelos utilizarían una media diferente para cada grupo, pero de forma muy específica en ambos casos.</p>
<p>Analicemos estas comparaciones observando algunos ejemplos. Primero veremos los datos de <code>rats</code> del paquete <code>faraway</code>. Aquí hay dos factores: <code>poison</code> y <code>treat</code>. Usamos la función <code>levels()</code> para extraer los niveles de una variable factor.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="análisis-de-varianza.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(rats<span class="sc">$</span>poison)</span></code></pre></div>
<pre><code>## [1] &quot;I&quot;   &quot;II&quot;  &quot;III&quot;</code></pre>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="análisis-de-varianza.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(rats<span class="sc">$</span>treat)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;</code></pre>
<p>Aquí, se asignó aleatoriamente a 48 ratas tanto a uno de los tres venenos como a uno de los cuatro tratamientos posibles. Luego, los experimentadores miden su tiempo de supervivencia en decenas de horas. Un total de 12 grupos, cada uno con 4 repeticiones.</p>
<p>Antes de ejecutar cualquier prueba, primero debemos mirar los datos. Crearemos ** gráficos de interacción **, que nos ayudarán a visualizar el efecto de un factor a medida que avanzamos por los niveles de otro factor.</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="análisis-de-varianza.html#cb852-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb852-2"><a href="análisis-de-varianza.html#cb852-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(rats, <span class="fu">interaction.plot</span>(poison, treat, time, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb852-3"><a href="análisis-de-varianza.html#cb852-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(rats, <span class="fu">interaction.plot</span>(treat, poison, time, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-366-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>No hay interacción, por lo tanto, en un modelo aditivo, esperaríamos ver líneas paralelas. Eso significaría que cuando cambiamos el nivel de un factor, puede haber un efecto en la respuesta. Sin embargo, la diferencia entre los niveles del otro factor debería seguir siendo la misma.</p>
<p>La indicación obvia de interacción serían las líneas que se cruzan mientras se dirigen en diferentes direcciones. Aquí no vemos eso, pero las líneas no son estrictamente paralelas y hay algo de superposición en el panel derecho. Sin embargo, ¿este efecto de interacción es significativo?</p>
<p>Ajustemos cada uno de los posibles modelos, luego observemos sus estimaciones para cada una de las medias del grupo.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="análisis-de-varianza.html#cb853-1" aria-hidden="true" tabindex="-1"></a>rats_int   <span class="ot">=</span> <span class="fu">aov</span>(time <span class="sc">~</span> poison <span class="sc">*</span> treat, <span class="at">data =</span> rats) <span class="co"># modelo de interacción</span></span>
<span id="cb853-2"><a href="análisis-de-varianza.html#cb853-2" aria-hidden="true" tabindex="-1"></a>rats_add   <span class="ot">=</span> <span class="fu">aov</span>(time <span class="sc">~</span> poison <span class="sc">+</span> treat, <span class="at">data =</span> rats) <span class="co"># modelo aditivo</span></span>
<span id="cb853-3"><a href="análisis-de-varianza.html#cb853-3" aria-hidden="true" tabindex="-1"></a>rats_pois  <span class="ot">=</span> <span class="fu">aov</span>(time <span class="sc">~</span> poison , <span class="at">data =</span> rats)        <span class="co"># modelo de factor único   </span></span>
<span id="cb853-4"><a href="análisis-de-varianza.html#cb853-4" aria-hidden="true" tabindex="-1"></a>rats_treat <span class="ot">=</span> <span class="fu">aov</span>(time <span class="sc">~</span> treat, <span class="at">data =</span> rats)          <span class="co"># modelo de factor único</span></span>
<span id="cb853-5"><a href="análisis-de-varianza.html#cb853-5" aria-hidden="true" tabindex="-1"></a>rats_null  <span class="ot">=</span> <span class="fu">aov</span>(time <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> rats)              <span class="co"># modelo nulo</span></span></code></pre></div>
<p>Para obtener las estimaciones, crearemos una tabla en la que predeciremos.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="análisis-de-varianza.html#cb854-1" aria-hidden="true" tabindex="-1"></a>rats_table <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">poison =</span> <span class="fu">unique</span>(rats<span class="sc">$</span>poison), <span class="at">treat =</span> <span class="fu">unique</span>(rats<span class="sc">$</span>treat))</span>
<span id="cb854-2"><a href="análisis-de-varianza.html#cb854-2" aria-hidden="true" tabindex="-1"></a>rats_table</span></code></pre></div>
<pre><code>##    poison treat
## 1       I     A
## 2      II     A
## 3     III     A
## 4       I     B
## 5      II     B
## 6     III     B
## 7       I     C
## 8      II     C
## 9     III     C
## 10      I     D
## 11     II     D
## 12    III     D</code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="análisis-de-varianza.html#cb856-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">paste0</span>(rats_table<span class="sc">$</span>poison, <span class="st">&quot;-&quot;</span>, rats_table<span class="sc">$</span>treat) , <span class="dv">4</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##      [,1]  [,2]   [,3]   
## [1,] &quot;I-A&quot; &quot;II-A&quot; &quot;III-A&quot;
## [2,] &quot;I-B&quot; &quot;II-B&quot; &quot;III-B&quot;
## [3,] &quot;I-C&quot; &quot;II-C&quot; &quot;III-C&quot;
## [4,] &quot;I-D&quot; &quot;II-D&quot; &quot;III-D&quot;</code></pre>
<p>Como repetiremos varias veces, escribimos una función para realizar la predicción. Se realizan algunas tareas de limpieza para mantener las estimaciones en orden y proporcionar nombres de filas y columnas. Arriba, mostramos dónde se colocarán cada una de las estimaciones en la matriz resultante.</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="análisis-de-varianza.html#cb858-1" aria-hidden="true" tabindex="-1"></a>get_est_means <span class="ot">=</span> <span class="cf">function</span>(model, table) {</span>
<span id="cb858-2"><a href="análisis-de-varianza.html#cb858-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">predict</span>(model, table), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb858-3"><a href="análisis-de-varianza.html#cb858-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;II&quot;</span>, <span class="st">&quot;III&quot;</span>)</span>
<span id="cb858-4"><a href="análisis-de-varianza.html#cb858-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(mat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb858-5"><a href="análisis-de-varianza.html#cb858-5" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb858-6"><a href="análisis-de-varianza.html#cb858-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Primero, obtenemos las estimaciones del modelo de <strong>interacción</strong>. Tenga en cuenta que cada celda tiene un valor diferente.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="análisis-de-varianza.html#cb859-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_est_means</span>(<span class="at">model =</span> rats_int, <span class="at">table =</span> rats_table))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">I</th>
<th align="right">II</th>
<th align="right">III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.4125</td>
<td align="right">0.3200</td>
<td align="right">0.210</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0.8800</td>
<td align="right">0.8150</td>
<td align="right">0.335</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.5675</td>
<td align="right">0.3750</td>
<td align="right">0.235</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0.6100</td>
<td align="right">0.6675</td>
<td align="right">0.325</td>
</tr>
</tbody>
</table>
<p>A continuación, obtenemos las estimaciones del modelo <strong>aditivo</strong>. Nuevamente, cada celda tiene un valor diferente. También vemos que estas estimaciones se acercan un poco a las del modelo de interacción.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="análisis-de-varianza.html#cb860-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_est_means</span>(<span class="at">model =</span> rats_add, <span class="at">table =</span> rats_table))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">I</th>
<th align="right">II</th>
<th align="right">III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.4522917</td>
<td align="right">0.3791667</td>
<td align="right">0.1110417</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0.8147917</td>
<td align="right">0.7416667</td>
<td align="right">0.4735417</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.5306250</td>
<td align="right">0.4575000</td>
<td align="right">0.1893750</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0.6722917</td>
<td align="right">0.5991667</td>
<td align="right">0.3310417</td>
</tr>
</tbody>
</table>
<p>Para comprender la diferencia, consideremos el efecto de los tratamientos.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="análisis-de-varianza.html#cb861-1" aria-hidden="true" tabindex="-1"></a>additive_means <span class="ot">=</span> <span class="fu">get_est_means</span>(<span class="at">model =</span> rats_add, <span class="at">table =</span> rats_table)</span>
<span id="cb861-2"><a href="análisis-de-varianza.html#cb861-2" aria-hidden="true" tabindex="-1"></a>additive_means[<span class="st">&quot;A&quot;</span>,] <span class="sc">-</span> additive_means[<span class="st">&quot;B&quot;</span>,]</span></code></pre></div>
<pre><code>##       I      II     III 
## -0.3625 -0.3625 -0.3625</code></pre>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="análisis-de-varianza.html#cb863-1" aria-hidden="true" tabindex="-1"></a>interaction_means <span class="ot">=</span> <span class="fu">get_est_means</span>(<span class="at">model =</span> rats_int, <span class="at">table =</span> rats_table)</span>
<span id="cb863-2"><a href="análisis-de-varianza.html#cb863-2" aria-hidden="true" tabindex="-1"></a>interaction_means[<span class="st">&quot;A&quot;</span>,] <span class="sc">-</span> interaction_means[<span class="st">&quot;B&quot;</span>,]</span></code></pre></div>
<pre><code>##       I      II     III 
## -0.4675 -0.4950 -0.1250</code></pre>
<p>Esta es la diferencia clave entre los modelos de interacción y aditivos. La diferencia entre el efecto de los tratamientos <code>A</code> y <code>B</code> es <strong>igual</strong> para cada veneno en el modelo aditivo. Ahora, son <strong>diferentes</strong> en el modelo de interacción.</p>
<p>Los tres modelos restantes son mucho más simples, ya sea que solo tienen efectos de fila o de columna. O sin efectos en el caso del modelo nulo.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="análisis-de-varianza.html#cb865-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_est_means</span>(<span class="at">model =</span> rats_pois, <span class="at">table =</span> rats_table))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">I</th>
<th align="right">II</th>
<th align="right">III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.6175</td>
<td align="right">0.544375</td>
<td align="right">0.27625</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0.6175</td>
<td align="right">0.544375</td>
<td align="right">0.27625</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.6175</td>
<td align="right">0.544375</td>
<td align="right">0.27625</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0.6175</td>
<td align="right">0.544375</td>
<td align="right">0.27625</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="análisis-de-varianza.html#cb866-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_est_means</span>(<span class="at">model =</span> rats_treat, <span class="at">table =</span> rats_table))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">I</th>
<th align="right">II</th>
<th align="right">III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.3141667</td>
<td align="right">0.3141667</td>
<td align="right">0.3141667</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0.6766667</td>
<td align="right">0.6766667</td>
<td align="right">0.6766667</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.3925000</td>
<td align="right">0.3925000</td>
<td align="right">0.3925000</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0.5341667</td>
<td align="right">0.5341667</td>
<td align="right">0.5341667</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="análisis-de-varianza.html#cb867-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_est_means</span>(<span class="at">model =</span> rats_null, <span class="at">table =</span> rats_table))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">I</th>
<th align="right">II</th>
<th align="right">III</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
<td align="right">0.479375</td>
</tr>
</tbody>
</table>
<p>Para realizar las pruebas necesarias, necesitaremos crear otra tabla ANOVA. (Omitiremos los detalles de los cálculos de sumas de cuadrados y simplemente dejaremos que <code>R</code> se encargue de ellos).</p>
<table>
<thead>
<tr class="header">
<th>Fuente</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado medio</th>
<th><span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factor A</td>
<td>SSA</td>
<td><span class="math inline">\(I -1\)</span></td>
<td>SSA / DFA</td>
<td>MSA / MSE</td>
</tr>
<tr class="even">
<td>Factor B</td>
<td>SSB</td>
<td><span class="math inline">\(J -1\)</span></td>
<td>SSB / DFB</td>
<td>MSB / MSE</td>
</tr>
<tr class="odd">
<td>Interacción AB</td>
<td>SSAB</td>
<td><span class="math inline">\((I -1)(J -1)\)</span></td>
<td>SSAB / DFAB</td>
<td>MSAB / MSE</td>
</tr>
<tr class="even">
<td>Error</td>
<td>SSE</td>
<td><span class="math inline">\(IJ(K - 1)\)</span></td>
<td>SSE / DFE</td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td>SST</td>
<td><span class="math inline">\(IJK - 1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>La fila para las pruebas de <strong>Interacción AB</strong>:</p>
<p><span class="math display">\[
H_0: \text{ Todos }(\alpha\beta)_{ij} = 0. \quad \text{vs} \quad H_1: \text{ No todos } (\alpha\beta)_{ij} \text{ son } 0.
\]</span></p>
<ul>
<li>Modelo nulo: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.\)</span> (Modelo aditivo.)</li>
<li>Modelo alternativo: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha \beta)_{ij} + \epsilon_{ijk}.\)</span> (Modelo de interacción).</li>
</ul>
<p>Rechazamos la hipótesis nula cuando la estadística <span class="math inline">\(F\)</span> es grande. Bajo la hipótesis nula, la distribución del estadístico de prueba es <span class="math inline">\(F\)</span> con grados de libertad <span class="math inline">\((I-1)(J-1)\)</span> y <span class="math inline">\(IJ(K-1)\)</span>.</p>
<p>La fila para las pruebas de <strong>Factor B</strong>:</p>
<p><span class="math display">\[
H_0: \text{ Todos }\beta_{j} = 0. \quad \text{vs} \quad H_1: \text{ No todos } \beta_{j} \text{ son } 0.
\]</span></p>
<ul>
<li>Modelo nulo: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \epsilon_{ijk}.\)</span> (Modelo de factor A.)</li>
<li>Modelo alternativo: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.\)</span> (Modelo aditivo.)</li>
</ul>
<p>Rechazamos el valor nulo cuando la estadística <span class="math inline">\(F\)</span> es grande. Bajo la hipótesis nula, la distribución del estadístico de prueba es <span class="math inline">\(F\)</span> con grados de libertad <span class="math inline">\(J-1\)</span> y <span class="math inline">\(IJ(K-1)\)</span>.</p>
<p>La fila para las pruebas de <strong>Factor A</strong>:</p>
<p><span class="math display">\[
H_0: \text{ Todos }\alpha_{i} = 0. \quad \text{vs} \quad H_1: \text{ No todos } \alpha_{i} \text{ son } 0.
\]</span></p>
<ul>
<li>Modelo nulo: <span class="math inline">\(y_{ijk} = \mu + \beta_j + \epsilon_{ijk}.\)</span> (Modelo de factor B)</li>
<li>Modelo alternativo: <span class="math inline">\(y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.\)</span> (Modelo aditivo.)</li>
</ul>
<p>Rechazamos la hipótesis nula cuando la estadística <span class="math inline">\(F\)</span> es grande. Bajo la hipótesis nula, la distribución del estadístico de prueba es <span class="math inline">\(F\)</span> con grados de libertad <span class="math inline">\(I-1\)</span> y <span class="math inline">\(IJ(K-1)\)</span>.</p>
<p>Estas pruebas deben realizarse de acuerdo con el modelo de <strong>jerarquía</strong>. Primero considere la prueba de interacción. Si es significativo, seleccionamos el modelo de interacción y no realizamos más pruebas. Si la interacción no es significativa, entonces consideramos la necesidad de los factores individuales del modelo aditivo.</p>
<div class="figure">
<img src="images/hierarchy.png" alt="" />
<p class="caption">Jerarquía de modelos</p>
</div>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="análisis-de-varianza.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(time <span class="sc">~</span> poison <span class="sc">*</span> treat, <span class="at">data =</span> rats))</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## poison        2 1.0330  0.5165  23.222 3.33e-07 ***
## treat         3 0.9212  0.3071  13.806 3.78e-06 ***
## poison:treat  6 0.2501  0.0417   1.874    0.112    
## Residuals    36 0.8007  0.0222                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Usando un nivel de significancia de <span class="math inline">\(\alpha=0.05\)</span>, vemos que la interacción no es significativa. Dentro del modelo aditivo, ambos factores son significativos, por lo que seleccionamos el modelo aditivo.</p>
<!-- - TODO: mention no replication, interaction issue -->
<!-- - TODO: correct if int is not significant? -->
<!-- - TODO: here we pick the full additive model -->
<p>Dentro del modelo aditivo, podríamos hacer más pruebas sobre los efectos principales.</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="análisis-de-varianza.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(time <span class="sc">~</span> poison <span class="sc">+</span> treat, <span class="at">data =</span> rats))</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = time ~ poison + treat, data = rats)
## 
## $poison
##             diff        lwr        upr     p adj
## II-I   -0.073125 -0.2089936  0.0627436 0.3989657
## III-I  -0.341250 -0.4771186 -0.2053814 0.0000008
## III-II -0.268125 -0.4039936 -0.1322564 0.0000606
## 
## $treat
##            diff         lwr         upr     p adj
## B-A  0.36250000  0.18976135  0.53523865 0.0000083
## C-A  0.07833333 -0.09440532  0.25107198 0.6221729
## D-A  0.22000000  0.04726135  0.39273865 0.0076661
## C-B -0.28416667 -0.45690532 -0.11142802 0.0004090
## D-B -0.14250000 -0.31523865  0.03023865 0.1380432
## D-C  0.14166667 -0.03107198  0.31440532 0.1416151</code></pre>
<p>Para ver un ejemplo <strong>con</strong> interacción, investigamos el conjunto de datos <code>warpbreaks</code>, un conjunto de datos predeterminado en <code>R</code>.</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="análisis-de-varianza.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb872-2"><a href="análisis-de-varianza.html#cb872-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(warpbreaks, <span class="fu">interaction.plot</span>(wool, tension, breaks, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb872-3"><a href="análisis-de-varianza.html#cb872-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(warpbreaks, <span class="fu">interaction.plot</span>(tension, wool, breaks, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-381-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Cualquiera de las dos gráficas deja bastante claro que los factores de <code>wool</code> y <code>tension</code> interactúan.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="análisis-de-varianza.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(breaks <span class="sc">~</span> wool <span class="sc">*</span> tension, <span class="at">data =</span> warpbreaks))</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## wool          1    451   450.7   3.765 0.058213 .  
## tension       2   2034  1017.1   8.498 0.000693 ***
## wool:tension  2   1003   501.4   4.189 0.021044 *  
## Residuals    48   5745   119.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Usando un <span class="math inline">\(\alpha\)</span> de <span class="math inline">\(0.05\)</span>, la prueba ANOVA encuentra que la interacción es significativa, por lo que usamos el modelo de interacción.</p>
<!-- TODO: two-way calculation details in an appendix -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interacciones-y-predictores-categóricos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diagnóstico-de-modelos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
