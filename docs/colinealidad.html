<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 20 Colinealidad | Estadística aplicada con R</title>
  <meta name="description" content="Capítulo 20 Colinealidad | Estadística aplicada con R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 20 Colinealidad | Estadística aplicada con R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 20 Colinealidad | Estadística aplicada con R" />
  
  
  



<meta name="date" content="2021-05-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon" />
<link rel="prev" href="transformaciones.html"/>
<link rel="next" href="selección-de-variables-y-construcción-de-modelos.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística aplicada con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#convenciones"><i class="fa fa-check"></i><b>1.1</b> Convenciones</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>3</b> Introducción a <code>R</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#primeros-pasos"><i class="fa fa-check"></i><b>3.1</b> Primeros pasos</a></li>
<li class="chapter" data-level="3.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#cálculos-básicos"><i class="fa fa-check"></i><b>3.2</b> Cálculos básicos</a></li>
<li class="chapter" data-level="3.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#obteniendo-ayuda"><i class="fa fa-check"></i><b>3.3</b> Obteniendo ayuda</a></li>
<li class="chapter" data-level="3.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>3.4</b> Instalación de paquetes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datos-y-programación.html"><a href="datos-y-programación.html"><i class="fa fa-check"></i><b>4</b> Datos y programación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#tipos-de-datos"><i class="fa fa-check"></i><b>4.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="4.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#estructuras-de-datos"><i class="fa fa-check"></i><b>4.2</b> Estructuras de datos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectores"><i class="fa fa-check"></i><b>4.2.1</b> Vectores</a></li>
<li class="chapter" data-level="4.2.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectorización"><i class="fa fa-check"></i><b>4.2.2</b> Vectorización</a></li>
<li class="chapter" data-level="4.2.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#operadores-logicos"><i class="fa fa-check"></i><b>4.2.3</b> Operadores logicos</a></li>
<li class="chapter" data-level="4.2.4" data-path="datos-y-programación.html"><a href="datos-y-programación.html#más-vectorización"><i class="fa fa-check"></i><b>4.2.4</b> Más vectorización</a></li>
<li class="chapter" data-level="4.2.5" data-path="datos-y-programación.html"><a href="datos-y-programación.html#matrices"><i class="fa fa-check"></i><b>4.2.5</b> Matrices</a></li>
<li class="chapter" data-level="4.2.6" data-path="datos-y-programación.html"><a href="datos-y-programación.html#listas"><i class="fa fa-check"></i><b>4.2.6</b> Listas</a></li>
<li class="chapter" data-level="4.2.7" data-path="datos-y-programación.html"><a href="datos-y-programación.html#marcos-de-datos"><i class="fa fa-check"></i><b>4.2.7</b> Marcos de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#conceptos-básicos-de-programación"><i class="fa fa-check"></i><b>4.3</b> Conceptos básicos de programación</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#flujo-de-control"><i class="fa fa-check"></i><b>4.3.1</b> Flujo de control</a></li>
<li class="chapter" data-level="4.3.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#funciones"><i class="fa fa-check"></i><b>4.3.2</b> Funciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>5</b> Literature</a></li>
<li class="chapter" data-level="6" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>6</b> Methods</a></li>
<li class="chapter" data-level="7" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html"><i class="fa fa-check"></i><b>7</b> Resumen de datos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#resumen-estadístico"><i class="fa fa-check"></i><b>7.1</b> Resumen estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#tendencia-central"><i class="fa fa-check"></i>Tendencia central</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#dispersión"><i class="fa fa-check"></i>Dispersión</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#categórica"><i class="fa fa-check"></i>Categórica</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#graficas"><i class="fa fa-check"></i><b>7.2</b> Graficas</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#histogramas"><i class="fa fa-check"></i><b>7.2.1</b> Histogramas</a></li>
<li class="chapter" data-level="7.2.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-barras"><i class="fa fa-check"></i><b>7.2.2</b> Gráfico de barras</a></li>
<li class="chapter" data-level="7.2.3" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#diagramas-de-cajas"><i class="fa fa-check"></i><b>7.2.3</b> Diagramas de cajas</a></li>
<li class="chapter" data-level="7.2.4" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-dispersión"><i class="fa fa-check"></i><b>7.2.4</b> Gráfico de dispersión</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>8</b> Applications</a>
<ul>
<li class="chapter" data-level="8.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>8.1</b> Example one</a></li>
<li class="chapter" data-level="8.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>8.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html"><i class="fa fa-check"></i><b>9</b> Probabilidad y estadística en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#probabilidad-en-r"><i class="fa fa-check"></i><b>9.1</b> Probabilidad en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribuciones"><i class="fa fa-check"></i><b>9.1.1</b> Distribuciones</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#pruebas-de-hipótesis-en-r"><i class="fa fa-check"></i><b>9.2</b> Pruebas de hipótesis en <code>R</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-revisión"><i class="fa fa-check"></i><b>9.2.1</b> Prueba t de una muestra: revisión</a></li>
<li class="chapter" data-level="9.2.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-ejemplo"><i class="fa fa-check"></i><b>9.2.2</b> Prueba t de una muestra: ejemplo</a></li>
<li class="chapter" data-level="9.2.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-revisión"><i class="fa fa-check"></i><b>9.2.3</b> Prueba t de dos muestras: revisión</a></li>
<li class="chapter" data-level="9.2.4" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-ejemplo"><i class="fa fa-check"></i><b>9.2.4</b> Prueba t de dos muestras: Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#simulación"><i class="fa fa-check"></i><b>9.3</b> Simulación</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#diferencias-emparejadas"><i class="fa fa-check"></i><b>9.3.1</b> Diferencias emparejadas</a></li>
<li class="chapter" data-level="9.3.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribución-de-una-media-muestral"><i class="fa fa-check"></i><b>9.3.2</b> Distribución de una media muestral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="recursos-r.html"><a href="recursos-r.html"><i class="fa fa-check"></i><b>10</b> Recursos <code>R</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="recursos-r.html"><a href="recursos-r.html#referencias-y-tutoriales-para-principiantes"><i class="fa fa-check"></i><b>10.1</b> Referencias y tutoriales para principiantes</a></li>
<li class="chapter" data-level="10.2" data-path="recursos-r.html"><a href="recursos-r.html#referencias-intermedias"><i class="fa fa-check"></i><b>10.2</b> Referencias intermedias</a></li>
<li class="chapter" data-level="10.3" data-path="recursos-r.html"><a href="recursos-r.html#referencias-avanzadas"><i class="fa fa-check"></i><b>10.3</b> Referencias avanzadas</a></li>
<li class="chapter" data-level="10.4" data-path="recursos-r.html"><a href="recursos-r.html#comparaciones-rápidas-con-otros-lenguajes"><i class="fa fa-check"></i><b>10.4</b> Comparaciones rápidas con otros lenguajes</a></li>
<li class="chapter" data-level="10.5" data-path="recursos-r.html"><a href="recursos-r.html#vídeos-de-rstudio-y-rmarkdown"><i class="fa fa-check"></i><b>10.5</b> Vídeos de RStudio y RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>11</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="12" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html"><i class="fa fa-check"></i><b>12</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="12.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelado"><i class="fa fa-check"></i><b>12.1</b> Modelado</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelo-de-regresión-lineal-simple"><i class="fa fa-check"></i><b>12.1.1</b> Modelo de regresión lineal simple</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-mínimos-cuadrados"><i class="fa fa-check"></i><b>12.2</b> Enfoque de mínimos cuadrados</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#haciendo-predicciones"><i class="fa fa-check"></i><b>12.2.1</b> Haciendo predicciones</a></li>
<li class="chapter" data-level="12.2.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#residuales"><i class="fa fa-check"></i><b>12.2.2</b> Residuales</a></li>
<li class="chapter" data-level="12.2.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#estimación-de-la-varianza"><i class="fa fa-check"></i><b>12.2.3</b> Estimación de la varianza</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#descomposición-de-variación"><i class="fa fa-check"></i><b>12.3</b> Descomposición de variación</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>12.3.1</b> Coeficiente de determinación</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#la-función-lm"><i class="fa fa-check"></i><b>12.4</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="12.5" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-estimación-de-máxima-verosimilitud-mle"><i class="fa fa-check"></i><b>12.5</b> Enfoque de estimación de máxima verosimilitud (MLE)</a></li>
<li class="chapter" data-level="12.6" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#simulando-slr"><i class="fa fa-check"></i><b>12.6</b> Simulando SLR</a></li>
<li class="chapter" data-level="12.7" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#historia"><i class="fa fa-check"></i><b>12.7</b> Historia</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html"><i class="fa fa-check"></i><b>13</b> Inferencia para regresión lineal simple</a>
<ul>
<li class="chapter" data-level="13.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#teorema-de-gauss-markov"><i class="fa fa-check"></i><b>13.1</b> Teorema de Gauss-Markov</a></li>
<li class="chapter" data-level="13.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#distribuciones-muestrales"><i class="fa fa-check"></i><b>13.2</b> Distribuciones muestrales</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#simular-distribuciones-muestrales"><i class="fa fa-check"></i><b>13.2.1</b> Simular distribuciones muestrales</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#errores-estándar"><i class="fa fa-check"></i><b>13.3</b> Errores estándar</a></li>
<li class="chapter" data-level="13.4" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-para-pendiente-e-intercepto"><i class="fa fa-check"></i><b>13.4</b> Intervalos de confianza para pendiente e Intercepto</a></li>
<li class="chapter" data-level="13.5" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>13.5</b> Pruebas de hipótesis</a></li>
<li class="chapter" data-level="13.6" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#ejemplo-cars"><i class="fa fa-check"></i><b>13.6</b> Ejemplo <code>cars</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-en-r"><i class="fa fa-check"></i><b>13.6.1</b> Pruebas en <code>R</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-t."><i class="fa fa-check"></i><b>13.6.2</b> Significancia de la regresión, prueba t.</a></li>
<li class="chapter" data-level="13.6.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-en-r"><i class="fa fa-check"></i><b>13.6.3</b> Intervalos de confianza en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>13.7</b> Intervalo de confianza para la respuesta Promedio</a></li>
<li class="chapter" data-level="13.8" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-predicción-para-nuevas-observaciones"><i class="fa fa-check"></i><b>13.8</b> Intervalo de predicción para nuevas observaciones</a></li>
<li class="chapter" data-level="13.9" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#bandas-de-confianza-y-predicción"><i class="fa fa-check"></i><b>13.9</b> Bandas de confianza y predicción</a></li>
<li class="chapter" data-level="13.10" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-f"><i class="fa fa-check"></i><b>13.10</b> Significancia de la regresión, prueba F</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>14</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="14.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#enfoque-matricial-para-la-regresión"><i class="fa fa-check"></i><b>14.1</b> Enfoque matricial para la regresión</a></li>
<li class="chapter" data-level="14.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#distribución-muestral"><i class="fa fa-check"></i><b>14.2</b> Distribución muestral</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#pruebas-de-un-solo-parámetro"><i class="fa fa-check"></i><b>14.2.1</b> Pruebas de un solo parámetro</a></li>
<li class="chapter" data-level="14.2.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>14.2.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="14.2.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza-para-la-respuesta-media"><i class="fa fa-check"></i><b>14.2.3</b> Intervalos de confianza para la respuesta media</a></li>
<li class="chapter" data-level="14.2.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-predicción"><i class="fa fa-check"></i><b>14.2.4</b> Intervalos de predicción</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#significancia-de-la-regresión"><i class="fa fa-check"></i><b>14.3</b> Significancia de la regresión</a></li>
<li class="chapter" data-level="14.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#modelos-anidados"><i class="fa fa-check"></i><b>14.4</b> Modelos anidados</a></li>
<li class="chapter" data-level="14.5" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#simulación-1"><i class="fa fa-check"></i><b>14.5</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html"><i class="fa fa-check"></i><b>15</b> Construcción del modelo</a>
<ul>
<li class="chapter" data-level="15.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia-forma-y-ajuste."><i class="fa fa-check"></i><b>15.1</b> Familia, forma, y ajuste.</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#ajuste."><i class="fa fa-check"></i><b>15.1.1</b> Ajuste.</a></li>
<li class="chapter" data-level="15.1.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#forma"><i class="fa fa-check"></i><b>15.1.2</b> Forma</a></li>
<li class="chapter" data-level="15.1.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia"><i class="fa fa-check"></i><b>15.1.3</b> Familia</a></li>
<li class="chapter" data-level="15.1.4" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#modelo-asumido-modelo-ajustado"><i class="fa fa-check"></i><b>15.1.4</b> Modelo asumido, modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación-versus-predicción"><i class="fa fa-check"></i><b>15.2</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación"><i class="fa fa-check"></i><b>15.2.1</b> Explicación</a></li>
<li class="chapter" data-level="15.2.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#predicción"><i class="fa fa-check"></i><b>15.2.2</b> Predicción</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#resumen"><i class="fa fa-check"></i><b>15.3</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html"><i class="fa fa-check"></i><b>16</b> Interacciones y predictores categóricos</a>
<ul>
<li class="chapter" data-level="16.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-ficticias-dummy"><i class="fa fa-check"></i><b>16.1</b> Variables ficticias (Dummy)</a></li>
<li class="chapter" data-level="16.2" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#interacciones"><i class="fa fa-check"></i><b>16.2</b> Interacciones</a></li>
<li class="chapter" data-level="16.3" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-factor"><i class="fa fa-check"></i><b>16.3</b> Variables factor</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#factores-con-más-de-dos-niveles"><i class="fa fa-check"></i><b>16.3.1</b> Factores con más de dos niveles</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#parametrización"><i class="fa fa-check"></i><b>16.4</b> Parametrización</a></li>
<li class="chapter" data-level="16.5" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#construcción-de-modelos-más-grandes"><i class="fa fa-check"></i><b>16.5</b> Construcción de modelos más grandes</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html"><i class="fa fa-check"></i><b>17</b> Análisis de varianza</a>
<ul>
<li class="chapter" data-level="17.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#experimentos"><i class="fa fa-check"></i><b>17.1</b> Experimentos</a></li>
<li class="chapter" data-level="17.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#prueba-t-de-dos-muestras"><i class="fa fa-check"></i><b>17.2</b> Prueba t de dos muestras</a></li>
<li class="chapter" data-level="17.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-una-vía"><i class="fa fa-check"></i><b>17.3</b> ANOVA de una vía</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#variables-factor-1"><i class="fa fa-check"></i><b>17.3.1</b> Variables factor</a></li>
<li class="chapter" data-level="17.3.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#algo-de-simulación"><i class="fa fa-check"></i><b>17.3.2</b> Algo de simulación</a></li>
<li class="chapter" data-level="17.3.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#potencia"><i class="fa fa-check"></i><b>17.3.3</b> Potencia</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#pruebas-post-hoc"><i class="fa fa-check"></i><b>17.4</b> Pruebas Post Hoc</a></li>
<li class="chapter" data-level="17.5" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-dos-vías"><i class="fa fa-check"></i><b>17.5</b> ANOVA de dos vías</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html"><i class="fa fa-check"></i><b>18</b> Diagnóstico de modelos</a>
<ul>
<li class="chapter" data-level="18.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#supuestos-del-modelo"><i class="fa fa-check"></i><b>18.1</b> Supuestos del modelo</a></li>
<li class="chapter" data-level="18.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#comprobación-de-supuestos"><i class="fa fa-check"></i><b>18.2</b> Comprobación de supuestos</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráfica-de-ajustados-versus-residuos"><i class="fa fa-check"></i><b>18.2.1</b> Gráfica de ajustados versus residuos</a></li>
<li class="chapter" data-level="18.2.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-breusch-pagan"><i class="fa fa-check"></i><b>18.2.2</b> Prueba de Breusch-Pagan</a></li>
<li class="chapter" data-level="18.2.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#histogramas-1"><i class="fa fa-check"></i><b>18.2.3</b> Histogramas</a></li>
<li class="chapter" data-level="18.2.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráficos-q-q"><i class="fa fa-check"></i><b>18.2.4</b> Gráficos Q-Q</a></li>
<li class="chapter" data-level="18.2.5" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-shapiro-wilk"><i class="fa fa-check"></i><b>18.2.5</b> Prueba de Shapiro-Wilk</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#observaciones-inusuales"><i class="fa fa-check"></i><b>18.3</b> Observaciones inusuales</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#apalancamiento"><i class="fa fa-check"></i><b>18.3.1</b> Apalancamiento</a></li>
<li class="chapter" data-level="18.3.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#valores-atípicos"><i class="fa fa-check"></i><b>18.3.2</b> Valores atípicos</a></li>
<li class="chapter" data-level="18.3.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#influencia"><i class="fa fa-check"></i><b>18.3.3</b> Influencia</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#ejemplos-de-análisis-de-datos"><i class="fa fa-check"></i><b>18.4</b> Ejemplos de análisis de datos</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#buenos-diagnósticos"><i class="fa fa-check"></i><b>18.4.1</b> Buenos diagnósticos</a></li>
<li class="chapter" data-level="18.4.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#diagnóstico-sospechoso"><i class="fa fa-check"></i><b>18.4.2</b> Diagnóstico sospechoso</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="transformaciones.html"><a href="transformaciones.html"><i class="fa fa-check"></i><b>19</b> Transformaciones</a>
<ul>
<li class="chapter" data-level="19.1" data-path="transformaciones.html"><a href="transformaciones.html#transformación-de-respuesta"><i class="fa fa-check"></i><b>19.1</b> Transformación de respuesta</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-estabilizadoras-de-varianza"><i class="fa fa-check"></i><b>19.1.1</b> Transformaciones estabilizadoras de varianza</a></li>
<li class="chapter" data-level="19.1.2" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-box-cox"><i class="fa fa-check"></i><b>19.1.2</b> Transformaciones de Box-Cox</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="transformaciones.html"><a href="transformaciones.html#transformación-del-predictor"><i class="fa fa-check"></i><b>19.2</b> Transformación del predictor</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="transformaciones.html"><a href="transformaciones.html#polinomios"><i class="fa fa-check"></i><b>19.2.1</b> Polinomios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-respuesta"><i class="fa fa-check"></i>Transformaciones de respuesta</a></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-predictores"><i class="fa fa-check"></i>Transformaciones de predictores</a>
<ul>
<li class="chapter" data-level="19.2.2" data-path="transformaciones.html"><a href="transformaciones.html#un-modelo-cuadrático"><i class="fa fa-check"></i><b>19.2.2</b> Un modelo cuadrático</a></li>
<li class="chapter" data-level="19.2.3" data-path="transformaciones.html"><a href="transformaciones.html#sobreajuste-y-extrapolación"><i class="fa fa-check"></i><b>19.2.3</b> Sobreajuste y extrapolación</a></li>
<li class="chapter" data-level="19.2.4" data-path="transformaciones.html"><a href="transformaciones.html#comparación-de-modelos-polinomiales"><i class="fa fa-check"></i><b>19.2.4</b> Comparación de modelos polinomiales</a></li>
<li class="chapter" data-level="19.2.5" data-path="transformaciones.html"><a href="transformaciones.html#poly-función-y-polinomios-ortogonales"><i class="fa fa-check"></i><b>19.2.5</b> <code>poly()</code> Función y polinomios ortogonales</a></li>
<li class="chapter" data-level="19.2.6" data-path="transformaciones.html"><a href="transformaciones.html#función-de-inhibición"><i class="fa fa-check"></i><b>19.2.6</b> Función de inhibición</a></li>
<li class="chapter" data-level="19.2.7" data-path="transformaciones.html"><a href="transformaciones.html#ejemplo-con-datos"><i class="fa fa-check"></i><b>19.2.7</b> Ejemplo con datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="colinealidad.html"><a href="colinealidad.html"><i class="fa fa-check"></i><b>20</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="20.1" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-exacta"><i class="fa fa-check"></i><b>20.1</b> Colinealidad exacta</a></li>
<li class="chapter" data-level="20.2" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-1"><i class="fa fa-check"></i><b>20.2</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="colinealidad.html"><a href="colinealidad.html#factor-de-inflación-de-la-varianza."><i class="fa fa-check"></i><b>20.2.1</b> Factor de inflación de la varianza.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="colinealidad.html"><a href="colinealidad.html#simulación-2"><i class="fa fa-check"></i><b>20.3</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html"><i class="fa fa-check"></i><b>21</b> Selección de variables y construcción de modelos</a>
<ul>
<li class="chapter" data-level="21.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-calidad"><i class="fa fa-check"></i><b>21.1</b> Criterio de calidad</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-de-akaike"><i class="fa fa-check"></i><b>21.1.1</b> Criterio de información de Akaike</a></li>
<li class="chapter" data-level="21.1.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-bayesiano"><i class="fa fa-check"></i><b>21.1.2</b> Criterio de información Bayesiano</a></li>
<li class="chapter" data-level="21.1.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#r-cuadrado-ajustado"><i class="fa fa-check"></i><b>21.1.3</b> R cuadrado ajustado</a></li>
<li class="chapter" data-level="21.1.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#rmse-con-validación-cruzada"><i class="fa fa-check"></i><b>21.1.4</b> RMSE con validación cruzada</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#procedimientos-de-selección"><i class="fa fa-check"></i><b>21.2</b> Procedimientos de selección</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-atrás-backward"><i class="fa fa-check"></i><b>21.2.1</b> Búsqueda hacia atrás (Backward)</a></li>
<li class="chapter" data-level="21.2.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-adelante-forward"><i class="fa fa-check"></i><b>21.2.2</b> Búsqueda hacia adelante (Forward)</a></li>
<li class="chapter" data-level="21.2.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-por-pasos-stepwise"><i class="fa fa-check"></i><b>21.2.3</b> Búsqueda por pasos (Stepwise)</a></li>
<li class="chapter" data-level="21.2.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-exhaustiva"><i class="fa fa-check"></i><b>21.2.4</b> Búsqueda exhaustiva</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#términos-de-orden-superior"><i class="fa fa-check"></i><b>21.3</b> Términos de orden superior</a></li>
<li class="chapter" data-level="21.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-versus-predicción-1"><i class="fa fa-check"></i><b>21.4</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-1"><i class="fa fa-check"></i><b>21.4.1</b> Explicación</a></li>
<li class="chapter" data-level="21.4.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#predicción-1"><i class="fa fa-check"></i><b>21.4.2</b> Predicción</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="regresión-logística.html"><a href="regresión-logística.html"><i class="fa fa-check"></i><b>22</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="22.1" data-path="regresión-logística.html"><a href="regresión-logística.html#modelos-lineales-generalizados"><i class="fa fa-check"></i><b>22.1</b> Modelos lineales generalizados</a></li>
<li class="chapter" data-level="22.2" data-path="regresión-logística.html"><a href="regresión-logística.html#respuesta-binaria"><i class="fa fa-check"></i><b>22.2</b> Respuesta binaria</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ajuste-de-la-regresión-logística"><i class="fa fa-check"></i><b>22.2.1</b> Ajuste de la regresión logística</a></li>
<li class="chapter" data-level="22.2.2" data-path="regresión-logística.html"><a href="regresión-logística.html#problemas-de-ajuste"><i class="fa fa-check"></i><b>22.2.2</b> Problemas de ajuste</a></li>
<li class="chapter" data-level="22.2.3" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplos-de-simulación"><i class="fa fa-check"></i><b>22.2.3</b> Ejemplos de simulación</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="regresión-logística.html"><a href="regresión-logística.html#trabajar-con-regresión-logística"><i class="fa fa-check"></i><b>22.3</b> Trabajar con regresión logística</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="regresión-logística.html"><a href="regresión-logística.html#pruebas-con-glms"><i class="fa fa-check"></i><b>22.3.1</b> Pruebas con GLMs</a></li>
<li class="chapter" data-level="22.3.2" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-wald"><i class="fa fa-check"></i><b>22.3.2</b> Prueba de Wald</a></li>
<li class="chapter" data-level="22.3.3" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>22.3.3</b> Prueba de razón de verosimilitud</a></li>
<li class="chapter" data-level="22.3.4" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-saheart"><i class="fa fa-check"></i><b>22.3.4</b> Ejemplo <code>SAheart</code></a></li>
<li class="chapter" data-level="22.3.5" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-1"><i class="fa fa-check"></i><b>22.3.5</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="22.3.6" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>22.3.6</b> Intervalos de confianza para la respuesta promedio</a></li>
<li class="chapter" data-level="22.3.7" data-path="regresión-logística.html"><a href="regresión-logística.html#sintaxis-de-la-fórmula"><i class="fa fa-check"></i><b>22.3.7</b> Sintaxis de la fórmula</a></li>
<li class="chapter" data-level="22.3.8" data-path="regresión-logística.html"><a href="regresión-logística.html#desviación"><i class="fa fa-check"></i><b>22.3.8</b> Desviación</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="regresión-logística.html"><a href="regresión-logística.html#clasificación"><i class="fa fa-check"></i><b>22.4</b> Clasificación</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-spam"><i class="fa fa-check"></i><b>22.4.1</b> Ejemplo <code>spam</code></a></li>
<li class="chapter" data-level="22.4.2" data-path="regresión-logística.html"><a href="regresión-logística.html#evaluar-clasificadores"><i class="fa fa-check"></i><b>22.4.2</b> Evaluar clasificadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="más-allá.html"><a href="más-allá.html"><i class="fa fa-check"></i><b>23</b> Más allá</a>
<ul>
<li class="chapter" data-level="23.1" data-path="más-allá.html"><a href="más-allá.html#rstudio"><i class="fa fa-check"></i><b>23.1</b> RStudio</a></li>
<li class="chapter" data-level="23.2" data-path="más-allá.html"><a href="más-allá.html#tidy-data"><i class="fa fa-check"></i><b>23.2</b> Tidy Data</a></li>
<li class="chapter" data-level="23.3" data-path="más-allá.html"><a href="más-allá.html#visualización"><i class="fa fa-check"></i><b>23.3</b> Visualización</a></li>
<li class="chapter" data-level="23.4" data-path="más-allá.html"><a href="más-allá.html#aplicaciones-web"><i class="fa fa-check"></i><b>23.4</b> Aplicaciones web</a></li>
<li class="chapter" data-level="23.5" data-path="más-allá.html"><a href="más-allá.html#diseño-experimental"><i class="fa fa-check"></i><b>23.5</b> Diseño experimental</a></li>
<li class="chapter" data-level="23.6" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-automático-machine-learning"><i class="fa fa-check"></i><b>23.6</b> Aprendizaje automático (Machine Learning)</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-profundo-deep-learning"><i class="fa fa-check"></i><b>23.6.1</b> Aprendizaje profundo (Deep Learning)</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="más-allá.html"><a href="más-allá.html#series-de-tiempo"><i class="fa fa-check"></i><b>23.7</b> Series de tiempo</a></li>
<li class="chapter" data-level="23.8" data-path="más-allá.html"><a href="más-allá.html#bayesiana"><i class="fa fa-check"></i><b>23.8</b> Bayesiana</a></li>
<li class="chapter" data-level="23.9" data-path="más-allá.html"><a href="más-allá.html#computación-de-alto-rendimiento."><i class="fa fa-check"></i><b>23.9</b> Computación de alto rendimiento.</a></li>
<li class="chapter" data-level="23.10" data-path="más-allá.html"><a href="más-allá.html#recursos-adicionales-de-r"><i class="fa fa-check"></i><b>23.10</b> Recursos adicionales de <code>R</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/appliedstats" target="blank">&copy; 2020 Adapatado de David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística aplicada con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="colinealidad" class="section level1" number="20">
<h1><span class="header-section-number">Capítulo 20</span> Colinealidad</h1>
<blockquote>
<p>“Si me veo confundido es porque estoy pensando.”</p>
<p>— <strong>Samuel Goldwyn</strong></p>
</blockquote>
<p>Después de leer este capítulo, podrá:</p>
<ul>
<li>Identificar colinealidad en regresión.</li>
<li>Comprender el efecto de la colinealidad en modelos de regresión.</li>
</ul>
<div id="colinealidad-exacta" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Colinealidad exacta</h2>
<p>Creamos un conjunto de datos donde uno de los predictores, <span class="math inline">\(x_3\)</span>, sea una combinación lineal de los otros predictores.</p>
<div class="sourceCode" id="cb1199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1199-1"><a href="colinealidad.html#cb1199-1" aria-hidden="true" tabindex="-1"></a>gen_exact_collin_data <span class="ot">=</span> <span class="cf">function</span>(<span class="at">num_samples =</span> <span class="dv">100</span>) {</span>
<span id="cb1199-2"><a href="colinealidad.html#cb1199-2" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> num_samples, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1199-3"><a href="colinealidad.html#cb1199-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> num_samples, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb1199-4"><a href="colinealidad.html#cb1199-4" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="dv">3</span></span>
<span id="cb1199-5"><a href="colinealidad.html#cb1199-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="dv">3</span> <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> num_samples, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb1199-6"><a href="colinealidad.html#cb1199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(y, x1, x2, x3)</span>
<span id="cb1199-7"><a href="colinealidad.html#cb1199-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Observe que la forma en que estamos generando estos datos, la respuesta <span class="math inline">\(y\)</span> solo depende realmente de <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>.</p>
<div class="sourceCode" id="cb1200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1200-1"><a href="colinealidad.html#cb1200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1200-2"><a href="colinealidad.html#cb1200-2" aria-hidden="true" tabindex="-1"></a>exact_collin_data <span class="ot">=</span> <span class="fu">gen_exact_collin_data</span>()</span>
<span id="cb1200-3"><a href="colinealidad.html#cb1200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(exact_collin_data)</span></code></pre></div>
<pre><code>##          y       x1       x2       x3
## 1 170.7135 93.70958 76.00483 494.4385
## 2 152.9106 74.35302 75.22376 452.6011
## 3 152.7866 83.63128 64.98396 430.1984
## 4 170.6306 86.32863 79.24241 492.6269
## 5 152.3320 84.04268 66.66613 437.7499
## 6 151.3155 78.93875 70.52757 442.9878</code></pre>
<p>¿Qué sucede cuando intentamos ajustar un modelo de regresión en <code>R</code> usando todos los predictores?</p>
<div class="sourceCode" id="cb1202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1202-1"><a href="colinealidad.html#cb1202-1" aria-hidden="true" tabindex="-1"></a>exact_collin_fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> exact_collin_data)</span>
<span id="cb1202-2"><a href="colinealidad.html#cb1202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exact_collin_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2 + x3, data = exact_collin_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.57662 -0.66188 -0.08253  0.63706  2.52057 
## 
## Coefficients: (1 not defined because of singularities)
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.957336   1.735165   1.704   0.0915 .  
## x1          0.985629   0.009788 100.702   &lt;2e-16 ***
## x2          1.017059   0.022545  45.112   &lt;2e-16 ***
## x3                NA         NA      NA       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.014 on 97 degrees of freedom
## Multiple R-squared:  0.9923, Adjusted R-squared:  0.9921 
## F-statistic:  6236 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Vemos que <code>R</code> simplemente decide excluir una variable. ¿Por qué está pasando esto?</p>
<div class="sourceCode" id="cb1204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1204-1"><a href="colinealidad.html#cb1204-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">as.matrix</span>(exact_collin_data[,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb1204-2"><a href="colinealidad.html#cb1204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)</span></code></pre></div>
<p>Si intentamos encontrar <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span> usando <span class="math inline">\(\left( \boldsymbol{X}^T \boldsymbol{X} \right)^{-1}\)</span>, vemos que no es posible, debido al hecho de que las columnas de <span class="math inline">\(\boldsymbol{X}\)</span> son linealmente dependientes. Las líneas de código anteriores no se ejecutaron, ¡porque producen un error!</p>
<p>Cuando esto sucede, decimos que hay <strong>colinealidad exacta</strong> en el conjunto de datos.</p>
<p>Como resultado de este problema, <code>R</code> esencialmente eligió ajustarse al modelo <code>y ~ x1 + x2</code>. Sin embargo, observe que otros dos modelos lograrán exactamente el mismo ajuste.</p>
<div class="sourceCode" id="cb1205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1205-1"><a href="colinealidad.html#cb1205-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> exact_collin_data)</span>
<span id="cb1205-2"><a href="colinealidad.html#cb1205-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x3, <span class="at">data =</span> exact_collin_data)</span>
<span id="cb1205-3"><a href="colinealidad.html#cb1205-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> exact_collin_data)</span></code></pre></div>
<p>Vemos que los valores ajustados para cada uno de los tres modelos son exactamente los mismos. Este es el resultado de <span class="math inline">\(x_3\)</span> que contiene toda la información de <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>. Siempre que se incluya uno de <span class="math inline">\(x_1\)</span> o <span class="math inline">\(x_2\)</span> en el modelo, se puede usar <span class="math inline">\(x_3\)</span> para recuperar la información de la variable no incluida.</p>
<div class="sourceCode" id="cb1206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1206-1"><a href="colinealidad.html#cb1206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">fitted</span>(fit1), <span class="fu">fitted</span>(fit2))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1208-1"><a href="colinealidad.html#cb1208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">fitted</span>(fit2), <span class="fu">fitted</span>(fit3))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Si bien sus valores ajustados son todos iguales, sus coeficientes estimados son muy diferentes. ¡El signo de <span class="math inline">\(x_2\)</span> se cambia en dos de los modelos! Así que solo <code>fit1</code> explica <em>correctamente</em> la relación entre las variables,<code>fit2</code> y <code>fit3</code> aún <em>predicen</em> así como<code>fit1</code>, a pesar de que los coeficientes tienen poco o ningún significado, un concepto al que volveremos más adelante.</p>
<div class="sourceCode" id="cb1210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1210-1"><a href="colinealidad.html#cb1210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit1)</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2 
##   2.9573357   0.9856291   1.0170586</code></pre>
<div class="sourceCode" id="cb1212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1212-1"><a href="colinealidad.html#cb1212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit2)</span></code></pre></div>
<pre><code>## (Intercept)          x1          x3 
##   2.1945418   0.4770998   0.2542647</code></pre>
<div class="sourceCode" id="cb1214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1214-1"><a href="colinealidad.html#cb1214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit3)</span></code></pre></div>
<pre><code>## (Intercept)          x2          x3 
##   1.4788921  -0.9541995   0.4928145</code></pre>
</div>
<div id="colinealidad-1" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Colinealidad</h2>
<p>La colinealidad exacta es un ejemplo extremo de <strong>colinealidad</strong>, que ocurre en regresiones múltiples cuando las variables predictoras están altamente correlacionadas. La colinealidad a menudo se denomina <em>multicolinealidad</em>, ya que es un fenómeno que realmente solo ocurre durante la regresión múltiple.</p>
<p>En el conjunto de datos <code>seatpos</code> del paquete <code>faraway</code>, veremos un ejemplo de este concepto. Los predictores en este conjunto de datos son varios atributos de los conductores de automóviles, como su altura, peso y edad. La variable respuesta <code>hipcenter</code> mide la “distancia horizontal del punto medio de las caderas desde una ubicación fija en el automóvil en mm”. Básicamente, mide la posición del asiento de un conductor determinado. Esta es información potencialmente útil para los fabricantes de automóviles que consideran la comodidad y la seguridad al diseñar vehículos.</p>
<p>Intentaremos ajustar un modelo que prediga <code>hipcenter</code>. Dos variables predictoras son interesantes para nosotros: <code>HtShoes</code> y <code>Ht</code>. Ciertamente, esperamos que la altura de una persona esté altamente correlacionada con su altura cuando usa zapatos. Prestaremos especial atención a estas dos variables al ajustar modelos.</p>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1216-1"><a href="colinealidad.html#cb1216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb1216-2"><a href="colinealidad.html#cb1216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(seatpos, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-570-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1217-1"><a href="colinealidad.html#cb1217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(seatpos), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##             Age Weight HtShoes    Ht Seated   Arm Thigh   Leg hipcenter
## Age        1.00   0.08   -0.08 -0.09  -0.17  0.36  0.09 -0.04      0.21
## Weight     0.08   1.00    0.83  0.83   0.78  0.70  0.57  0.78     -0.64
## HtShoes   -0.08   0.83    1.00  1.00   0.93  0.75  0.72  0.91     -0.80
## Ht        -0.09   0.83    1.00  1.00   0.93  0.75  0.73  0.91     -0.80
## Seated    -0.17   0.78    0.93  0.93   1.00  0.63  0.61  0.81     -0.73
## Arm        0.36   0.70    0.75  0.75   0.63  1.00  0.67  0.75     -0.59
## Thigh      0.09   0.57    0.72  0.73   0.61  0.67  1.00  0.65     -0.59
## Leg       -0.04   0.78    0.91  0.91   0.81  0.75  0.65  1.00     -0.79
## hipcenter  0.21  -0.64   -0.80 -0.80  -0.73 -0.59 -0.59 -0.79      1.00</code></pre>
<p>Después de cargar el paquete <code>faraway</code>, realizamos algunas comprobaciones rápidas de correlación entre los predictores. Visualmente, podemos hacer esto con la función <code>pairs()</code>, que traza todos los diagramas de dispersión posibles entre pares de variables en el conjunto de datos.</p>
<p>También podemos hacer esto numéricamente con la función <code>cor()</code>, que cuando se aplica a un conjunto de datos, devuelve todas las correlaciones por pares. Observe que esta es una matriz simétrica. Recuerde que la correlación mide la fuerza y la dirección de la relación lineal entre las variables. La correlación entre <code>Ht</code> y <code>HtShoes</code> es extremadamente alta. Tan alta, que redondeado a dos cifras decimales, ¡parece ser 1!</p>
<p>A diferencia de la colinealidad exacta, aquí todavía podemos ajustar un modelo con todos los predictores, pero ¿qué efecto tiene esto?</p>
<div class="sourceCode" id="cb1219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1219-1"><a href="colinealidad.html#cb1219-1" aria-hidden="true" tabindex="-1"></a>hip_model <span class="ot">=</span> <span class="fu">lm</span>(hipcenter <span class="sc">~</span> ., <span class="at">data =</span> seatpos)</span>
<span id="cb1219-2"><a href="colinealidad.html#cb1219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hip_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = hipcenter ~ ., data = seatpos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -73.827 -22.833  -3.678  25.017  62.337 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 436.43213  166.57162   2.620   0.0138 *
## Age           0.77572    0.57033   1.360   0.1843  
## Weight        0.02631    0.33097   0.080   0.9372  
## HtShoes      -2.69241    9.75304  -0.276   0.7845  
## Ht            0.60134   10.12987   0.059   0.9531  
## Seated        0.53375    3.76189   0.142   0.8882  
## Arm          -1.32807    3.90020  -0.341   0.7359  
## Thigh        -1.14312    2.66002  -0.430   0.6706  
## Leg          -6.43905    4.71386  -1.366   0.1824  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 37.72 on 29 degrees of freedom
## Multiple R-squared:  0.6866, Adjusted R-squared:  0.6001 
## F-statistic:  7.94 on 8 and 29 DF,  p-value: 1.306e-05</code></pre>
<p>Una de las primeras cosas que debemos notar es que la prueba <span class="math inline">\(F\)</span> para la regresión nos dice que la regresión es significativa, sin embargo, cada predictor individual no lo es. Otro resultado interesante son los signos opuestos de los coeficientes para <code>Ht</code> y <code>HtShoes</code>. Esto debería parecer bastante contrario a la intuición. ¿Aumentar <code>Ht</code> aumenta <code>hipcenter</code>, pero aumentar <code>HtShoes</code> disminuye<code>hipcenter</code>?</p>
<p>Esto sucede como resultado de que los predictores están altamente correlacionados. Por ejemplo, la variable <code>HtShoes</code> explica gran parte de la variación en <code>Ht</code>. Cuando ambos están en el modelo, sus efectos sobre la respuesta disminuyen individualmente, pero juntos todavía explican una gran parte de la variación de <code>hipcenter</code>.</p>
<p>Definimos <span class="math inline">\(R_j^2\)</span> como la proporción de variación observada en el predictor <span class="math inline">\(j\)</span>-ésimo explicada por los otros predictores. En otras palabras, <span class="math inline">\(R_j^2\)</span> es el R-Cuadrado múltiple para la regresión de <span class="math inline">\(x_j\)</span> en cada uno de los otros predictores.</p>
<div class="sourceCode" id="cb1221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1221-1"><a href="colinealidad.html#cb1221-1" aria-hidden="true" tabindex="-1"></a>ht_shoes_model <span class="ot">=</span> <span class="fu">lm</span>(HtShoes <span class="sc">~</span> . <span class="sc">-</span> hipcenter, <span class="at">data =</span> seatpos)</span>
<span id="cb1221-2"><a href="colinealidad.html#cb1221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ht_shoes_model)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.9967472</code></pre>
<p>Aquí vemos que los otros predictores explican $99,67% $ de la variación en <code>HtShoe</code>. Al ajustar este modelo, eliminamos <code>hipcenter</code> ya que no es un predictor.</p>
<div id="factor-de-inflación-de-la-varianza." class="section level3" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> Factor de inflación de la varianza.</h3>
<p>Ahora tenga en cuenta que la varianza de <span class="math inline">\(\hat{\beta_j}\)</span> se puede escribir como</p>
<p><span class="math display">\[
\text{Var}(\hat{\beta_j}) = \sigma^2 C_{jj} = \sigma^2 \left( \frac{1}{1 - R_j^2}  \right) \frac{1}{S_{x_j x_j}}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
S_{x_j x_j} = \sum(x_{ij}-\bar{x}_j)^2.
\]</span></p>
<p>Esto nos da una forma de comprender cómo afecta la colinealidad a nuestras estimaciones de regresión.</p>
<p>llamaremos,</p>
<p><span class="math display">\[
\frac{1}{1 - R_j^2}
\]</span></p>
<p>el <strong>factor de inflación de la varianza.</strong> El factor de inflación de la varianza cuantifica el efecto de la colinealidad sobre la varianza de nuestras estimaciones de regresión. Cuando <span class="math inline">\(R_j^2\)</span> es grande, es cercano a 1, <span class="math inline">\(x_j\)</span> está bien explicado por los otros predictores. Con un <span class="math inline">\(R_j^2\)</span> grande, el factor de inflación de la varianza se vuelve grande. Esto nos dice que cuando <span class="math inline">\(x_j\)</span> está altamente correlacionado con otros predictores, nuestra estimación de <span class="math inline">\(\beta_j\)</span> es muy variable.</p>
<p>La función <code>vif</code> del paquete <code>faraway</code> calcula los VIF para cada uno de los predictores de un modelo.</p>
<div class="sourceCode" id="cb1223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1223-1"><a href="colinealidad.html#cb1223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(hip_model)</span></code></pre></div>
<pre><code>##        Age     Weight    HtShoes         Ht     Seated        Arm      Thigh 
##   1.997931   3.647030 307.429378 333.137832   8.951054   4.496368   2.762886 
##        Leg 
##   6.694291</code></pre>
<p>En la práctica, es común decir que cualquier VIF superior a <span class="math inline">\(5\)</span> es motivo de preocupación. Entonces, en este ejemplo, vemos que hay un gran problema de multicolinealidad, ya que muchos de los predictores tienen un VIF mayor a 5.</p>
<p>Investiguemos más a fondo cómo la presencia de colinealidad afecta realmente a un modelo. Si agregamos una cantidad moderada de ruido a los datos, vemos que las estimaciones de los coeficientes cambian drásticamente. Este es un efecto bastante indeseable. Agregar ruido aleatorio no debería afectar los coeficientes de un modelo.</p>
<div class="sourceCode" id="cb1225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1225-1"><a href="colinealidad.html#cb1225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb1225-2"><a href="colinealidad.html#cb1225-2" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(seatpos), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb1225-3"><a href="colinealidad.html#cb1225-3" aria-hidden="true" tabindex="-1"></a>hip_model_noise <span class="ot">=</span> <span class="fu">lm</span>(hipcenter <span class="sc">+</span> noise <span class="sc">~</span> ., <span class="at">data =</span> seatpos)</span></code></pre></div>
<p>La adición del ruido tuvo un efecto tan grande que el signo del coeficiente de <code>Ht</code> ha cambiado.</p>
<div class="sourceCode" id="cb1226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1226-1"><a href="colinealidad.html#cb1226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(hip_model)</span></code></pre></div>
<pre><code>##  (Intercept)          Age       Weight      HtShoes           Ht       Seated 
## 436.43212823   0.77571620   0.02631308  -2.69240774   0.60134458   0.53375170 
##          Arm        Thigh          Leg 
##  -1.32806864  -1.14311888  -6.43904627</code></pre>
<div class="sourceCode" id="cb1228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1228-1"><a href="colinealidad.html#cb1228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(hip_model_noise)</span></code></pre></div>
<pre><code>##  (Intercept)          Age       Weight      HtShoes           Ht       Seated 
## 415.32909380   0.76578240   0.01910958  -2.90377584  -0.12068122   2.03241638 
##          Arm        Thigh          Leg 
##  -1.02127944  -0.89034509  -5.61777220</code></pre>
<p>Esto nos dice que un modelo con colinealidad es malo para explicar la relación entre la respuesta y los predictores. Ni siquiera podemos tener confianza en la dirección de la relación. Sin embargo, ¿la colinealidad afecta la predicción?</p>
<div class="sourceCode" id="cb1230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1230-1"><a href="colinealidad.html#cb1230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(hip_model), <span class="fu">fitted</span>(hip_model_noise), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1230-2"><a href="colinealidad.html#cb1230-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Predicho, sin ruido&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Predicho, con ruido&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1230-3"><a href="colinealidad.html#cb1230-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-576-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Vemos que al graficar los valores predichos usando ambos modelos uno contra el otro, en realidad son bastante similares.</p>
<p>Veamos ahora un modelo más pequeño,</p>
<div class="sourceCode" id="cb1231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1231-1"><a href="colinealidad.html#cb1231-1" aria-hidden="true" tabindex="-1"></a>hip_model_small <span class="ot">=</span> <span class="fu">lm</span>(hipcenter <span class="sc">~</span> Age <span class="sc">+</span> Arm <span class="sc">+</span> Ht, <span class="at">data =</span> seatpos)</span>
<span id="cb1231-2"><a href="colinealidad.html#cb1231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hip_model_small)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = hipcenter ~ Age + Arm + Ht, data = seatpos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -82.347 -24.745  -0.094  23.555  58.314 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 493.2491   101.0724   4.880 2.46e-05 ***
## Age           0.7988     0.5111   1.563  0.12735    
## Arm          -2.9385     3.5210  -0.835  0.40979    
## Ht           -3.4991     0.9954  -3.515  0.00127 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 36.12 on 34 degrees of freedom
## Multiple R-squared:  0.6631, Adjusted R-squared:  0.6333 
## F-statistic:  22.3 on 3 and 34 DF,  p-value: 3.649e-08</code></pre>
<div class="sourceCode" id="cb1233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1233-1"><a href="colinealidad.html#cb1233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(hip_model_small)</span></code></pre></div>
<pre><code>##      Age      Arm       Ht 
## 1.749943 3.996766 3.508693</code></pre>
<p>Inmediatamente vemos que aquí la multicolinealidad no es un problema.</p>
<div class="sourceCode" id="cb1235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1235-1"><a href="colinealidad.html#cb1235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(hip_model_small, hip_model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: hipcenter ~ Age + Arm + Ht
## Model 2: hipcenter ~ Age + Weight + HtShoes + Ht + Seated + Arm + Thigh + 
##     Leg
##   Res.Df   RSS Df Sum of Sq      F Pr(&gt;F)
## 1     34 44354                           
## 2     29 41262  5    3091.9 0.4346 0.8207</code></pre>
<p>También observe que usando una prueba <span class="math inline">\(F\)</span> para comparar los dos modelos, preferiríamos el modelo más pequeño.</p>
<p>Ahora investigamos el efecto de agregar otra variable a este modelo más pequeño. Específicamente, queremos ver la adición de la variable <code>HtShoes</code>. Así que ahora nuestros posibles predictores son <code>HtShoes</code>, <code>Age</code>, <code>Arm</code> y <code>Ht</code>. Nuestra respuesta sigue siendo <code>hipcenter</code>.</p>
<p>Para cuantificar este efecto, veremos un <strong>gráfico de variable agregada</strong> y un <strong>coeficiente de correlación parcial</strong>. Para ambos, veremos los residuos de los modelos:</p>
<ul>
<li>Hacer una regresión de la respuesta (<code>hipcenter</code>) frente a todos los predictores excepto el predictor de interés (<code>HtShoes</code>).</li>
<li>la regresión el predictor de interés (<code>HtShoes</code>) frente a los otros predictores (<code>Age</code>, <code>Arm</code> y <code>Ht</code>).</li>
</ul>
<div class="sourceCode" id="cb1237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1237-1"><a href="colinealidad.html#cb1237-1" aria-hidden="true" tabindex="-1"></a>ht_shoes_model_small <span class="ot">=</span> <span class="fu">lm</span>(HtShoes <span class="sc">~</span> Age <span class="sc">+</span> Arm <span class="sc">+</span> Ht, <span class="at">data =</span> seatpos)</span></code></pre></div>
<p>Así que ahora, los residuos de <code>hip_model_small</code> nos dan la variación de <code>hipcenter</code> que es <em>inexplicable</em> por <code>Age</code>, <code>Arm</code> y <code>Ht</code>. De manera similar, los residuos de <code>ht_shoes_model_small</code> nos dan la variación de <code>HtShoes</code> sin explicación por <code>Age</code>, <code>Arm</code> y <code>Ht</code>.</p>
<p>La correlación de estos dos residuos nos da el <strong>coeficiente de correlación parcial</strong> de <code>HtShoes</code> y <code>hipcenter</code> con los efectos de <code>Age</code>, <code>Arm</code> y <code>Ht</code> eliminados.</p>
<div class="sourceCode" id="cb1238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1238-1"><a href="colinealidad.html#cb1238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">resid</span>(ht_shoes_model_small), <span class="fu">resid</span>(hip_model_small))</span></code></pre></div>
<pre><code>## [1] -0.03311061</code></pre>
<p>Dado que este valor es pequeño, cercano a cero, significa que la variación de <code>hipcenter</code> que no se explica por<code>Age</code>, <code>Arm</code> y<code>Ht</code> muestra muy poca correlación con la variación de <code>HtShoes</code> que no se explica por <code>Age</code>, <code>Arm</code>, y <code>Ht</code>. Por lo tanto, agregar <code>HtShoes</code> al modelo probablemente sería de poco beneficio.</p>
<p>De manera similar, una <strong>gráfica de variable agregada</strong> visualiza estos residuos entre sí. También es útil hacer una regresión de los residuos de la respuesta frente a los residuos del predictor y agregar la línea de regresión al gráfico.</p>
<div class="sourceCode" id="cb1240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1240-1"><a href="colinealidad.html#cb1240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(hip_model_small) <span class="sc">~</span> <span class="fu">resid</span>(ht_shoes_model_small), </span>
<span id="cb1240-2"><a href="colinealidad.html#cb1240-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1240-3"><a href="colinealidad.html#cb1240-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Residuales, Predictor agregado&quot;</span>, </span>
<span id="cb1240-4"><a href="colinealidad.html#cb1240-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Residuales, Modelo original&quot;</span>)</span>
<span id="cb1240-5"><a href="colinealidad.html#cb1240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1240-6"><a href="colinealidad.html#cb1240-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1240-7"><a href="colinealidad.html#cb1240-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">resid</span>(hip_model_small) <span class="sc">~</span> <span class="fu">resid</span>(ht_shoes_model_small)),</span>
<span id="cb1240-8"><a href="colinealidad.html#cb1240-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-581-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Aquí la gráfica agregada de variables no muestra casi ninguna relación lineal. Esto nos dice que agregar <code>HtShoes</code> al modelo probablemente no valdría la pena. Dado que su variación se explica en gran medida por los otros predictores, agregarlo al modelo no hará mucho por mejorarlo. Sin embargo, aumentará la variación de las estimaciones y hará que el modelo sea mucho más difícil de interpretar.</p>
<p>Si hubiera habido una relación lineal fuerte, por lo tanto, un coeficiente de correlación parcial grande, probablemente hubiera sido útil agregar el predictor adicional al modelo.</p>
<p>Esta compensación es mayoritariamente cierta en general. A medida que un modelo obtiene más predictores, los errores se harán más pequeños y su <em>predicción</em> será mejor, pero será más difícil de interpretar. Por eso, si estamos interesados en <em>explicar</em> la relación entre los predictores y la respuesta, a menudo queremos un modelo que se ajuste bien, pero con una pequeña cantidad de predictores con poca correlación.</p>
<p>En el próximo capítulo, aprenderemos sobre métodos para encontrar modelos que se ajusten bien, pero que también tengan una pequeña cantidad de predictores. También discutiremos <em>sobreajuste</em>. Aunque agregar predictores adicionales siempre hará que los errores sean más pequeños, a veces “ajustaremos el ruido” y dicho modelo no se generalizará bien a observaciones adicionales.</p>
</div>
</div>
<div id="simulación-2" class="section level2" number="20.3">
<h2><span class="header-section-number">20.3</span> Simulación</h2>
<p>Aquí simulamos datos de ejemplo con y sin colinealidad. Notaremos la diferencia en la distribución de las estimaciones de los parámetros <span class="math inline">\(\beta\)</span>, en particular su varianza. Sin embargo, también notaremos la similitud en sus <span class="math inline">\(MSE\)</span>.</p>
<p>Usaremos el modelo,</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \epsilon
\]</span></p>
<p>donde <span class="math inline">\(\epsilon \sim N(\mu = 0, \sigma^2 = 25)\)</span> y los coeficientes <span class="math inline">\(\beta\)</span> se definen a continuación.</p>
<div class="sourceCode" id="cb1241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1241-1"><a href="colinealidad.html#cb1241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1241-2"><a href="colinealidad.html#cb1241-2" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb1241-3"><a href="colinealidad.html#cb1241-3" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb1241-4"><a href="colinealidad.html#cb1241-4" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb1241-5"><a href="colinealidad.html#cb1241-5" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">=</span> <span class="dv">5</span></span></code></pre></div>
<p>Usaremos un tamaño de muestra de 10 y 2500 simulaciones para ambas situaciones.</p>
<div class="sourceCode" id="cb1242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1242-1"><a href="colinealidad.html#cb1242-1" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1242-2"><a href="colinealidad.html#cb1242-2" aria-hidden="true" tabindex="-1"></a>num_sim     <span class="ot">=</span> <span class="dv">2500</span></span></code></pre></div>
<p>Primero consideraremos la situación con un problema de colinealidad, por lo que creamos manualmente las dos variables predictoras.</p>
<div class="sourceCode" id="cb1243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1243-1"><a href="colinealidad.html#cb1243-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb1243-2"><a href="colinealidad.html#cb1243-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">8</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1244-1"><a href="colinealidad.html#cb1244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(x1), <span class="fu">sd</span>(x2))</span></code></pre></div>
<pre><code>## [1] 3.02765 3.02765</code></pre>
<div class="sourceCode" id="cb1246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1246-1"><a href="colinealidad.html#cb1246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span></code></pre></div>
<pre><code>## [1] 0.9393939</code></pre>
<p>Observe que tienen una correlación extremadamente alta.</p>
<div class="sourceCode" id="cb1248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1248-1"><a href="colinealidad.html#cb1248-1" aria-hidden="true" tabindex="-1"></a>true_line_bad <span class="ot">=</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> x1 <span class="sc">+</span> beta_2 <span class="sc">*</span> x2</span>
<span id="cb1248-2"><a href="colinealidad.html#cb1248-2" aria-hidden="true" tabindex="-1"></a>beta_hat_bad  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, num_sim, <span class="dv">2</span>)</span>
<span id="cb1248-3"><a href="colinealidad.html#cb1248-3" aria-hidden="true" tabindex="-1"></a>mse_bad       <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sim)</span></code></pre></div>
<p>Realizamos la simulación 2500 veces, cada vez ajustando un modelo de regresión, y almacenando los coeficientes estimados y el MSE.</p>
<div class="sourceCode" id="cb1249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1249-1"><a href="colinealidad.html#cb1249-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_sim) {</span>
<span id="cb1249-2"><a href="colinealidad.html#cb1249-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> true_line_bad <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb1249-3"><a href="colinealidad.html#cb1249-3" aria-hidden="true" tabindex="-1"></a>  reg_out <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb1249-4"><a href="colinealidad.html#cb1249-4" aria-hidden="true" tabindex="-1"></a>  beta_hat_bad[s, ] <span class="ot">=</span> <span class="fu">coef</span>(reg_out)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb1249-5"><a href="colinealidad.html#cb1249-5" aria-hidden="true" tabindex="-1"></a>  mse_bad[s] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">resid</span>(reg_out) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb1249-6"><a href="colinealidad.html#cb1249-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Ahora pasamos a la situación sin problema de colinealidad, por lo que nuevamente creamos manualmente las dos variables predictoras.</p>
<div class="sourceCode" id="cb1250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1250-1"><a href="colinealidad.html#cb1250-1" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb1250-2"><a href="colinealidad.html#cb1250-2" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span></code></pre></div>
<p>Observe que las desviaciones estándar de cada uno son las mismas que antes, sin embargo, ahora la correlación es extremadamente cercana a 0.</p>
<div class="sourceCode" id="cb1251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1251-1"><a href="colinealidad.html#cb1251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(z1), <span class="fu">sd</span>(z2))</span></code></pre></div>
<pre><code>## [1] 3.02765 3.02765</code></pre>
<div class="sourceCode" id="cb1253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1253-1"><a href="colinealidad.html#cb1253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(z1, z2)</span></code></pre></div>
<pre><code>## [1] 0.03030303</code></pre>
<div class="sourceCode" id="cb1255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1255-1"><a href="colinealidad.html#cb1255-1" aria-hidden="true" tabindex="-1"></a>true_line_good <span class="ot">=</span> beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> z1 <span class="sc">+</span> beta_2 <span class="sc">*</span> z2</span>
<span id="cb1255-2"><a href="colinealidad.html#cb1255-2" aria-hidden="true" tabindex="-1"></a>beta_hat_good  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, num_sim, <span class="dv">2</span>)</span>
<span id="cb1255-3"><a href="colinealidad.html#cb1255-3" aria-hidden="true" tabindex="-1"></a>mse_good       <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sim)</span></code></pre></div>
<p>Luego realizamos simulaciones y almacenamos los mismos resultados.</p>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1256-1"><a href="colinealidad.html#cb1256-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_sim) {</span>
<span id="cb1256-2"><a href="colinealidad.html#cb1256-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> true_line_good <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb1256-3"><a href="colinealidad.html#cb1256-3" aria-hidden="true" tabindex="-1"></a>  reg_out <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> z1 <span class="sc">+</span> z2)</span>
<span id="cb1256-4"><a href="colinealidad.html#cb1256-4" aria-hidden="true" tabindex="-1"></a>  beta_hat_good[s, ] <span class="ot">=</span> <span class="fu">coef</span>(reg_out)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb1256-5"><a href="colinealidad.html#cb1256-5" aria-hidden="true" tabindex="-1"></a>  mse_good[s] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">resid</span>(reg_out) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb1256-6"><a href="colinealidad.html#cb1256-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Ahora investigaremos las diferencias.</p>
<div class="sourceCode" id="cb1257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1257-1"><a href="colinealidad.html#cb1257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1257-2"><a href="colinealidad.html#cb1257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_hat_bad[, <span class="dv">1</span>],</span>
<span id="cb1257-3"><a href="colinealidad.html#cb1257-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1257-4"><a href="colinealidad.html#cb1257-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1257-5"><a href="colinealidad.html#cb1257-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Histograma de &quot;</span> <span class="sc">*</span><span class="fu">hat</span>(beta)[<span class="dv">1</span>]<span class="sc">*</span> <span class="st">&quot; con colinealidad&quot;</span>),</span>
<span id="cb1257-6"><a href="colinealidad.html#cb1257-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]),</span>
<span id="cb1257-7"><a href="colinealidad.html#cb1257-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb1257-8"><a href="colinealidad.html#cb1257-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_hat_good[, <span class="dv">1</span>],</span>
<span id="cb1257-9"><a href="colinealidad.html#cb1257-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1257-10"><a href="colinealidad.html#cb1257-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1257-11"><a href="colinealidad.html#cb1257-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Histograma de &quot;</span> <span class="sc">*</span><span class="fu">hat</span>(beta)[<span class="dv">1</span>]<span class="sc">*</span> <span class="st">&quot; sin colinealidad&quot;</span>),</span>
<span id="cb1257-12"><a href="colinealidad.html#cb1257-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]),</span>
<span id="cb1257-13"><a href="colinealidad.html#cb1257-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-592-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Primero, para <span class="math inline">\(\beta_1\)</span>, que tiene un valor real de <span class="math inline">\(3\)</span>, vemos que tanto con colinealidad como sin ella, los valores simulados están centrados cerca de <span class="math inline">\(3\)</span>.</p>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1258-1"><a href="colinealidad.html#cb1258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beta_hat_bad[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 2.963325</code></pre>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1260-1"><a href="colinealidad.html#cb1260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beta_hat_good[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 3.013414</code></pre>
<p>La forma en que se crearon los predictores, la <span class="math inline">\(S_{x_j x_j}\)</span> porción de la varianza es la misma para los predictores en ambos casos, pero la varianza es aún mucho mayor en las simulaciones realizadas con colinealidad. La varianza es tan grande en el caso colineal, que a veces el coeficiente estimado para <span class="math inline">\(\beta_1\)</span> es negativo.</p>
<div class="sourceCode" id="cb1262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1262-1"><a href="colinealidad.html#cb1262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(beta_hat_bad[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.633294</code></pre>
<div class="sourceCode" id="cb1264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1264-1"><a href="colinealidad.html#cb1264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(beta_hat_good[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.5484684</code></pre>
<div class="sourceCode" id="cb1266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1266-1"><a href="colinealidad.html#cb1266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1266-2"><a href="colinealidad.html#cb1266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_hat_bad[, <span class="dv">2</span>],</span>
<span id="cb1266-3"><a href="colinealidad.html#cb1266-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1266-4"><a href="colinealidad.html#cb1266-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1266-5"><a href="colinealidad.html#cb1266-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Histograma de &quot;</span> <span class="sc">*</span><span class="fu">hat</span>(beta)[<span class="dv">2</span>]<span class="sc">*</span> <span class="st">&quot; con colinealidad&quot;</span>),</span>
<span id="cb1266-6"><a href="colinealidad.html#cb1266-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">2</span>]),</span>
<span id="cb1266-7"><a href="colinealidad.html#cb1266-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span>
<span id="cb1266-8"><a href="colinealidad.html#cb1266-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_hat_good[, <span class="dv">2</span>],</span>
<span id="cb1266-9"><a href="colinealidad.html#cb1266-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1266-10"><a href="colinealidad.html#cb1266-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1266-11"><a href="colinealidad.html#cb1266-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;Histograma de &quot;</span> <span class="sc">*</span><span class="fu">hat</span>(beta)[<span class="dv">2</span>]<span class="sc">*</span> <span class="st">&quot; sin colinealidad&quot;</span>),</span>
<span id="cb1266-12"><a href="colinealidad.html#cb1266-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">2</span>]),</span>
<span id="cb1266-13"><a href="colinealidad.html#cb1266-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-595-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Vemos los mismos problemas con <span class="math inline">\(\beta_2\)</span>. En promedio, las estimaciones son correctas, pero la varianza es nuevamente mucho mayor con la colinealidad.</p>
<div class="sourceCode" id="cb1267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1267-1"><a href="colinealidad.html#cb1267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beta_hat_bad[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 4.025059</code></pre>
<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1269-1"><a href="colinealidad.html#cb1269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beta_hat_good[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 4.004913</code></pre>
<div class="sourceCode" id="cb1271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1271-1"><a href="colinealidad.html#cb1271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(beta_hat_bad[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 1.642592</code></pre>
<div class="sourceCode" id="cb1273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1273-1"><a href="colinealidad.html#cb1273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(beta_hat_good[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.5470381</code></pre>
<div class="sourceCode" id="cb1275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1275-1"><a href="colinealidad.html#cb1275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1275-2"><a href="colinealidad.html#cb1275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mse_bad,</span>
<span id="cb1275-3"><a href="colinealidad.html#cb1275-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1275-4"><a href="colinealidad.html#cb1275-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1275-5"><a href="colinealidad.html#cb1275-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;MSE, con colinealidad&quot;</span>,</span>
<span id="cb1275-6"><a href="colinealidad.html#cb1275-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;MSE&quot;</span>)</span>
<span id="cb1275-7"><a href="colinealidad.html#cb1275-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mse_good,</span>
<span id="cb1275-8"><a href="colinealidad.html#cb1275-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb1275-9"><a href="colinealidad.html#cb1275-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1275-10"><a href="colinealidad.html#cb1275-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;MSE, sin colinealidad&quot;</span>,</span>
<span id="cb1275-11"><a href="colinealidad.html#cb1275-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;MSE&quot;</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-598-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Curiosamente, en ambos casos, el MSE es aproximadamente el mismo en promedio. Nuevamente, esto se debe a que la colinealidad afecta la capacidad de un modelo para <em>explicar</em>, pero no predecir.</p>
<div class="sourceCode" id="cb1276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1276-1"><a href="colinealidad.html#cb1276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mse_bad)</span></code></pre></div>
<pre><code>## [1] 17.7186</code></pre>
<div class="sourceCode" id="cb1278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1278-1"><a href="colinealidad.html#cb1278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mse_good)</span></code></pre></div>
<pre><code>## [1] 17.70513</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="transformaciones.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selección-de-variables-y-construcción-de-modelos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
