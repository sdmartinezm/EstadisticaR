<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 14 Transformaciones | Estadística aplicada con R</title>
  <meta name="description" content="Capítulo 14 Transformaciones | Estadística aplicada con R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 14 Transformaciones | Estadística aplicada con R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 14 Transformaciones | Estadística aplicada con R" />
  
  
  



<meta name="date" content="2021-05-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.gif" type="image/x-icon" />
<link rel="prev" href="diagnóstico-de-modelos.html"/>
<link rel="next" href="colinealidad.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística aplicada con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#convenciones"><i class="fa fa-check"></i><b>1.1</b> Convenciones</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>2</b> Introducción a <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#primeros-pasos"><i class="fa fa-check"></i><b>2.1</b> Primeros pasos</a></li>
<li class="chapter" data-level="2.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#cálculos-básicos"><i class="fa fa-check"></i><b>2.2</b> Cálculos básicos</a></li>
<li class="chapter" data-level="2.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#obteniendo-ayuda"><i class="fa fa-check"></i><b>2.3</b> Obteniendo ayuda</a></li>
<li class="chapter" data-level="2.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>2.4</b> Instalación de paquetes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datos-y-programación.html"><a href="datos-y-programación.html"><i class="fa fa-check"></i><b>3</b> Datos y programación</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#tipos-de-datos"><i class="fa fa-check"></i><b>3.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="3.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#estructuras-de-datos"><i class="fa fa-check"></i><b>3.2</b> Estructuras de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectores"><i class="fa fa-check"></i><b>3.2.1</b> Vectores</a></li>
<li class="chapter" data-level="3.2.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#vectorización"><i class="fa fa-check"></i><b>3.2.2</b> Vectorización</a></li>
<li class="chapter" data-level="3.2.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#operadores-logicos"><i class="fa fa-check"></i><b>3.2.3</b> Operadores logicos</a></li>
<li class="chapter" data-level="3.2.4" data-path="datos-y-programación.html"><a href="datos-y-programación.html#más-vectorización"><i class="fa fa-check"></i><b>3.2.4</b> Más vectorización</a></li>
<li class="chapter" data-level="3.2.5" data-path="datos-y-programación.html"><a href="datos-y-programación.html#matrices"><i class="fa fa-check"></i><b>3.2.5</b> Matrices</a></li>
<li class="chapter" data-level="3.2.6" data-path="datos-y-programación.html"><a href="datos-y-programación.html#listas"><i class="fa fa-check"></i><b>3.2.6</b> Listas</a></li>
<li class="chapter" data-level="3.2.7" data-path="datos-y-programación.html"><a href="datos-y-programación.html#marcos-de-datos"><i class="fa fa-check"></i><b>3.2.7</b> Marcos de datos</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datos-y-programación.html"><a href="datos-y-programación.html#conceptos-básicos-de-programación"><i class="fa fa-check"></i><b>3.3</b> Conceptos básicos de programación</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datos-y-programación.html"><a href="datos-y-programación.html#flujo-de-control"><i class="fa fa-check"></i><b>3.3.1</b> Flujo de control</a></li>
<li class="chapter" data-level="3.3.2" data-path="datos-y-programación.html"><a href="datos-y-programación.html#funciones"><i class="fa fa-check"></i><b>3.3.2</b> Funciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html"><i class="fa fa-check"></i><b>4</b> Resumen de datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#resumen-estadístico"><i class="fa fa-check"></i><b>4.1</b> Resumen estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#tendencia-central"><i class="fa fa-check"></i>Tendencia central</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#dispersión"><i class="fa fa-check"></i>Dispersión</a></li>
<li class="chapter" data-level="" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#categórica"><i class="fa fa-check"></i>Categórica</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#graficas"><i class="fa fa-check"></i><b>4.2</b> Graficas</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#histogramas"><i class="fa fa-check"></i><b>4.2.1</b> Histogramas</a></li>
<li class="chapter" data-level="4.2.2" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-barras"><i class="fa fa-check"></i><b>4.2.2</b> Gráfico de barras</a></li>
<li class="chapter" data-level="4.2.3" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#diagramas-de-cajas"><i class="fa fa-check"></i><b>4.2.3</b> Diagramas de cajas</a></li>
<li class="chapter" data-level="4.2.4" data-path="resumen-de-datos.html"><a href="resumen-de-datos.html#gráfico-de-dispersión"><i class="fa fa-check"></i><b>4.2.4</b> Gráfico de dispersión</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html"><i class="fa fa-check"></i><b>5</b> Probabilidad y estadística en <code>R</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#probabilidad-en-r"><i class="fa fa-check"></i><b>5.1</b> Probabilidad en <code>R</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribuciones"><i class="fa fa-check"></i><b>5.1.1</b> Distribuciones</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#pruebas-de-hipótesis-en-r"><i class="fa fa-check"></i><b>5.2</b> Pruebas de hipótesis en <code>R</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-revisión"><i class="fa fa-check"></i><b>5.2.1</b> Prueba t de una muestra: revisión</a></li>
<li class="chapter" data-level="5.2.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-una-muestra-ejemplo"><i class="fa fa-check"></i><b>5.2.2</b> Prueba t de una muestra: ejemplo</a></li>
<li class="chapter" data-level="5.2.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-revisión"><i class="fa fa-check"></i><b>5.2.3</b> Prueba t de dos muestras: revisión</a></li>
<li class="chapter" data-level="5.2.4" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#prueba-t-de-dos-muestras-ejemplo"><i class="fa fa-check"></i><b>5.2.4</b> Prueba t de dos muestras: Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#simulación"><i class="fa fa-check"></i><b>5.3</b> Simulación</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#diferencias-emparejadas"><i class="fa fa-check"></i><b>5.3.1</b> Diferencias emparejadas</a></li>
<li class="chapter" data-level="5.3.2" data-path="probabilidad-y-estadística-en-r.html"><a href="probabilidad-y-estadística-en-r.html#distribución-de-una-media-muestral"><i class="fa fa-check"></i><b>5.3.2</b> Distribución de una media muestral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="recursos-r.html"><a href="recursos-r.html"><i class="fa fa-check"></i><b>6</b> Recursos <code>R</code></a>
<ul>
<li class="chapter" data-level="6.1" data-path="recursos-r.html"><a href="recursos-r.html#referencias-y-tutoriales-para-principiantes"><i class="fa fa-check"></i><b>6.1</b> Referencias y tutoriales para principiantes</a></li>
<li class="chapter" data-level="6.2" data-path="recursos-r.html"><a href="recursos-r.html#referencias-intermedias"><i class="fa fa-check"></i><b>6.2</b> Referencias intermedias</a></li>
<li class="chapter" data-level="6.3" data-path="recursos-r.html"><a href="recursos-r.html#referencias-avanzadas"><i class="fa fa-check"></i><b>6.3</b> Referencias avanzadas</a></li>
<li class="chapter" data-level="6.4" data-path="recursos-r.html"><a href="recursos-r.html#comparaciones-rápidas-con-otros-lenguajes"><i class="fa fa-check"></i><b>6.4</b> Comparaciones rápidas con otros lenguajes</a></li>
<li class="chapter" data-level="6.5" data-path="recursos-r.html"><a href="recursos-r.html#vídeos-de-rstudio-y-rmarkdown"><i class="fa fa-check"></i><b>6.5</b> Vídeos de RStudio y RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html"><i class="fa fa-check"></i><b>7</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelado"><i class="fa fa-check"></i><b>7.1</b> Modelado</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#modelo-de-regresión-lineal-simple"><i class="fa fa-check"></i><b>7.1.1</b> Modelo de regresión lineal simple</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-mínimos-cuadrados"><i class="fa fa-check"></i><b>7.2</b> Enfoque de mínimos cuadrados</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#haciendo-predicciones"><i class="fa fa-check"></i><b>7.2.1</b> Haciendo predicciones</a></li>
<li class="chapter" data-level="7.2.2" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#residuales"><i class="fa fa-check"></i><b>7.2.2</b> Residuales</a></li>
<li class="chapter" data-level="7.2.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#estimación-de-la-varianza"><i class="fa fa-check"></i><b>7.2.3</b> Estimación de la varianza</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#descomposición-de-variación"><i class="fa fa-check"></i><b>7.3</b> Descomposición de variación</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>7.3.1</b> Coeficiente de determinación</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#la-función-lm"><i class="fa fa-check"></i><b>7.4</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="7.5" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#enfoque-de-estimación-de-máxima-verosimilitud-mle"><i class="fa fa-check"></i><b>7.5</b> Enfoque de estimación de máxima verosimilitud (MLE)</a></li>
<li class="chapter" data-level="7.6" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#simulando-slr"><i class="fa fa-check"></i><b>7.6</b> Simulando SLR</a></li>
<li class="chapter" data-level="7.7" data-path="regresión-lineal-simple.html"><a href="regresión-lineal-simple.html#historia"><i class="fa fa-check"></i><b>7.7</b> Historia</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html"><i class="fa fa-check"></i><b>8</b> Inferencia para regresión lineal simple</a>
<ul>
<li class="chapter" data-level="8.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#teorema-de-gauss-markov"><i class="fa fa-check"></i><b>8.1</b> Teorema de Gauss-Markov</a></li>
<li class="chapter" data-level="8.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#distribuciones-muestrales"><i class="fa fa-check"></i><b>8.2</b> Distribuciones muestrales</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#simular-distribuciones-muestrales"><i class="fa fa-check"></i><b>8.2.1</b> Simular distribuciones muestrales</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#errores-estándar"><i class="fa fa-check"></i><b>8.3</b> Errores estándar</a></li>
<li class="chapter" data-level="8.4" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-para-pendiente-e-intercepto"><i class="fa fa-check"></i><b>8.4</b> Intervalos de confianza para pendiente e Intercepto</a></li>
<li class="chapter" data-level="8.5" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>8.5</b> Pruebas de hipótesis</a></li>
<li class="chapter" data-level="8.6" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#ejemplo-cars"><i class="fa fa-check"></i><b>8.6</b> Ejemplo <code>cars</code></a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#pruebas-en-r"><i class="fa fa-check"></i><b>8.6.1</b> Pruebas en <code>R</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-t."><i class="fa fa-check"></i><b>8.6.2</b> Significancia de la regresión, prueba t.</a></li>
<li class="chapter" data-level="8.6.3" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalos-de-confianza-en-r"><i class="fa fa-check"></i><b>8.6.3</b> Intervalos de confianza en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>8.7</b> Intervalo de confianza para la respuesta Promedio</a></li>
<li class="chapter" data-level="8.8" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#intervalo-de-predicción-para-nuevas-observaciones"><i class="fa fa-check"></i><b>8.8</b> Intervalo de predicción para nuevas observaciones</a></li>
<li class="chapter" data-level="8.9" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#bandas-de-confianza-y-predicción"><i class="fa fa-check"></i><b>8.9</b> Bandas de confianza y predicción</a></li>
<li class="chapter" data-level="8.10" data-path="inferencia-para-regresión-lineal-simple.html"><a href="inferencia-para-regresión-lineal-simple.html#significancia-de-la-regresión-prueba-f"><i class="fa fa-check"></i><b>8.10</b> Significancia de la regresión, prueba F</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html"><i class="fa fa-check"></i><b>9</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#enfoque-matricial-para-la-regresión"><i class="fa fa-check"></i><b>9.1</b> Enfoque matricial para la regresión</a></li>
<li class="chapter" data-level="9.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#distribución-muestral"><i class="fa fa-check"></i><b>9.2</b> Distribución muestral</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#pruebas-de-un-solo-parámetro"><i class="fa fa-check"></i><b>9.2.1</b> Pruebas de un solo parámetro</a></li>
<li class="chapter" data-level="9.2.2" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>9.2.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="9.2.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-confianza-para-la-respuesta-media"><i class="fa fa-check"></i><b>9.2.3</b> Intervalos de confianza para la respuesta media</a></li>
<li class="chapter" data-level="9.2.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#intervalos-de-predicción"><i class="fa fa-check"></i><b>9.2.4</b> Intervalos de predicción</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#significancia-de-la-regresión"><i class="fa fa-check"></i><b>9.3</b> Significancia de la regresión</a></li>
<li class="chapter" data-level="9.4" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#modelos-anidados"><i class="fa fa-check"></i><b>9.4</b> Modelos anidados</a></li>
<li class="chapter" data-level="9.5" data-path="regresión-lineal-múltiple.html"><a href="regresión-lineal-múltiple.html#simulación-1"><i class="fa fa-check"></i><b>9.5</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html"><i class="fa fa-check"></i><b>10</b> Construcción del modelo</a>
<ul>
<li class="chapter" data-level="10.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia-forma-y-ajuste."><i class="fa fa-check"></i><b>10.1</b> Familia, forma, y ajuste.</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#ajuste."><i class="fa fa-check"></i><b>10.1.1</b> Ajuste.</a></li>
<li class="chapter" data-level="10.1.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#forma"><i class="fa fa-check"></i><b>10.1.2</b> Forma</a></li>
<li class="chapter" data-level="10.1.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#familia"><i class="fa fa-check"></i><b>10.1.3</b> Familia</a></li>
<li class="chapter" data-level="10.1.4" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#modelo-asumido-modelo-ajustado"><i class="fa fa-check"></i><b>10.1.4</b> Modelo asumido, modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación-versus-predicción"><i class="fa fa-check"></i><b>10.2</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#explicación"><i class="fa fa-check"></i><b>10.2.1</b> Explicación</a></li>
<li class="chapter" data-level="10.2.2" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#predicción"><i class="fa fa-check"></i><b>10.2.2</b> Predicción</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="construcción-del-modelo.html"><a href="construcción-del-modelo.html#resumen"><i class="fa fa-check"></i><b>10.3</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html"><i class="fa fa-check"></i><b>11</b> Interacciones y predictores categóricos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-ficticias-dummy"><i class="fa fa-check"></i><b>11.1</b> Variables ficticias (Dummy)</a></li>
<li class="chapter" data-level="11.2" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#interacciones"><i class="fa fa-check"></i><b>11.2</b> Interacciones</a></li>
<li class="chapter" data-level="11.3" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#variables-factor"><i class="fa fa-check"></i><b>11.3</b> Variables factor</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#factores-con-más-de-dos-niveles"><i class="fa fa-check"></i><b>11.3.1</b> Factores con más de dos niveles</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#parametrización"><i class="fa fa-check"></i><b>11.4</b> Parametrización</a></li>
<li class="chapter" data-level="11.5" data-path="interacciones-y-predictores-categóricos.html"><a href="interacciones-y-predictores-categóricos.html#construcción-de-modelos-más-grandes"><i class="fa fa-check"></i><b>11.5</b> Construcción de modelos más grandes</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html"><i class="fa fa-check"></i><b>12</b> Análisis de varianza</a>
<ul>
<li class="chapter" data-level="12.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#experimentos"><i class="fa fa-check"></i><b>12.1</b> Experimentos</a></li>
<li class="chapter" data-level="12.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#prueba-t-de-dos-muestras"><i class="fa fa-check"></i><b>12.2</b> Prueba t de dos muestras</a></li>
<li class="chapter" data-level="12.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-una-vía"><i class="fa fa-check"></i><b>12.3</b> ANOVA de una vía</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#variables-factor-1"><i class="fa fa-check"></i><b>12.3.1</b> Variables factor</a></li>
<li class="chapter" data-level="12.3.2" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#algo-de-simulación"><i class="fa fa-check"></i><b>12.3.2</b> Algo de simulación</a></li>
<li class="chapter" data-level="12.3.3" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#potencia"><i class="fa fa-check"></i><b>12.3.3</b> Potencia</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#pruebas-post-hoc"><i class="fa fa-check"></i><b>12.4</b> Pruebas Post Hoc</a></li>
<li class="chapter" data-level="12.5" data-path="análisis-de-varianza.html"><a href="análisis-de-varianza.html#anova-de-dos-vías"><i class="fa fa-check"></i><b>12.5</b> ANOVA de dos vías</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html"><i class="fa fa-check"></i><b>13</b> Diagnóstico de modelos</a>
<ul>
<li class="chapter" data-level="13.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#supuestos-del-modelo"><i class="fa fa-check"></i><b>13.1</b> Supuestos del modelo</a></li>
<li class="chapter" data-level="13.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#comprobación-de-supuestos"><i class="fa fa-check"></i><b>13.2</b> Comprobación de supuestos</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráfica-de-ajustados-versus-residuos"><i class="fa fa-check"></i><b>13.2.1</b> Gráfica de ajustados versus residuos</a></li>
<li class="chapter" data-level="13.2.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-breusch-pagan"><i class="fa fa-check"></i><b>13.2.2</b> Prueba de Breusch-Pagan</a></li>
<li class="chapter" data-level="13.2.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#histogramas-1"><i class="fa fa-check"></i><b>13.2.3</b> Histogramas</a></li>
<li class="chapter" data-level="13.2.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#gráficos-q-q"><i class="fa fa-check"></i><b>13.2.4</b> Gráficos Q-Q</a></li>
<li class="chapter" data-level="13.2.5" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#prueba-de-shapiro-wilk"><i class="fa fa-check"></i><b>13.2.5</b> Prueba de Shapiro-Wilk</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#observaciones-inusuales"><i class="fa fa-check"></i><b>13.3</b> Observaciones inusuales</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#apalancamiento"><i class="fa fa-check"></i><b>13.3.1</b> Apalancamiento</a></li>
<li class="chapter" data-level="13.3.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#valores-atípicos"><i class="fa fa-check"></i><b>13.3.2</b> Valores atípicos</a></li>
<li class="chapter" data-level="13.3.3" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#influencia"><i class="fa fa-check"></i><b>13.3.3</b> Influencia</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#ejemplos-de-análisis-de-datos"><i class="fa fa-check"></i><b>13.4</b> Ejemplos de análisis de datos</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#buenos-diagnósticos"><i class="fa fa-check"></i><b>13.4.1</b> Buenos diagnósticos</a></li>
<li class="chapter" data-level="13.4.2" data-path="diagnóstico-de-modelos.html"><a href="diagnóstico-de-modelos.html#diagnóstico-sospechoso"><i class="fa fa-check"></i><b>13.4.2</b> Diagnóstico sospechoso</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="transformaciones.html"><a href="transformaciones.html"><i class="fa fa-check"></i><b>14</b> Transformaciones</a>
<ul>
<li class="chapter" data-level="14.1" data-path="transformaciones.html"><a href="transformaciones.html#transformación-de-respuesta"><i class="fa fa-check"></i><b>14.1</b> Transformación de respuesta</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-estabilizadoras-de-varianza"><i class="fa fa-check"></i><b>14.1.1</b> Transformaciones estabilizadoras de varianza</a></li>
<li class="chapter" data-level="14.1.2" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-box-cox"><i class="fa fa-check"></i><b>14.1.2</b> Transformaciones de Box-Cox</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="transformaciones.html"><a href="transformaciones.html#transformación-del-predictor"><i class="fa fa-check"></i><b>14.2</b> Transformación del predictor</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="transformaciones.html"><a href="transformaciones.html#polinomios"><i class="fa fa-check"></i><b>14.2.1</b> Polinomios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-respuesta"><i class="fa fa-check"></i>Transformaciones de respuesta</a></li>
<li class="chapter" data-level="" data-path="transformaciones.html"><a href="transformaciones.html#transformaciones-de-predictores"><i class="fa fa-check"></i>Transformaciones de predictores</a>
<ul>
<li class="chapter" data-level="14.2.2" data-path="transformaciones.html"><a href="transformaciones.html#un-modelo-cuadrático"><i class="fa fa-check"></i><b>14.2.2</b> Un modelo cuadrático</a></li>
<li class="chapter" data-level="14.2.3" data-path="transformaciones.html"><a href="transformaciones.html#sobreajuste-y-extrapolación"><i class="fa fa-check"></i><b>14.2.3</b> Sobreajuste y extrapolación</a></li>
<li class="chapter" data-level="14.2.4" data-path="transformaciones.html"><a href="transformaciones.html#comparación-de-modelos-polinomiales"><i class="fa fa-check"></i><b>14.2.4</b> Comparación de modelos polinomiales</a></li>
<li class="chapter" data-level="14.2.5" data-path="transformaciones.html"><a href="transformaciones.html#poly-función-y-polinomios-ortogonales"><i class="fa fa-check"></i><b>14.2.5</b> <code>poly()</code> Función y polinomios ortogonales</a></li>
<li class="chapter" data-level="14.2.6" data-path="transformaciones.html"><a href="transformaciones.html#función-de-inhibición"><i class="fa fa-check"></i><b>14.2.6</b> Función de inhibición</a></li>
<li class="chapter" data-level="14.2.7" data-path="transformaciones.html"><a href="transformaciones.html#ejemplo-con-datos"><i class="fa fa-check"></i><b>14.2.7</b> Ejemplo con datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="colinealidad.html"><a href="colinealidad.html"><i class="fa fa-check"></i><b>15</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="15.1" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-exacta"><i class="fa fa-check"></i><b>15.1</b> Colinealidad exacta</a></li>
<li class="chapter" data-level="15.2" data-path="colinealidad.html"><a href="colinealidad.html#colinealidad-1"><i class="fa fa-check"></i><b>15.2</b> Colinealidad</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="colinealidad.html"><a href="colinealidad.html#factor-de-inflación-de-la-varianza."><i class="fa fa-check"></i><b>15.2.1</b> Factor de inflación de la varianza.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="colinealidad.html"><a href="colinealidad.html#simulación-2"><i class="fa fa-check"></i><b>15.3</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html"><i class="fa fa-check"></i><b>16</b> Selección de variables y construcción de modelos</a>
<ul>
<li class="chapter" data-level="16.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-calidad"><i class="fa fa-check"></i><b>16.1</b> Criterio de calidad</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-de-akaike"><i class="fa fa-check"></i><b>16.1.1</b> Criterio de información de Akaike</a></li>
<li class="chapter" data-level="16.1.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#criterio-de-información-bayesiano"><i class="fa fa-check"></i><b>16.1.2</b> Criterio de información Bayesiano</a></li>
<li class="chapter" data-level="16.1.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#r-cuadrado-ajustado"><i class="fa fa-check"></i><b>16.1.3</b> R cuadrado ajustado</a></li>
<li class="chapter" data-level="16.1.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#rmse-con-validación-cruzada"><i class="fa fa-check"></i><b>16.1.4</b> RMSE con validación cruzada</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#procedimientos-de-selección"><i class="fa fa-check"></i><b>16.2</b> Procedimientos de selección</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-atrás-backward"><i class="fa fa-check"></i><b>16.2.1</b> Búsqueda hacia atrás (Backward)</a></li>
<li class="chapter" data-level="16.2.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-hacia-adelante-forward"><i class="fa fa-check"></i><b>16.2.2</b> Búsqueda hacia adelante (Forward)</a></li>
<li class="chapter" data-level="16.2.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-por-pasos-stepwise"><i class="fa fa-check"></i><b>16.2.3</b> Búsqueda por pasos (Stepwise)</a></li>
<li class="chapter" data-level="16.2.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#búsqueda-exhaustiva"><i class="fa fa-check"></i><b>16.2.4</b> Búsqueda exhaustiva</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#términos-de-orden-superior"><i class="fa fa-check"></i><b>16.3</b> Términos de orden superior</a></li>
<li class="chapter" data-level="16.4" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-versus-predicción-1"><i class="fa fa-check"></i><b>16.4</b> Explicación versus predicción</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#explicación-1"><i class="fa fa-check"></i><b>16.4.1</b> Explicación</a></li>
<li class="chapter" data-level="16.4.2" data-path="selección-de-variables-y-construcción-de-modelos.html"><a href="selección-de-variables-y-construcción-de-modelos.html#predicción-1"><i class="fa fa-check"></i><b>16.4.2</b> Predicción</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="regresión-logística.html"><a href="regresión-logística.html"><i class="fa fa-check"></i><b>17</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="17.1" data-path="regresión-logística.html"><a href="regresión-logística.html#modelos-lineales-generalizados"><i class="fa fa-check"></i><b>17.1</b> Modelos lineales generalizados</a></li>
<li class="chapter" data-level="17.2" data-path="regresión-logística.html"><a href="regresión-logística.html#respuesta-binaria"><i class="fa fa-check"></i><b>17.2</b> Respuesta binaria</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ajuste-de-la-regresión-logística"><i class="fa fa-check"></i><b>17.2.1</b> Ajuste de la regresión logística</a></li>
<li class="chapter" data-level="17.2.2" data-path="regresión-logística.html"><a href="regresión-logística.html#problemas-de-ajuste"><i class="fa fa-check"></i><b>17.2.2</b> Problemas de ajuste</a></li>
<li class="chapter" data-level="17.2.3" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplos-de-simulación"><i class="fa fa-check"></i><b>17.2.3</b> Ejemplos de simulación</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="regresión-logística.html"><a href="regresión-logística.html#trabajar-con-regresión-logística"><i class="fa fa-check"></i><b>17.3</b> Trabajar con regresión logística</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="regresión-logística.html"><a href="regresión-logística.html#pruebas-con-glms"><i class="fa fa-check"></i><b>17.3.1</b> Pruebas con GLMs</a></li>
<li class="chapter" data-level="17.3.2" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-wald"><i class="fa fa-check"></i><b>17.3.2</b> Prueba de Wald</a></li>
<li class="chapter" data-level="17.3.3" data-path="regresión-logística.html"><a href="regresión-logística.html#prueba-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>17.3.3</b> Prueba de razón de verosimilitud</a></li>
<li class="chapter" data-level="17.3.4" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-saheart"><i class="fa fa-check"></i><b>17.3.4</b> Ejemplo <code>SAheart</code></a></li>
<li class="chapter" data-level="17.3.5" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-1"><i class="fa fa-check"></i><b>17.3.5</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="17.3.6" data-path="regresión-logística.html"><a href="regresión-logística.html#intervalos-de-confianza-para-la-respuesta-promedio"><i class="fa fa-check"></i><b>17.3.6</b> Intervalos de confianza para la respuesta promedio</a></li>
<li class="chapter" data-level="17.3.7" data-path="regresión-logística.html"><a href="regresión-logística.html#sintaxis-de-la-fórmula"><i class="fa fa-check"></i><b>17.3.7</b> Sintaxis de la fórmula</a></li>
<li class="chapter" data-level="17.3.8" data-path="regresión-logística.html"><a href="regresión-logística.html#desviación"><i class="fa fa-check"></i><b>17.3.8</b> Desviación</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="regresión-logística.html"><a href="regresión-logística.html#clasificación"><i class="fa fa-check"></i><b>17.4</b> Clasificación</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="regresión-logística.html"><a href="regresión-logística.html#ejemplo-spam"><i class="fa fa-check"></i><b>17.4.1</b> Ejemplo <code>spam</code></a></li>
<li class="chapter" data-level="17.4.2" data-path="regresión-logística.html"><a href="regresión-logística.html#evaluar-clasificadores"><i class="fa fa-check"></i><b>17.4.2</b> Evaluar clasificadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="más-allá.html"><a href="más-allá.html"><i class="fa fa-check"></i><b>18</b> Más allá</a>
<ul>
<li class="chapter" data-level="18.1" data-path="más-allá.html"><a href="más-allá.html#rstudio"><i class="fa fa-check"></i><b>18.1</b> RStudio</a></li>
<li class="chapter" data-level="18.2" data-path="más-allá.html"><a href="más-allá.html#tidy-data"><i class="fa fa-check"></i><b>18.2</b> Tidy Data</a></li>
<li class="chapter" data-level="18.3" data-path="más-allá.html"><a href="más-allá.html#visualización"><i class="fa fa-check"></i><b>18.3</b> Visualización</a></li>
<li class="chapter" data-level="18.4" data-path="más-allá.html"><a href="más-allá.html#aplicaciones-web"><i class="fa fa-check"></i><b>18.4</b> Aplicaciones web</a></li>
<li class="chapter" data-level="18.5" data-path="más-allá.html"><a href="más-allá.html#diseño-experimental"><i class="fa fa-check"></i><b>18.5</b> Diseño experimental</a></li>
<li class="chapter" data-level="18.6" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-automático-machine-learning"><i class="fa fa-check"></i><b>18.6</b> Aprendizaje automático (Machine Learning)</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="más-allá.html"><a href="más-allá.html#aprendizaje-profundo-deep-learning"><i class="fa fa-check"></i><b>18.6.1</b> Aprendizaje profundo (Deep Learning)</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="más-allá.html"><a href="más-allá.html#series-de-tiempo"><i class="fa fa-check"></i><b>18.7</b> Series de tiempo</a></li>
<li class="chapter" data-level="18.8" data-path="más-allá.html"><a href="más-allá.html#bayesiana"><i class="fa fa-check"></i><b>18.8</b> Bayesiana</a></li>
<li class="chapter" data-level="18.9" data-path="más-allá.html"><a href="más-allá.html#computación-de-alto-rendimiento."><i class="fa fa-check"></i><b>18.9</b> Computación de alto rendimiento.</a></li>
<li class="chapter" data-level="18.10" data-path="más-allá.html"><a href="más-allá.html#recursos-adicionales-de-r"><i class="fa fa-check"></i><b>18.10</b> Recursos adicionales de <code>R</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daviddalpiaz/appliedstats" target="blank">&copy; 2020 Adapatado de David Dalpiaz</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística aplicada con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transformaciones" class="section level1" number="14">
<h1><span class="header-section-number">Capítulo 14</span> Transformaciones</h1>
<blockquote>
<p>“Dame una palanca lo suficientemente larga y un punto de apoyo para colocarla, y moveré el mundo.”</p>
<p>— <strong>Archimedes</strong></p>
</blockquote>
<p>Después de leer este capítulo, podrá:</p>
<ul>
<li>Comprender el concepto de transformación estabilizadora de varianza.</li>
<li>Utilizar transformaciones de la respuesta para mejorar los modelos de regresión.</li>
<li>Utilice términos polinomiales como predictores para ajustar modelos de regresión más flexibles.</li>
</ul>
<p>En el último capítulo, verificamos los supuestos de los modelos de regresión y buscamos formas de diagnosticar posibles problemas. En este capítulo usaremos transformaciones de variables de respuesta y predictoras para corregir problemas con los diagnósticos del modelo, y también potencialmente, simplemente, hacer que un modelo se ajuste mejor a los datos.</p>
<div id="transformación-de-respuesta" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Transformación de respuesta</h2>
<p>Veamos algunos datos salariales (<em>ficticios</em>) de la empresa (<em>ficticia</em>) <em>Initech</em>. Intentaremos modelar <code>salary</code> en función de <code>years</code>. Los datos se pueden encontrar en <a href="data/initech.csv"><code>initech.csv</code></a>.</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="transformaciones.html#cb1012-1" aria-hidden="true" tabindex="-1"></a>initech <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/initech.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1013-1"><a href="transformaciones.html#cb1013-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1013-2"><a href="transformaciones.html#cb1013-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-452-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Primero ajustamos un modelo lineal simple.</p>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="transformaciones.html#cb1014-1" aria-hidden="true" tabindex="-1"></a>initech_fit <span class="ot">=</span> <span class="fu">lm</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech)</span>
<span id="cb1014-2"><a href="transformaciones.html#cb1014-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(initech_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = salary ~ years, data = initech)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -57225 -18104    241  15589  91332 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5302       5750   0.922    0.359    
## years           8637        389  22.200   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 27360 on 98 degrees of freedom
## Multiple R-squared:  0.8341, Adjusted R-squared:  0.8324 
## F-statistic: 492.8 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Este modelo parece significativo, pero ¿cumple los supuestos del modelo?</p>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="transformaciones.html#cb1016-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1016-2"><a href="transformaciones.html#cb1016-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1016-3"><a href="transformaciones.html#cb1016-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(initech_fit, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-454-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Al agregar la línea ajustada al gráfico, vemos que la relación lineal parece correcta.</p>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1017-1"><a href="transformaciones.html#cb1017-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1017-2"><a href="transformaciones.html#cb1017-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1017-3"><a href="transformaciones.html#cb1017-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(initech_fit), <span class="fu">resid</span>(initech_fit), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1017-4"><a href="transformaciones.html#cb1017-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1017-5"><a href="transformaciones.html#cb1017-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1017-6"><a href="transformaciones.html#cb1017-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1017-7"><a href="transformaciones.html#cb1017-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(initech_fit), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1017-8"><a href="transformaciones.html#cb1017-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(initech_fit), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-455-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Sin embargo, a partir de la gráfica de ajustados versus residuales, parece que hay una varianza no constante. Específicamente, la varianza aumenta a medida que aumenta el valor ajustado.</p>
<div id="transformaciones-estabilizadoras-de-varianza" class="section level3" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Transformaciones estabilizadoras de varianza</h3>
<p>Recuerde que el valor ajustado es nuestra estimación de la media a un valor particular de <span class="math inline">\(x\)</span>. Bajo nuestras suposiciones habituales,</p>
<p><span class="math display">\[
  \epsilon \sim N(0,\sigma^2)
\]</span></p>
<p>y por lo tanto</p>
<p><span class="math display">\[
  \text{Var}[Y | X = x] = \sigma^2
\]</span></p>
<p>que es un valor constante para cualquier valor de <span class="math inline">\(x\)</span>.</p>
<p>Sin embargo, aquí vemos que la varianza es una función de la media,</p>
<p><span class="math display">\[
  \text{Var}[Y \mid X = x] = h(\text{E}[Y \mid X = x]).
\]</span></p>
<p>En este caso, <span class="math inline">\(h\)</span> es una función creciente.</p>
<p>Para corregir esto, nos gustaría encontrar alguna función de <span class="math inline">\(Y\)</span>, <span class="math inline">\(g(Y)\)</span> tal que,</p>
<p><span class="math display">\[
  \text{Var}[g(Y) \mid X = x] = c
\]</span></p>
<p>donde <span class="math inline">\(c\)</span> es una constante que no depende de la media, <span class="math inline">\(\text{E}[Y \mid X = x]\)</span>. Una transformación que logra esto se llama <strong>transformación estabilizadora de varianza.</strong></p>
<p>Una transformación de estabilización de la varianza (VST) común cuando vemos una varianza creciente en una gráfica de ajustados versus residuales es <span class="math inline">\(\log(Y)\)</span>. Además, si los valores de una variable abarcan más de un orden de magnitud y la variable es <em>estrictamente positiva</em>, es probable que sea útil reemplazar la variable por su logaritmo.</p>
<p>Un recordatorio, que para nuestros propósitos, <span class="math inline">\(\log\)</span> y <span class="math inline">\(\ln\)</span> son ambos logaritmos naturales. <code>R</code> usa <code>log</code> para referirse al logaritmo natural, a menos que se especifique una base diferente.</p>
<p>Ahora usaremos un modelo con una respuesta transformada logarítmicamente para los datos <em>Initech</em>,</p>
<p><span class="math display">\[
  \log(Y_i) = \beta_0 + \beta_1 x_i + \epsilon_i.
\]</span></p>
<p>Tenga en cuenta que si volvemos a escalar el modelo desde una escala logarítmica a la escala original de los datos, ahora tenemos</p>
<p><span class="math display">\[
  Y_i = \exp(\beta_0 + \beta_1 x_i) \cdot \exp(\epsilon_i)
\]</span></p>
<p>que tiene los errores que ingresan al modelo de forma multiplicativa.</p>
<p>El ajuste de este modelo en <code>R</code> requiere sólo una pequeña modificación en la especificación de nuestra fórmula.</p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="transformaciones.html#cb1018-1" aria-hidden="true" tabindex="-1"></a>initech_fit_log <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> years, <span class="at">data =</span> initech)</span></code></pre></div>
<p>Tenga en cuenta que aunque <code>log(y)</code> se considera la nueva variable respuesta, en realidad no creamos una nueva variable en <code>R</code>, sino que simplemente transformamos la variable dentro de la fórmula del modelo.</p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="transformaciones.html#cb1019-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1019-2"><a href="transformaciones.html#cb1019-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1019-3"><a href="transformaciones.html#cb1019-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(initech_fit_log, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-457-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Al graficar los datos en la escala logarítmica transformada y al agregar la línea ajustada, la relación vuelve a parecer lineal y ya podemos ver que la variación sobre la línea ajustada parece constante.</p>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1020-1"><a href="transformaciones.html#cb1020-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1020-2"><a href="transformaciones.html#cb1020-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1020-3"><a href="transformaciones.html#cb1020-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(initech_fit_log<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> initech_fit_log<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x),</span>
<span id="cb1020-4"><a href="transformaciones.html#cb1020-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-458-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Al trazar los datos en la escala original y agregar la regresión ajustada, vemos una relación exponencial. Sin embargo, este sigue siendo un modelo <em>lineal</em>, ya que la nueva respuesta transformada, <span class="math inline">\(\log(y)\)</span>, sigue siendo una combinación <em>lineal</em> de los predictores.</p>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="transformaciones.html#cb1021-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1021-2"><a href="transformaciones.html#cb1021-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1021-3"><a href="transformaciones.html#cb1021-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(initech_fit_log), <span class="fu">resid</span>(initech_fit_log), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1021-4"><a href="transformaciones.html#cb1021-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1021-5"><a href="transformaciones.html#cb1021-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1021-6"><a href="transformaciones.html#cb1021-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1021-7"><a href="transformaciones.html#cb1021-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(initech_fit_log), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1021-8"><a href="transformaciones.html#cb1021-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(initech_fit_log), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-459-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>La gráfica de ajustados versus residuales se ve mucho mejor. Parece que el supuesto de varianza constante ya no se viola.</p>
<p>Al comparar el RMSE usando la respuesta original y transformada, también vemos que el modelo logarítmico transformado simplemente se ajusta mejor, con un error cuadrático promedio más pequeño.</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="transformaciones.html#cb1022-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">resid</span>(initech_fit) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 27080.16</code></pre>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1024-1"><a href="transformaciones.html#cb1024-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">resid</span>(initech_fit_log) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.1934907</code></pre>
<p>Pero espere, eso no es justo, esta diferencia se debe simplemente a las diferentes escalas que se utilizan.</p>
<div class="sourceCode" id="cb1026"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1026-1"><a href="transformaciones.html#cb1026-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((initech<span class="sc">$</span>salary <span class="sc">-</span> <span class="fu">fitted</span>(initech_fit)) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 27080.16</code></pre>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1028-1"><a href="transformaciones.html#cb1028-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((initech<span class="sc">$</span>salary <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">fitted</span>(initech_fit_log))) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 24280.36</code></pre>
<p>Transformando los valores ajustados del modelo logarítmico de nuevo a la escala de los datos, ¡de hecho vemos que encaja mejor!</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="transformaciones.html#cb1030-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(initech_fit_log)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(salary) ~ years, data = initech)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57022 -0.13560  0.03048  0.14157  0.41366 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.48381    0.04108  255.18   &lt;2e-16 ***
## years        0.07888    0.00278   28.38   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1955 on 98 degrees of freedom
## Multiple R-squared:  0.8915, Adjusted R-squared:  0.8904 
## F-statistic: 805.2 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Nuevamente, la respuesta transformada es una combinación <em>lineal</em> de los predictores,</p>
<p><span class="math display">\[
  \log(\hat{y}(x)) = \hat{\beta}_0 + \hat{\beta}_1 x  = 10.484 + 0.079x.
\]</span></p>
<p>Pero ahora, si volvemos a escalar los datos de una escala logarítmica a la escala original, ahora tenemos</p>
<p><span class="math display">\[
  \hat{y}(x) = \exp(\hat{\beta}_0) \exp(\hat{\beta}_1 x) = \exp(10.484)\exp(0.079x).
\]</span></p>
<p>Vemos que por cada año adicional de experiencia, el salario promedio aumenta <span class="math inline">\(\exp(0.079) = 1.0822\)</span> veces. Ahora estamos multiplicando, no sumando.</p>
<p>Si bien el uso de una transformación <span class="math inline">\(\log\)</span> es posiblemente la transformación de variable de respuesta más común, existen muchas otras. Ahora consideraremos una familia de transformaciones y elegiremos la mejor de entre ellas, que incluye la transformación <span class="math inline">\(\log\)</span>.</p>
</div>
<div id="transformaciones-de-box-cox" class="section level3" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Transformaciones de Box-Cox</h3>
<p>El método de Box-Cox considera una familia de transformaciones sobre variables respuesta estrictamente positivas,</p>
<p><span class="math display">\[
g_\lambda(y) = \left\{
\begin{array}{lr}\displaystyle\frac{y^\lambda - 1}{\lambda} &amp;  \lambda \neq 0\\
        &amp; \\
       \log(y) &amp;  \lambda = 0
     \end{array}
   \right.
\]</span></p>
<p>El parámetro <span class="math inline">\(\lambda\)</span> se elige maximizando numéricamente la log-verosimilitud,</p>
<p><span class="math display">\[
  L(\lambda) = -\frac{n}{2}\log(RSS_\lambda / n) + (\lambda -1)\sum \log(y_i).
\]</span></p>
<p>Un intervalo de confianza al <span class="math inline">\(100(1 - \alpha)\%\)</span> para <span class="math inline">\(\lambda\)</span> es,</p>
<p><span class="math display">\[
    \left\{ \lambda :  L(\lambda) &gt; L(\hat{\lambda}) - \frac{1}{2}\chi_{1,\alpha}^2  \right\}   
\]</span></p>
<p>que <code>R</code> trazará para que nos ayude a seleccionar rápidamente un valor <span class="math inline">\(\lambda\)</span> apropiado. A menudo elegimos un valor “agradable” dentro del intervalo de confianza, en lugar del valor de <span class="math inline">\(\lambda\)</span> que realmente maximiza la probabilidad.</p>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="transformaciones.html#cb1032-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1032-2"><a href="transformaciones.html#cb1032-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span></code></pre></div>
<p>Aquí necesitamos el paquete <code>MASS</code> para la función <code>boxcox()</code>, y consideraremos un par de conjuntos de datos del paquete <code>faraway</code>.</p>
<p>Primero usaremos el conjunto de datos <code>savings</code> como un ejemplo del uso del método Box-Cox para justificar el uso de ninguna transformación. Ajustamos un modelo de regresión múltiple aditiva con <code>sr</code> como respuesta y cada una de las otras variables como predictoras.</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="transformaciones.html#cb1033-1" aria-hidden="true" tabindex="-1"></a>savings_model <span class="ot">=</span> <span class="fu">lm</span>(sr <span class="sc">~</span> ., <span class="at">data =</span> savings)</span></code></pre></div>
<p>Luego usamos la función <code>boxcox()</code> para encontrar la mejor transformación de la forma considerada por el método Box-Cox.</p>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="transformaciones.html#cb1034-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(savings_model, <span class="at">plotit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-465-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>R</code> grafica automáticamente la log-verosimilitud como una función de los posibles valores <span class="math inline">\(\lambda\)</span>. Indica tanto el valor que maximiza la probabilidad logarítmica como un intervalo de confianza para el valor <span class="math inline">\(\lambda\)</span> que maximiza la probabilidad logarítmica.</p>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="transformaciones.html#cb1035-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(savings_model, <span class="at">plotit =</span> <span class="cn">TRUE</span>, <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-466-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Tenga en cuenta que podemos especificar un rango de valores <span class="math inline">\(\lambda\)</span> para considerar y, por lo tanto, graficarlos. A menudo especificamos un rango que es más interesante visualmente. Aquí vemos que <span class="math inline">\(\lambda = 1\)</span> está en el intervalo de confianza y está extremadamente cerca del máximo. Esto sugiere una transformación de la forma.</p>
<p><span class="math display">\[
\frac{y^\lambda - 1}{\lambda} = \frac{y^1 - 1}{1} = y - 1.
\]</span></p>
<p>Básicamente, esto no es una transformación. No cambiaría la varianza ni haría que el modelo se ajustara mejor. Restando 1 de cada valor, solo cambiaríamos la intersección del modelo y los errores resultantes serían los mismos.</p>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="transformaciones.html#cb1036-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(savings_model), <span class="fu">resid</span>(savings_model), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1036-2"><a href="transformaciones.html#cb1036-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1036-3"><a href="transformaciones.html#cb1036-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-467-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Al observar una gráfica de ajustados versus residuales se verifica que probablemente no haya ningún problema con los supuestos de este modelo, que verifican las pruebas de Breusch-Pagan y Shapiro-Wilk.</p>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="transformaciones.html#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1037-2"><a href="transformaciones.html#cb1037-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(savings_model)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  savings_model
## BP = 4.9852, df = 4, p-value = 0.2888</code></pre>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="transformaciones.html#cb1039-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(savings_model))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(savings_model)
## W = 0.98698, p-value = 0.8524</code></pre>
<p>Ahora usaremos el conjunto de datos <code>gala</code> como ejemplo del uso del método Box-Cox para justificar una transformación distinta de <span class="math inline">\(\log\)</span>. Ajustamos un modelo de regresión múltiple aditivo con <code>Species</code> como respuesta y la mayoría de las otras variables como predictores.</p>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1041-1"><a href="transformaciones.html#cb1041-1" aria-hidden="true" tabindex="-1"></a>gala_model <span class="ot">=</span> <span class="fu">lm</span>(Species <span class="sc">~</span> Area <span class="sc">+</span> Elevation <span class="sc">+</span> Nearest <span class="sc">+</span> Scruz <span class="sc">+</span> Adjacent, <span class="at">data =</span> gala)</span></code></pre></div>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1042-1"><a href="transformaciones.html#cb1042-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gala_model), <span class="fu">resid</span>(gala_model), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1042-2"><a href="transformaciones.html#cb1042-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1042-3"><a href="transformaciones.html#cb1042-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-470-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Aunque no hay muchos datos para valores ajustados grandes, todavía parece muy claro que se viola el supuesto de varianza constante.</p>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1043-1"><a href="transformaciones.html#cb1043-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(gala_model, <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="at">by =</span> <span class="fl">0.05</span>), <span class="at">plotit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-471-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Usando el método de Box-Cox, vemos que <span class="math inline">\(\lambda=0.3\)</span> está en el intervalo de confianza y está extremadamente cerca del máximo, lo que sugiere una transformación de la forma</p>
<p><span class="math display">\[
\frac{y^\lambda - 1}{\lambda} = \frac{y^{0.3} - 1}{0.3}.
\]</span></p>
<p>Luego ajustamos un modelo con esta transformación aplicada a la respuesta.</p>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1044-1"><a href="transformaciones.html#cb1044-1" aria-hidden="true" tabindex="-1"></a>gala_model_cox <span class="ot">=</span> <span class="fu">lm</span>((((Species <span class="sc">^</span> <span class="fl">0.3</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fl">0.3</span>) <span class="sc">~</span> Area <span class="sc">+</span> Elevation <span class="sc">+</span> Nearest <span class="sc">+</span> Scruz <span class="sc">+</span> Adjacent, <span class="at">data =</span> gala)</span></code></pre></div>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1045-1"><a href="transformaciones.html#cb1045-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gala_model_cox), <span class="fu">resid</span>(gala_model_cox), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1045-2"><a href="transformaciones.html#cb1045-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1045-3"><a href="transformaciones.html#cb1045-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-473-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>¡La gráfica resultante de ajustados versus residuales se ve mucho mejor!</p>
<p>Por último, volvemos a los datos de <code>initech</code> y al modelo <code>initech_fit</code> que habíamos usado anteriormente. Recuerde que este era el modelo sin transformar y que usamos una transformación <span class="math inline">\(\log\)</span> para arreglarlo.</p>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1046-1"><a href="transformaciones.html#cb1046-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(initech_fit)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-474-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Usando el método Box-Cox, vemos que <span class="math inline">\(\lambda=0\)</span> está tanto en el intervalo como muy cerca del máximo, lo que sugiere una transformación de la forma</p>
<p><span class="math display">\[
  \log(y).
\]</span></p>
<p>¡Entonces el método Box-Cox justifica nuestra elección previa de una transformación <span class="math inline">\(\log\)</span>!</p>
</div>
</div>
<div id="transformación-del-predictor" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Transformación del predictor</h2>
<p>Además de la transformación de la variable de respuesta, también podemos considerar transformaciones de variables predictoras. A veces, estas transformaciones pueden ayudar con la violación de los supuestos del modelo, y otras veces se pueden usar para simplemente adaptarse a un modelo más flexible.</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1047-1"><a href="transformaciones.html#cb1047-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(autompg)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    383 obs. of  9 variables:
##  $ mpg     : num  18 15 18 16 17 15 14 14 14 15 ...
##  $ cyl     : Factor w/ 3 levels &quot;4&quot;,&quot;6&quot;,&quot;8&quot;: 3 3 3 3 3 3 3 3 3 3 ...
##  $ disp    : num  307 350 318 304 302 429 454 440 455 390 ...
##  $ hp      : num  130 165 150 150 140 198 220 215 225 190 ...
##  $ wt      : num  3504 3693 3436 3433 3449 ...
##  $ acc     : num  12 11.5 11 12 10.5 10 9 8.5 10 8.5 ...
##  $ year    : int  70 70 70 70 70 70 70 70 70 70 ...
##  $ origin  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ domestic: num  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>Recuerde el conjunto de datos <code>autompg</code> del capítulo anterior. Aquí intentaremos modelar <code>mpg</code> en función de <code>hp</code>.</p>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1049-1"><a href="transformaciones.html#cb1049-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1049-2"><a href="transformaciones.html#cb1049-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1049-3"><a href="transformaciones.html#cb1049-3" aria-hidden="true" tabindex="-1"></a>mpg_hp <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> autompg)</span>
<span id="cb1049-4"><a href="transformaciones.html#cb1049-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mpg_hp, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1049-5"><a href="transformaciones.html#cb1049-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp), <span class="fu">resid</span>(mpg_hp), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1049-6"><a href="transformaciones.html#cb1049-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1049-7"><a href="transformaciones.html#cb1049-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-477-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Primero intentamos SLR, pero vemos un patrón bastante obvio en la gráfica de ajustados versus residuales, que incluye una varianza creciente, por lo que intentamos una transformación <span class="math inline">\(\log\)</span> de la respuesta</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="transformaciones.html#cb1050-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1050-2"><a href="transformaciones.html#cb1050-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> hp, <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1050-3"><a href="transformaciones.html#cb1050-3" aria-hidden="true" tabindex="-1"></a>mpg_hp_log <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> hp, <span class="at">data =</span> autompg)</span>
<span id="cb1050-4"><a href="transformaciones.html#cb1050-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mpg_hp_log, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1050-5"><a href="transformaciones.html#cb1050-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp_log), <span class="fu">resid</span>(mpg_hp_log), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1050-6"><a href="transformaciones.html#cb1050-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1050-7"><a href="transformaciones.html#cb1050-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-478-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Después de realizar la transformación <span class="math inline">\(\log\)</span> de la respuesta, todavía tenemos algunos de los mismos problemas con la los ajustados versus respuesta. Ahora, intentaremos también <span class="math inline">\(\log\)</span> para transformar el <strong>predictor</strong>.</p>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1051-1"><a href="transformaciones.html#cb1051-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1051-2"><a href="transformaciones.html#cb1051-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(hp), <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1051-3"><a href="transformaciones.html#cb1051-3" aria-hidden="true" tabindex="-1"></a>mpg_hp_loglog <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(hp), <span class="at">data =</span> autompg)</span>
<span id="cb1051-4"><a href="transformaciones.html#cb1051-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mpg_hp_loglog, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1051-5"><a href="transformaciones.html#cb1051-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp_loglog), <span class="fu">resid</span>(mpg_hp_loglog), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1051-6"><a href="transformaciones.html#cb1051-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1051-7"><a href="transformaciones.html#cb1051-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-479-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Aquí, nuestra gráfica de ajustados versus residuales se ve bien.</p>
<div id="polinomios" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Polinomios</h3>
<p>Otra “transformación” muy común de una variable predictora es el uso de transformaciones polinomiales. Son extremadamente útiles ya que permiten modelos más flexibles, pero no cambian las unidades de las variables.</p>
<p>No debería sorprender que las ventas de un producto estén relacionadas con el presupuesto publicitario del producto, pero hay rendimientos decrecientes. Una empresa no siempre puede esperar rendimientos lineales basados en un mayor presupuesto publicitario.</p>
<p>Considere los datos mensuales de las ventas de widgets <em>Initech </em>, <span class="math inline">\(y\)</span>, en función del gasto publicitario de <em>Initech</em> para dicho widget, <span class="math inline">\(x\)</span>, ambos por cada diez mil dólares. Los datos se pueden encontrar en <a href="data/marketing.csv"><code>marketing.csv</code></a>.</p>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1052-1"><a href="transformaciones.html#cb1052-1" aria-hidden="true" tabindex="-1"></a>marketing <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/marketing.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="transformaciones.html#cb1053-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> advert, <span class="at">data =</span> marketing, </span>
<span id="cb1053-2"><a href="transformaciones.html#cb1053-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Gasto publicitario (* $100,00)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Ventas (* $100,00)&quot;</span>,</span>
<span id="cb1053-3"><a href="transformaciones.html#cb1053-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-481-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nos gustaría ajustarnos al modelo,</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \epsilon_i
\]</span></p>
<p>donde <span class="math inline">\(\epsilon_i \sim N(0,\sigma^2)\)</span> para <span class="math inline">\(i = 1, 2, \cdots 21.\)</span></p>
<p>La respuesta <span class="math inline">\(y\)</span> ahora es una función <strong>lineal</strong> de “dos” variables que permiten que <span class="math inline">\(y\)</span> sea una función no lineal del predictor único original <span class="math inline">\(x\)</span>. Consideramos que esto es una transformación, aunque en cierto sentido hemos agregado otro predictor.</p>
<p>Por lo tanto, nuestra matriz <span class="math inline">\(X\)</span> es,</p>
<p><span class="math display">\[
  \begin{bmatrix}
  1      &amp; x_1 &amp; x_1^2    \\[3pt]
  1      &amp; x_2  &amp; x_2^2   \\[3pt]
  1      &amp; x_3  &amp; x_3^2   \\[3pt]
  \vdots &amp; \vdots &amp; \vdots \\[3pt]
  1      &amp; x_{n}  &amp; x_{n}^2   \\
  \end{bmatrix}
\]</span></p>
<p>Luego podemos proceder a ajustar el modelo como lo hicimos en el pasado para la regresión lineal múltiple.</p>
<p><span class="math display">\[
\hat{\beta} = \left(  X^\top X  \right)^{-1}X^\top y.
\]</span></p>
<p>Nuestras estimaciones tendrán las propiedades habituales. La media sigue</p>
<p><span class="math display">\[
E[\hat{\beta}] = \beta,
\]</span></p>
<p>y varianza</p>
<p><span class="math display">\[
\text{Var}[\hat{\beta}] = \sigma^2 \left(  X^\top X  \right)^{-1}.
\]</span></p>
<p>También mantenemos los mismos resultados distribucionales</p>
<p><span class="math display">\[
\hat{\beta}_j \sim N\left(\beta_j, \sigma^2 C_{jj}  \right).
\]</span></p>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1054-1"><a href="transformaciones.html#cb1054-1" aria-hidden="true" tabindex="-1"></a>mark_mod <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> advert, <span class="at">data =</span> marketing)</span>
<span id="cb1054-2"><a href="transformaciones.html#cb1054-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mark_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advert, data = marketing)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7845 -1.4762 -0.5103  1.2361  3.1869 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.4502     0.6806   13.88 2.13e-11 ***
## advert        1.1918     0.0937   12.72 9.65e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.907 on 19 degrees of freedom
## Multiple R-squared:  0.8949, Adjusted R-squared:  0.8894 
## F-statistic: 161.8 on 1 and 19 DF,  p-value: 9.646e-11</code></pre>
<p>Si bien el modelo SLR es significativo, la gráfica de ajustados versus residuales tendría un patrón muy claro.</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="transformaciones.html#cb1056-1" aria-hidden="true" tabindex="-1"></a>mark_mod_poly2 <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> advert <span class="sc">+</span> <span class="fu">I</span>(advert <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> marketing)</span>
<span id="cb1056-2"><a href="transformaciones.html#cb1056-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mark_mod_poly2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advert + I(advert^2), data = marketing)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9175 -0.8333 -0.1948  0.9292  2.1385 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.76161    0.67219  10.059 8.16e-09 ***
## advert       2.46231    0.24830   9.917 1.02e-08 ***
## I(advert^2) -0.08745    0.01658  -5.275 5.14e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.228 on 18 degrees of freedom
## Multiple R-squared:  0.9587, Adjusted R-squared:  0.9541 
## F-statistic:   209 on 2 and 18 DF,  p-value: 3.486e-13</code></pre>
<p>Para agregar el término de segundo orden, necesitamos usar la función <code>I()</code> en la especificación del modelo alrededor de nuestro predictor recién creado. Vemos que con el término de primer orden en el modelo, el término cuadrático también es significativo.</p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="transformaciones.html#cb1058-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(marketing<span class="sc">$</span>advert)</span>
<span id="cb1058-2"><a href="transformaciones.html#cb1058-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), marketing<span class="sc">$</span>advert, marketing<span class="sc">$</span>advert <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb1058-3"><a href="transformaciones.html#cb1058-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code></pre></div>
<pre><code>##         [,1]     [,2]      [,3]
## [1,]   21.00   120.70   1107.95
## [2,]  120.70  1107.95  12385.86
## [3,] 1107.95 12385.86 151369.12</code></pre>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="transformaciones.html#cb1060-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> marketing<span class="sc">$</span>sales</span></code></pre></div>
<pre><code>##             [,1]
## [1,]  6.76161045
## [2,]  2.46230964
## [3,] -0.08745394</code></pre>
<p>Aquí verificamos que las estimaciones de los parámetros se encontraron como era de esperar.</p>
<p>También podríamos agregar términos de orden superior, como un predictor de tercer grado. Esto es fácil de hacer. Nuestra matriz <span class="math inline">\(X\)</span> simplemente se vuelve más grande nuevamente.</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \beta_3 x_i^3 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
  \begin{bmatrix}
  1      &amp; x_1 &amp; x_1^2  &amp; x_1^3    \\[3pt]
  1      &amp; x_2  &amp; x_2^2  &amp; x_2^3   \\[3pt]
  1      &amp; x_3  &amp; x_3^2  &amp; x_3^3   \\[3pt]
  \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\[3pt]
  1      &amp; x_{n}  &amp; x_{n}^2  &amp; x_{n}^3    \\
  \end{bmatrix}
\]</span></p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1062-1"><a href="transformaciones.html#cb1062-1" aria-hidden="true" tabindex="-1"></a>mark_mod_poly3 <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> advert <span class="sc">+</span> <span class="fu">I</span>(advert <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(advert <span class="sc">^</span> <span class="dv">3</span>), <span class="at">data =</span> marketing)</span>
<span id="cb1062-2"><a href="transformaciones.html#cb1062-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mark_mod_poly3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ advert + I(advert^2) + I(advert^3), data = marketing)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.44322 -0.61310 -0.01527  0.68131  1.22517 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.890070   0.761956   5.105 8.79e-05 ***
## advert       4.681864   0.501032   9.344 4.14e-08 ***
## I(advert^2) -0.455152   0.078977  -5.763 2.30e-05 ***
## I(advert^3)  0.016131   0.003429   4.704 0.000205 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8329 on 17 degrees of freedom
## Multiple R-squared:  0.9821, Adjusted R-squared:  0.9789 
## F-statistic: 310.2 on 3 and 17 DF,  p-value: 4.892e-15</code></pre>
<p>Ahora vemos que con los términos de primer y segundo orden en el modelo, el término de tercer orden también es significativo. ¿Pero esto tiene sentido en la práctica? El siguiente gráfico debería dar pistas sobre por qué no es así. (¡El modelo con el término de tercer orden no tiene rendimientos decrecientes!)</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="transformaciones.html#cb1064-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> advert, <span class="at">data =</span> marketing, </span>
<span id="cb1064-2"><a href="transformaciones.html#cb1064-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Gasto publicitario (* $100,00)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Ventas (* $100,00)&quot;</span>,</span>
<span id="cb1064-3"><a href="transformaciones.html#cb1064-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb1064-4"><a href="transformaciones.html#cb1064-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mark_mod, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1064-5"><a href="transformaciones.html#cb1064-5" aria-hidden="true" tabindex="-1"></a>xplot <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">16</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb1064-6"><a href="transformaciones.html#cb1064-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(mark_mod_poly2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">advert =</span> xplot)),</span>
<span id="cb1064-7"><a href="transformaciones.html#cb1064-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1064-8"><a href="transformaciones.html#cb1064-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(mark_mod_poly3, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">advert =</span> xplot)),</span>
<span id="cb1064-9"><a href="transformaciones.html#cb1064-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-486-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>El gráfico anterior se realizó utilizando gráficos base en “R”. El siguiente gráfico se hizo usando el paquete <a href="http://ggplot2.org/" target="_blank"><code>ggplot2</code></a>, un método de graficación cada vez más popular en <code>R</code>.</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="transformaciones.html#cb1065-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1065-2"><a href="transformaciones.html#cb1065-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> marketing, <span class="fu">aes</span>(<span class="at">x =</span> advert, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb1065-3"><a href="transformaciones.html#cb1065-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb1065-4"><a href="transformaciones.html#cb1065-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1065-5"><a href="transformaciones.html#cb1065-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>)<span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb1065-6"><a href="transformaciones.html#cb1065-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-487-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Tenga en cuenta que podríamos ajustar un polinomio de un orden arbitrario,</p>
<p><span class="math display">\[
  Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \cdots + \beta_{p-1}x_i^{p-1} + \epsilon_i
\]</span></p>
<p>Sin embargo, debemos tener cuidado con el ajuste excesivo, ya que con un polinomio de un grado menor que el número de observaciones, a veces es posible ajustar un modelo perfectamente.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1066-1"><a href="transformaciones.html#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1066-2"><a href="transformaciones.html#cb1066-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1066-3"><a href="transformaciones.html#cb1066-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">3</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">11</span>, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb1066-4"><a href="transformaciones.html#cb1066-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">300</span>, <span class="dv">400</span>), <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb1066-5"><a href="transformaciones.html#cb1066-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb1066-6"><a href="transformaciones.html#cb1066-6" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(fit)</span></span>
<span id="cb1066-7"><a href="transformaciones.html#cb1066-7" aria-hidden="true" tabindex="-1"></a>fit_perf <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">6</span>)</span>
<span id="cb1066-8"><a href="transformaciones.html#cb1066-8" aria-hidden="true" tabindex="-1"></a>               <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">9</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">10</span>))</span>
<span id="cb1066-9"><a href="transformaciones.html#cb1066-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_perf)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + 
##     I(x^7) + I(x^8) + I(x^9) + I(x^10))
## 
## Residuals:
## ALL 11 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.114e+01         NA      NA       NA
## x           -1.918e+03         NA      NA       NA
## I(x^2)       4.969e+03         NA      NA       NA
## I(x^3)      -4.932e+03         NA      NA       NA
## I(x^4)       2.581e+03         NA      NA       NA
## I(x^5)      -8.035e+02         NA      NA       NA
## I(x^6)       1.570e+02         NA      NA       NA
## I(x^7)      -1.947e+01         NA      NA       NA
## I(x^8)       1.490e+00         NA      NA       NA
## I(x^9)      -6.424e-02         NA      NA       NA
## I(x^10)      1.195e-03         NA      NA       NA
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:    NaN 
## F-statistic:   NaN on 10 and 0 DF,  p-value: NA</code></pre>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1068-1"><a href="transformaciones.html#cb1068-1" aria-hidden="true" tabindex="-1"></a>xplot <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1068-2"><a href="transformaciones.html#cb1068-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xplot)),</span>
<span id="cb1068-3"><a href="transformaciones.html#cb1068-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1068-4"><a href="transformaciones.html#cb1068-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(fit_perf, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xplot)),</span>
<span id="cb1068-5"><a href="transformaciones.html#cb1068-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-488-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Observe que en el resumen, <code>R</code> no pudo calcular los errores estándar. Este es el resultado de estar “fuera” de los grados de libertad. Con 11 parámetros <span class="math inline">\(\beta\)</span> y 11 puntos de datos, usamos todos los grados de libertad antes de poder estimar <span class="math inline">\(\sigma\)</span>.</p>
<p>En este ejemplo, la verdadera relación es cuadrática, pero el ajuste del polinomio de orden 10 es “perfecto”. En el próximo capítulo nos centraremos en el compromiso entre bondad de ajuste (minimización de errores) y complejidad del modelo.</p>
<p>Suponga que trabaja para un fabricante de automóviles que fabrica un gran sedán de lujo. Le gustaría saber cómo funciona el automóvil desde el punto de vista de la eficiencia del combustible cuando se conduce a varias velocidades. En lugar de probar el automóvil a todas las velocidades imaginables (lo que sería imposible), crea un experimento en el que el automóvil se conduce a velocidades de interés en incrementos de 5 millas por hora.</p>
<p>Nuestro objetivo, entonces, es ajustar un modelo a estos datos para poder predecir la eficiencia del combustible al conducir a ciertas velocidades. Los datos de este ejemplo se pueden encontrar en <a href="data/fuel_econ.csv"><code>fuel_econ.csv</code></a>.</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="transformaciones.html#cb1069-1" aria-hidden="true" tabindex="-1"></a>econ <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/fuel_econ.csv&quot;</span>)</span></code></pre></div>
<p>En este ejemplo, con frecuencia buscaremos una gráfica de ajustados versus residuales, por lo que <em>deberíamos</em> escribir una función para hacer nuestra vida más fácil, pero esto se deja como un ejercicio de tarea.</p>
<p>También agregaremos curvas ajustadas a los graficos de dispersión repetidamente, así que, de manera inteligente, escribiremos una función para hacerlo.</p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="transformaciones.html#cb1070-1" aria-hidden="true" tabindex="-1"></a>plot_econ_curve <span class="ot">=</span> <span class="cf">function</span>(model){</span>
<span id="cb1070-2"><a href="transformaciones.html#cb1070-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(mpg <span class="sc">~</span> mph, <span class="at">data =</span> econ, <span class="at">xlab =</span> <span class="st">&quot;Velocidad (millas por hora)&quot;</span>, </span>
<span id="cb1070-3"><a href="transformaciones.html#cb1070-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Eficiencia de combustible (millas por galón)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, </span>
<span id="cb1070-4"><a href="transformaciones.html#cb1070-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1070-5"><a href="transformaciones.html#cb1070-5" aria-hidden="true" tabindex="-1"></a>  xplot <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">75</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1070-6"><a href="transformaciones.html#cb1070-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(xplot, <span class="fu">predict</span>(model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">mph =</span> xplot)),</span>
<span id="cb1070-7"><a href="transformaciones.html#cb1070-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1070-8"><a href="transformaciones.html#cb1070-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Así que ahora primero ajustamos una regresión lineal simple a estos datos.</p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="transformaciones.html#cb1071-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph, <span class="at">data =</span> econ)</span></code></pre></div>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1072-1"><a href="transformaciones.html#cb1072-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1072-2"><a href="transformaciones.html#cb1072-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit1)</span>
<span id="cb1072-3"><a href="transformaciones.html#cb1072-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit1), <span class="fu">resid</span>(fit1), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, </span>
<span id="cb1072-4"><a href="transformaciones.html#cb1072-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1072-5"><a href="transformaciones.html#cb1072-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-492-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Claramente podemos hacerlo mejor. Sí, la eficiencia del combustible aumenta a medida que aumenta la velocidad, pero solo hasta cierto punto.</p>
<p>Ahora agregaremos términos polinomiales hasta que encajemos en un ajuste adecuado.</p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="transformaciones.html#cb1073-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> econ)</span>
<span id="cb1073-2"><a href="transformaciones.html#cb1073-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2), data = econ)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8411 -0.9694  0.0017  1.0181  3.3900 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.4444505  1.4241091   1.716   0.0984 .  
## mph          1.2716937  0.0757321  16.792 3.99e-15 ***
## I(mph^2)    -0.0145014  0.0008719 -16.633 4.97e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.663 on 25 degrees of freedom
## Multiple R-squared:  0.9188, Adjusted R-squared:  0.9123 
## F-statistic: 141.5 on 2 and 25 DF,  p-value: 2.338e-14</code></pre>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1075-1"><a href="transformaciones.html#cb1075-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1075-2"><a href="transformaciones.html#cb1075-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit2)</span>
<span id="cb1075-3"><a href="transformaciones.html#cb1075-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit2), <span class="fu">resid</span>(fit2), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, </span>
<span id="cb1075-4"><a href="transformaciones.html#cb1075-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1075-5"><a href="transformaciones.html#cb1075-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-494-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Si bien este modelo claramente se ajusta mucho mejor, y el término de segundo orden es significativo, todavía vemos un patrón en la gráfica ajustada versus residual que sugiere que los términos de orden superior ayudarán. Además, esperaríamos que la curva se aplana a medida que aumenta o disminuye la velocidad, no que descienda bruscamente como vemos aquí.</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="transformaciones.html#cb1076-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">3</span>), <span class="at">data =</span> econ)</span>
<span id="cb1076-2"><a href="transformaciones.html#cb1076-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3), data = econ)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8112 -0.9677  0.0264  1.0345  3.3827 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.258e+00  2.768e+00   0.816   0.4227    
## mph          1.291e+00  2.529e-01   5.103  3.2e-05 ***
## I(mph^2)    -1.502e-02  6.604e-03  -2.274   0.0322 *  
## I(mph^3)     4.066e-06  5.132e-05   0.079   0.9375    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.697 on 24 degrees of freedom
## Multiple R-squared:  0.9188, Adjusted R-squared:  0.9087 
## F-statistic: 90.56 on 3 and 24 DF,  p-value: 3.17e-13</code></pre>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="transformaciones.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1078-2"><a href="transformaciones.html#cb1078-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit3)</span>
<span id="cb1078-3"><a href="transformaciones.html#cb1078-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit3), <span class="fu">resid</span>(fit3), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, </span>
<span id="cb1078-4"><a href="transformaciones.html#cb1078-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1078-5"><a href="transformaciones.html#cb1078-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-496-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Agregar el término de tercer orden no parece ayudar en absoluto. La curva ajustada apenas cambia. Esto tiene sentido, ya que lo que nos gustaría es que la curva se aplanara en los extremos. Para ello necesitaremos un término polinomial de grado par.</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1079-1"><a href="transformaciones.html#cb1079-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">4</span>), <span class="at">data =</span> econ)</span>
<span id="cb1079-2"><a href="transformaciones.html#cb1079-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4), data = econ)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.57410 -0.60308  0.04236  0.74481  1.93038 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.146e+01  2.965e+00   7.238 2.28e-07 ***
## mph         -1.468e+00  3.913e-01  -3.751  0.00104 ** 
## I(mph^2)     1.081e-01  1.673e-02   6.463 1.35e-06 ***
## I(mph^3)    -2.130e-03  2.844e-04  -7.488 1.31e-07 ***
## I(mph^4)     1.255e-05  1.665e-06   7.539 1.17e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9307 on 23 degrees of freedom
## Multiple R-squared:  0.9766, Adjusted R-squared:  0.9726 
## F-statistic: 240.2 on 4 and 23 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1081-1"><a href="transformaciones.html#cb1081-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1081-2"><a href="transformaciones.html#cb1081-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit4)</span>
<span id="cb1081-3"><a href="transformaciones.html#cb1081-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit4), <span class="fu">resid</span>(fit4), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, </span>
<span id="cb1081-4"><a href="transformaciones.html#cb1081-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1081-5"><a href="transformaciones.html#cb1081-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-498-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Ahora estamos progresando. El término de cuarto orden es significativo con los demás términos del modelo. También estamos empezando a ver lo que esperábamos para baja y alta velocidad. Sin embargo, todavía parece haber un patrón en los residuos, por lo que volveremos a intentar términos de orden superior. Sumaremos el quinto y el sexto juntos, ya que sumar el quinto será similar a sumar el tercero.</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="transformaciones.html#cb1082-1" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(mph<span class="sc">^</span><span class="dv">6</span>), <span class="at">data =</span> econ)</span>
<span id="cb1082-2"><a href="transformaciones.html#cb1082-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit6)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + 
##     I(mph^6), data = econ)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1129 -0.5717 -0.1707  0.5026  1.5288 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -4.206e+00  1.204e+01  -0.349   0.7304  
## mph          4.203e+00  2.553e+00   1.646   0.1146  
## I(mph^2)    -3.521e-01  2.012e-01  -1.750   0.0947 .
## I(mph^3)     1.579e-02  7.691e-03   2.053   0.0527 .
## I(mph^4)    -3.473e-04  1.529e-04  -2.271   0.0338 *
## I(mph^5)     3.585e-06  1.518e-06   2.362   0.0279 *
## I(mph^6)    -1.402e-08  5.941e-09  -2.360   0.0280 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8657 on 21 degrees of freedom
## Multiple R-squared:  0.9815, Adjusted R-squared:  0.9762 
## F-statistic:   186 on 6 and 21 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="transformaciones.html#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1084-2"><a href="transformaciones.html#cb1084-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit6)</span>
<span id="cb1084-3"><a href="transformaciones.html#cb1084-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit6), <span class="fu">resid</span>(fit6), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, </span>
<span id="cb1084-4"><a href="transformaciones.html#cb1084-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1084-5"><a href="transformaciones.html#cb1084-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-500-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Nuevamente, el término de sexto orden es significativo con los otros términos del modelo y aquí vemos menos patrón en el gráfico de residuos. Probemos ahora cuál de los dos modelos anteriores preferimos. Vamos a probar</p>
<p><span class="math display">\[
H_0: \beta_5 = \beta_6 = 0.
\]</span></p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="transformaciones.html#cb1085-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit4, fit6)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4)
## Model 2: mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + I(mph^6)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)  
## 1     23 19.922                             
## 2     21 15.739  2    4.1828 2.7905 0.0842 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Entonces, esta prueba no rechaza la hipótesis nula a un nivel de significancia de <span class="math inline">\(\alpha=0.05\)</span>, sin embargo, el valor p es todavía bastante pequeño, y la gráfica ajustada versus residual es mucho mejor para el modelo con el término de sexto orden. Esto hace que el modelo de sexto orden sea una buena elección. Podríamos repetir este proceso una vez más.</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="transformaciones.html#cb1087-1" aria-hidden="true" tabindex="-1"></a>fit8 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> mph <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">5</span>)</span>
<span id="cb1087-2"><a href="transformaciones.html#cb1087-2" aria-hidden="true" tabindex="-1"></a>          <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(mph <span class="sc">^</span> <span class="dv">8</span>), <span class="at">data =</span> econ)</span>
<span id="cb1087-3"><a href="transformaciones.html#cb1087-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit8)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + 
##     I(mph^6) + I(mph^7) + I(mph^8), data = econ)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.21938 -0.50464 -0.09105  0.49029  1.45440 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -1.202e+01  7.045e+01  -0.171    0.866
## mph          6.021e+00  2.014e+01   0.299    0.768
## I(mph^2)    -5.037e-01  2.313e+00  -0.218    0.830
## I(mph^3)     2.121e-02  1.408e-01   0.151    0.882
## I(mph^4)    -4.008e-04  5.017e-03  -0.080    0.937
## I(mph^5)     1.789e-06  1.080e-04   0.017    0.987
## I(mph^6)     4.486e-08  1.381e-06   0.032    0.974
## I(mph^7)    -6.456e-10  9.649e-09  -0.067    0.947
## I(mph^8)     2.530e-12  2.835e-11   0.089    0.930
## 
## Residual standard error: 0.9034 on 19 degrees of freedom
## Multiple R-squared:  0.9818, Adjusted R-squared:  0.9741 
## F-statistic: 128.1 on 8 and 19 DF,  p-value: 7.074e-15</code></pre>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1089-1"><a href="transformaciones.html#cb1089-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1089-2"><a href="transformaciones.html#cb1089-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_econ_curve</span>(fit8)</span>
<span id="cb1089-3"><a href="transformaciones.html#cb1089-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit8), <span class="fu">resid</span>(fit8), <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuals&quot;</span>, </span>
<span id="cb1089-4"><a href="transformaciones.html#cb1089-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span><span class="dv">2</span>)</span>
<span id="cb1089-5"><a href="transformaciones.html#cb1089-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-503-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="transformaciones.html#cb1090-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit8)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + 
##     I(mph^6) + I(mph^7) + I(mph^8), data = econ)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.21938 -0.50464 -0.09105  0.49029  1.45440 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -1.202e+01  7.045e+01  -0.171    0.866
## mph          6.021e+00  2.014e+01   0.299    0.768
## I(mph^2)    -5.037e-01  2.313e+00  -0.218    0.830
## I(mph^3)     2.121e-02  1.408e-01   0.151    0.882
## I(mph^4)    -4.008e-04  5.017e-03  -0.080    0.937
## I(mph^5)     1.789e-06  1.080e-04   0.017    0.987
## I(mph^6)     4.486e-08  1.381e-06   0.032    0.974
## I(mph^7)    -6.456e-10  9.649e-09  -0.067    0.947
## I(mph^8)     2.530e-12  2.835e-11   0.089    0.930
## 
## Residual standard error: 0.9034 on 19 degrees of freedom
## Multiple R-squared:  0.9818, Adjusted R-squared:  0.9741 
## F-statistic: 128.1 on 8 and 19 DF,  p-value: 7.074e-15</code></pre>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="transformaciones.html#cb1092-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit6, fit8)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + I(mph^6)
## Model 2: mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + I(mph^6) + 
##     I(mph^7) + I(mph^8)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     21 15.739                           
## 2     19 15.506  2    0.2324 0.1424 0.8682</code></pre>
<p>Claramente nos quedaríamos con <code>fit6</code>. El término de octavo orden no es significativo con los otros términos del modelo y la prueba F no rechaza.</p>
<p>Aparte, tenga en cuenta que existe una forma más rápida de especificar un modelo con muchos términos de orden superior.</p>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="transformaciones.html#cb1094-1" aria-hidden="true" tabindex="-1"></a>fit6_alt <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(mph, <span class="dv">6</span>), <span class="at">data =</span> econ)</span>
<span id="cb1094-2"><a href="transformaciones.html#cb1094-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">fitted</span>(fit6), <span class="fu">fitted</span>(fit6_alt))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Primero verificamos que este método produce los mismos valores ajustados. Sin embargo, los coeficientes estimados son diferentes.</p>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1096-1"><a href="transformaciones.html#cb1096-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit6)</span></code></pre></div>
<pre><code>##   (Intercept)           mph      I(mph^2)      I(mph^3)      I(mph^4) 
## -4.206224e+00  4.203382e+00 -3.521452e-01  1.579340e-02 -3.472665e-04 
##      I(mph^5)      I(mph^6) 
##  3.585201e-06 -1.401995e-08</code></pre>
<div class="sourceCode" id="cb1098"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1098-1"><a href="transformaciones.html#cb1098-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit6_alt)</span></code></pre></div>
<pre><code>##   (Intercept) poly(mph, 6)1 poly(mph, 6)2 poly(mph, 6)3 poly(mph, 6)4 
##   24.40714286    4.16769628  -27.66685755    0.13446747    7.01671480 
## poly(mph, 6)5 poly(mph, 6)6 
##    0.09288754   -2.04307796</code></pre>
<p>Esto se debe a que <code>poly()</code> usa <em>polinomios ortogonales</em>, lo que resuelve un problema que discutiremos en el próximo capítulo.</p>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="transformaciones.html#cb1100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit6)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ mph + I(mph^2) + I(mph^3) + I(mph^4) + I(mph^5) + 
##     I(mph^6), data = econ)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1129 -0.5717 -0.1707  0.5026  1.5288 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -4.206e+00  1.204e+01  -0.349   0.7304  
## mph          4.203e+00  2.553e+00   1.646   0.1146  
## I(mph^2)    -3.521e-01  2.012e-01  -1.750   0.0947 .
## I(mph^3)     1.579e-02  7.691e-03   2.053   0.0527 .
## I(mph^4)    -3.473e-04  1.529e-04  -2.271   0.0338 *
## I(mph^5)     3.585e-06  1.518e-06   2.362   0.0279 *
## I(mph^6)    -1.402e-08  5.941e-09  -2.360   0.0280 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8657 on 21 degrees of freedom
## Multiple R-squared:  0.9815, Adjusted R-squared:  0.9762 
## F-statistic:   186 on 6 and 21 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1102-1"><a href="transformaciones.html#cb1102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit6_alt)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ poly(mph, 6), data = econ)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1129 -0.5717 -0.1707  0.5026  1.5288 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    24.40714    0.16360 149.184  &lt; 2e-16 ***
## poly(mph, 6)1   4.16770    0.86571   4.814 9.31e-05 ***
## poly(mph, 6)2 -27.66686    0.86571 -31.958  &lt; 2e-16 ***
## poly(mph, 6)3   0.13447    0.86571   0.155    0.878    
## poly(mph, 6)4   7.01671    0.86571   8.105 6.68e-08 ***
## poly(mph, 6)5   0.09289    0.86571   0.107    0.916    
## poly(mph, 6)6  -2.04308    0.86571  -2.360    0.028 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8657 on 21 degrees of freedom
## Multiple R-squared:  0.9815, Adjusted R-squared:  0.9762 
## F-statistic:   186 on 6 and 21 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Sin embargo, tenga en cuenta que el valor p para probar el término de grado 6 es el mismo. Debido a esto, en su mayor parte podemos usar estos indistintamente.</p>
<p>Para usar <code>poly()</code> y obtener los mismos resultados que usar <code>I()</code> repetidamente, necesitaríamos establecer <code>raw = TRUE</code>.</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1104-1"><a href="transformaciones.html#cb1104-1" aria-hidden="true" tabindex="-1"></a>fit6_alt2 <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(mph, <span class="dv">6</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> econ)</span>
<span id="cb1104-2"><a href="transformaciones.html#cb1104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit6_alt2)</span></code></pre></div>
<pre><code>##               (Intercept) poly(mph, 6, raw = TRUE)1 poly(mph, 6, raw = TRUE)2 
##             -4.206224e+00              4.203382e+00             -3.521452e-01 
## poly(mph, 6, raw = TRUE)3 poly(mph, 6, raw = TRUE)4 poly(mph, 6, raw = TRUE)5 
##              1.579340e-02             -3.472665e-04              3.585201e-06 
## poly(mph, 6, raw = TRUE)6 
##             -1.401995e-08</code></pre>
<p>Ahora hemos visto cómo transformar variables de predicción y respuesta. En este capítulo nos hemos centrado principalmente en usar esto en el contexto de la reparación de modelos SLR. Sin embargo, estos conceptos se pueden usar fácilmente junto con variables e interacciones categóricas para construir modelos más grandes y flexibles. En el próximo capítulo, discutiremos cómo elegir un buen modelo de una colección de posibles modelos.</p>
</div>
</div>
<div id="transformaciones-de-respuesta" class="section level2 unnumbered">
<h2>Transformaciones de respuesta</h2>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1106-1"><a href="transformaciones.html#cb1106-1" aria-hidden="true" tabindex="-1"></a>initech <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/initech.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1107-1"><a href="transformaciones.html#cb1107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1107-2"><a href="transformaciones.html#cb1107-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-510-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1108-1"><a href="transformaciones.html#cb1108-1" aria-hidden="true" tabindex="-1"></a>initech_fit <span class="ot">=</span> <span class="fu">lm</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech)</span>
<span id="cb1108-2"><a href="transformaciones.html#cb1108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(initech_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = salary ~ years, data = initech)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -57225 -18104    241  15589  91332 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5302       5750   0.922    0.359    
## years           8637        389  22.200   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 27360 on 98 degrees of freedom
## Multiple R-squared:  0.8341, Adjusted R-squared:  0.8324 
## F-statistic: 492.8 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1110-1"><a href="transformaciones.html#cb1110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1110-2"><a href="transformaciones.html#cb1110-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1110-3"><a href="transformaciones.html#cb1110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(initech_fit, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-512-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1111-1"><a href="transformaciones.html#cb1111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1111-2"><a href="transformaciones.html#cb1111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1111-3"><a href="transformaciones.html#cb1111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(initech_fit), <span class="fu">resid</span>(initech_fit), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1111-4"><a href="transformaciones.html#cb1111-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1111-5"><a href="transformaciones.html#cb1111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1111-6"><a href="transformaciones.html#cb1111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1111-7"><a href="transformaciones.html#cb1111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(initech_fit), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1111-8"><a href="transformaciones.html#cb1111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(initech_fit), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-513-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1112-1"><a href="transformaciones.html#cb1112-1" aria-hidden="true" tabindex="-1"></a>initech_fit_log <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> years, <span class="at">data =</span> initech)</span></code></pre></div>
<p><span class="math display">\[
\log(Y_i) = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb1113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1113-1"><a href="transformaciones.html#cb1113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(salary) <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1113-2"><a href="transformaciones.html#cb1113-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1113-3"><a href="transformaciones.html#cb1113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(initech_fit_log, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-515-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
Y_i = \exp(\beta_0 + \beta_1 x_i) \cdot \exp(\epsilon_i)
\]</span></p>
<div class="sourceCode" id="cb1114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1114-1"><a href="transformaciones.html#cb1114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary <span class="sc">~</span> years, <span class="at">data =</span> initech, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1114-2"><a href="transformaciones.html#cb1114-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Salarios en Initech, por antigüedad&quot;</span>)</span>
<span id="cb1114-3"><a href="transformaciones.html#cb1114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(initech_fit_log<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> initech_fit_log<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x),</span>
<span id="cb1114-4"><a href="transformaciones.html#cb1114-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-516-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1115-1"><a href="transformaciones.html#cb1115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1115-2"><a href="transformaciones.html#cb1115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1115-3"><a href="transformaciones.html#cb1115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(initech_fit_log), <span class="fu">resid</span>(initech_fit_log), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1115-4"><a href="transformaciones.html#cb1115-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1115-5"><a href="transformaciones.html#cb1115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1115-6"><a href="transformaciones.html#cb1115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1115-7"><a href="transformaciones.html#cb1115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(initech_fit_log), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1115-8"><a href="transformaciones.html#cb1115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(initech_fit_log), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-517-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1116-1"><a href="transformaciones.html#cb1116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">resid</span>(initech_fit) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 27080.16</code></pre>
<div class="sourceCode" id="cb1118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1118-1"><a href="transformaciones.html#cb1118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">resid</span>(initech_fit_log) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.1934907</code></pre>
<div class="sourceCode" id="cb1120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1120-1"><a href="transformaciones.html#cb1120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((initech<span class="sc">$</span>salary <span class="sc">-</span> <span class="fu">fitted</span>(initech_fit)) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 27080.16</code></pre>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1122-1"><a href="transformaciones.html#cb1122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((initech<span class="sc">$</span>salary <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">fitted</span>(initech_fit_log))) <span class="sc">^</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 24280.36</code></pre>
</div>
<div id="transformaciones-de-predictores" class="section level2 unnumbered">
<h2>Transformaciones de predictores</h2>
<div id="un-modelo-cuadrático" class="section level3" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Un modelo cuadrático</h3>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1124-1"><a href="transformaciones.html#cb1124-1" aria-hidden="true" tabindex="-1"></a>sim_quad <span class="ot">=</span> <span class="cf">function</span>(<span class="at">sample_size =</span> <span class="dv">500</span>) {</span>
<span id="cb1124-2"><a href="transformaciones.html#cb1124-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">runif</span>(<span class="at">n =</span> sample_size) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb1124-3"><a href="transformaciones.html#cb1124-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb1124-4"><a href="transformaciones.html#cb1124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(x, y)</span>
<span id="cb1124-5"><a href="transformaciones.html#cb1124-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1125-1"><a href="transformaciones.html#cb1125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb1125-2"><a href="transformaciones.html#cb1125-2" aria-hidden="true" tabindex="-1"></a>quad_data <span class="ot">=</span> <span class="fu">sim_quad</span>(<span class="at">sample_size =</span> <span class="dv">200</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1126-1"><a href="transformaciones.html#cb1126-1" aria-hidden="true" tabindex="-1"></a>lin_fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> quad_data)</span>
<span id="cb1126-2"><a href="transformaciones.html#cb1126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = quad_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.363  -7.550  -3.416   8.472  26.181 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -18.3271     1.5494  -11.83   &lt;2e-16 ***
## x            24.8716     0.5343   46.55   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.79 on 198 degrees of freedom
## Multiple R-squared:  0.9163, Adjusted R-squared:  0.9158 
## F-statistic:  2167 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1128-1"><a href="transformaciones.html#cb1128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> quad_data, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1128-2"><a href="transformaciones.html#cb1128-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Datos cuadráticos simulados&quot;</span>)</span>
<span id="cb1128-3"><a href="transformaciones.html#cb1128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lin_fit, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-523-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1129-1"><a href="transformaciones.html#cb1129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1129-2"><a href="transformaciones.html#cb1129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1129-3"><a href="transformaciones.html#cb1129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(lin_fit), <span class="fu">resid</span>(lin_fit), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1129-4"><a href="transformaciones.html#cb1129-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1129-5"><a href="transformaciones.html#cb1129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1129-6"><a href="transformaciones.html#cb1129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1129-7"><a href="transformaciones.html#cb1129-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(lin_fit), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1129-8"><a href="transformaciones.html#cb1129-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(lin_fit), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-524-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb1130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1130-1"><a href="transformaciones.html#cb1130-1" aria-hidden="true" tabindex="-1"></a>quad_fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> quad_data)</span>
<span id="cb1130-2"><a href="transformaciones.html#cb1130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quad_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2), data = quad_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.4167  -3.0581   0.2297   3.1024  12.1256 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.0649     0.9577   3.200   0.0016 ** 
## x            -0.5108     0.8637  -0.591   0.5549    
## I(x^2)        5.0740     0.1667  30.433   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.531 on 197 degrees of freedom
## Multiple R-squared:  0.9853, Adjusted R-squared:  0.9852 
## F-statistic:  6608 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1132-1"><a href="transformaciones.html#cb1132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> quad_data, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1132-2"><a href="transformaciones.html#cb1132-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Datos cuadráticos simulados&quot;</span>)</span>
<span id="cb1132-3"><a href="transformaciones.html#cb1132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(quad_fit<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> quad_fit<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x <span class="sc">+</span> quad_fit<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb1132-4"><a href="transformaciones.html#cb1132-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-526-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1133-1"><a href="transformaciones.html#cb1133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1133-2"><a href="transformaciones.html#cb1133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1133-3"><a href="transformaciones.html#cb1133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(quad_fit), <span class="fu">resid</span>(quad_fit), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1133-4"><a href="transformaciones.html#cb1133-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1133-5"><a href="transformaciones.html#cb1133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1133-6"><a href="transformaciones.html#cb1133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1133-7"><a href="transformaciones.html#cb1133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(quad_fit), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1133-8"><a href="transformaciones.html#cb1133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(quad_fit), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-527-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="sobreajuste-y-extrapolación" class="section level3" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Sobreajuste y extrapolación</h3>
<div class="sourceCode" id="cb1134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1134-1"><a href="transformaciones.html#cb1134-1" aria-hidden="true" tabindex="-1"></a>sim_for_perf <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb1134-2"><a href="transformaciones.html#cb1134-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1134-3"><a href="transformaciones.html#cb1134-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="dv">3</span> <span class="sc">+</span> x <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">25</span>)</span>
<span id="cb1134-4"><a href="transformaciones.html#cb1134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(x, y)</span>
<span id="cb1134-5"><a href="transformaciones.html#cb1134-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1135-1"><a href="transformaciones.html#cb1135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1135-2"><a href="transformaciones.html#cb1135-2" aria-hidden="true" tabindex="-1"></a>data_for_perf <span class="ot">=</span> <span class="fu">sim_for_perf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb1136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1136-1"><a href="transformaciones.html#cb1136-1" aria-hidden="true" tabindex="-1"></a>fit_correct <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> data_for_perf)</span>
<span id="cb1136-2"><a href="transformaciones.html#cb1136-2" aria-hidden="true" tabindex="-1"></a>fit_perfect <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb1136-3"><a href="transformaciones.html#cb1136-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">9</span>) <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">10</span>), </span>
<span id="cb1136-4"><a href="transformaciones.html#cb1136-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data_for_perf)</span></code></pre></div>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1137-1"><a href="transformaciones.html#cb1137-1" aria-hidden="true" tabindex="-1"></a>x_plot <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1137-2"><a href="transformaciones.html#cb1137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_for_perf, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">450</span>, <span class="dv">100</span>), <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb1137-3"><a href="transformaciones.html#cb1137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_plot, <span class="fu">predict</span>(fit_correct, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_plot)),</span>
<span id="cb1137-4"><a href="transformaciones.html#cb1137-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1137-5"><a href="transformaciones.html#cb1137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_plot, <span class="fu">predict</span>(fit_perfect, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_plot)),</span>
<span id="cb1137-6"><a href="transformaciones.html#cb1137-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-531-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="comparación-de-modelos-polinomiales" class="section level3" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> Comparación de modelos polinomiales</h3>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="transformaciones.html#cb1138-1" aria-hidden="true" tabindex="-1"></a>sim_higher <span class="ot">=</span> <span class="cf">function</span>(<span class="at">sample_size =</span> <span class="dv">250</span>) {</span>
<span id="cb1138-2"><a href="transformaciones.html#cb1138-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">runif</span>(<span class="at">n =</span> sample_size, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb1138-3"><a href="transformaciones.html#cb1138-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="dv">3</span> <span class="sc">+</span> <span class="sc">-</span><span class="dv">6</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x <span class="sc">^</span> <span class="dv">4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb1138-4"><a href="transformaciones.html#cb1138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(x, y)</span>
<span id="cb1138-5"><a href="transformaciones.html#cb1138-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \beta_3 x_i^3 + \beta_4 x_i^4 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \beta_3 x_i^3 + \beta_4 x_i^4 + \beta_5 x_i^5 + \beta_6 x_i^6 + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb1139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1139-1"><a href="transformaciones.html#cb1139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1139-2"><a href="transformaciones.html#cb1139-2" aria-hidden="true" tabindex="-1"></a>data_higher <span class="ot">=</span> <span class="fu">sim_higher</span>()</span></code></pre></div>
<div class="sourceCode" id="cb1140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1140-1"><a href="transformaciones.html#cb1140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_higher, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1140-2"><a href="transformaciones.html#cb1140-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Datos cuarticos simulados&quot;</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-534-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="transformaciones.html#cb1141-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">data =</span> data_higher)</span>
<span id="cb1141-2"><a href="transformaciones.html#cb1141-2" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">4</span>), <span class="at">data =</span> data_higher)</span></code></pre></div>
<div class="sourceCode" id="cb1142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1142-1"><a href="transformaciones.html#cb1142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_higher, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb1142-2"><a href="transformaciones.html#cb1142-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Datos cuarticos simulados&quot;</span>)</span>
<span id="cb1142-3"><a href="transformaciones.html#cb1142-3" aria-hidden="true" tabindex="-1"></a>x_plot <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb1142-4"><a href="transformaciones.html#cb1142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_plot, <span class="fu">predict</span>(fit_2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_plot)),</span>
<span id="cb1142-5"><a href="transformaciones.html#cb1142-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1142-6"><a href="transformaciones.html#cb1142-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_plot, <span class="fu">predict</span>(fit_4, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_plot)),</span>
<span id="cb1142-7"><a href="transformaciones.html#cb1142-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-536-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="transformaciones.html#cb1143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1143-2"><a href="transformaciones.html#cb1143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1143-3"><a href="transformaciones.html#cb1143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit_2), <span class="fu">resid</span>(fit_2), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1143-4"><a href="transformaciones.html#cb1143-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1143-5"><a href="transformaciones.html#cb1143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1143-6"><a href="transformaciones.html#cb1143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1143-7"><a href="transformaciones.html#cb1143-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(fit_2), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1143-8"><a href="transformaciones.html#cb1143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(fit_2), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-537-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1144-1"><a href="transformaciones.html#cb1144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1144-2"><a href="transformaciones.html#cb1144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1144-3"><a href="transformaciones.html#cb1144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit_4), <span class="fu">resid</span>(fit_4), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb1144-4"><a href="transformaciones.html#cb1144-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Ajustados versus Residuales&quot;</span>)</span>
<span id="cb1144-5"><a href="transformaciones.html#cb1144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1144-6"><a href="transformaciones.html#cb1144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1144-7"><a href="transformaciones.html#cb1144-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(fit_4), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1144-8"><a href="transformaciones.html#cb1144-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(fit_4), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-538-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="transformaciones.html#cb1145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_2, fit_4)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ poly(x, 2)
## Model 2: y ~ poly(x, 4)
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    247 2334.1                                  
## 2    245 1912.6  2    421.51 26.997 2.536e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="transformaciones.html#cb1147-1" aria-hidden="true" tabindex="-1"></a>fit_6 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">6</span>), <span class="at">data =</span> data_higher)</span></code></pre></div>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="transformaciones.html#cb1148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_4, fit_6)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ poly(x, 4)
## Model 2: y ~ poly(x, 6)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    245 1912.6                           
## 2    243 1904.4  2    8.1889 0.5224 0.5937</code></pre>
</div>
<div id="poly-función-y-polinomios-ortogonales" class="section level3" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> <code>poly()</code> Función y polinomios ortogonales</h3>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \beta_3 x_i^3 + \beta_4 x_i^4 + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="transformaciones.html#cb1150-1" aria-hidden="true" tabindex="-1"></a>fit_4a <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> <span class="dv">4</span>), <span class="at">data =</span> data_higher)</span>
<span id="cb1150-2"><a href="transformaciones.html#cb1150-2" aria-hidden="true" tabindex="-1"></a>fit_4b <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> <span class="dv">4</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> data_higher)</span>
<span id="cb1150-3"><a href="transformaciones.html#cb1150-3" aria-hidden="true" tabindex="-1"></a>fit_4c <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), <span class="at">data =</span> data_higher)</span></code></pre></div>
<div class="sourceCode" id="cb1151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1151-1"><a href="transformaciones.html#cb1151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_4a)</span></code></pre></div>
<pre><code>##          (Intercept) poly(x, degree = 4)1 poly(x, degree = 4)2 
##            -1.980036            -2.053929           -49.344752 
## poly(x, degree = 4)3 poly(x, degree = 4)4 
##             0.669874            20.519759</code></pre>
<div class="sourceCode" id="cb1153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1153-1"><a href="transformaciones.html#cb1153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_4b)</span></code></pre></div>
<pre><code>##                      (Intercept) poly(x, degree = 4, raw = TRUE)1 
##                        2.9996256                       -0.3880250 
## poly(x, degree = 4, raw = TRUE)2 poly(x, degree = 4, raw = TRUE)3 
##                       -6.1511166                        0.1269046 
## poly(x, degree = 4, raw = TRUE)4 
##                        1.0282139</code></pre>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="transformaciones.html#cb1155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_4c)</span></code></pre></div>
<pre><code>## (Intercept)           x      I(x^2)      I(x^3)      I(x^4) 
##   2.9996256  -0.3880250  -6.1511166   0.1269046   1.0282139</code></pre>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="transformaciones.html#cb1157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unname</span>(<span class="fu">coef</span>(fit_4a))</span></code></pre></div>
<pre><code>## [1]  -1.980036  -2.053929 -49.344752   0.669874  20.519759</code></pre>
<div class="sourceCode" id="cb1159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1159-1"><a href="transformaciones.html#cb1159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unname</span>(<span class="fu">coef</span>(fit_4b))</span></code></pre></div>
<pre><code>## [1]  2.9996256 -0.3880250 -6.1511166  0.1269046  1.0282139</code></pre>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="transformaciones.html#cb1161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unname</span>(<span class="fu">coef</span>(fit_4c))</span></code></pre></div>
<pre><code>## [1]  2.9996256 -0.3880250 -6.1511166  0.1269046  1.0282139</code></pre>
<div class="sourceCode" id="cb1163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1163-1"><a href="transformaciones.html#cb1163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">fitted</span>(fit_4a),</span>
<span id="cb1163-2"><a href="transformaciones.html#cb1163-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">fitted</span>(fit_4b))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1165-1"><a href="transformaciones.html#cb1165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">resid</span>(fit_4a),</span>
<span id="cb1165-2"><a href="transformaciones.html#cb1165-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">resid</span>(fit_4b))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1167-1"><a href="transformaciones.html#cb1167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_4a)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ poly(x, degree = 4), data = data_higher)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6982 -2.0334  0.0042  1.9532  7.4626 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -1.9800     0.1767 -11.205  &lt; 2e-16 ***
## poly(x, degree = 4)1  -2.0539     2.7940  -0.735    0.463    
## poly(x, degree = 4)2 -49.3448     2.7940 -17.661  &lt; 2e-16 ***
## poly(x, degree = 4)3   0.6699     2.7940   0.240    0.811    
## poly(x, degree = 4)4  20.5198     2.7940   7.344 3.06e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.794 on 245 degrees of freedom
## Multiple R-squared:  0.5993, Adjusted R-squared:  0.5928 
## F-statistic: 91.61 on 4 and 245 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="transformaciones.html#cb1169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_4c)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3) + I(x^4), data = data_higher)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6982 -2.0334  0.0042  1.9532  7.4626 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.9996     0.3315   9.048  &lt; 2e-16 ***
## x            -0.3880     0.3828  -1.014    0.312    
## I(x^2)       -6.1511     0.5049 -12.183  &lt; 2e-16 ***
## I(x^3)        0.1269     0.1456   0.871    0.384    
## I(x^4)        1.0282     0.1400   7.344 3.06e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.794 on 245 degrees of freedom
## Multiple R-squared:  0.5993, Adjusted R-squared:  0.5928 
## F-statistic: 91.61 on 4 and 245 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="función-de-inhibición" class="section level3" number="14.2.6">
<h3><span class="header-section-number">14.2.6</span> Función de inhibición</h3>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="transformaciones.html#cb1171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="transformaciones.html#cb1173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x      I(x^2) 
##   3.0649446  -0.5108131   5.0739805</code></pre>
<div class="sourceCode" id="cb1175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1175-1"><a href="transformaciones.html#cb1175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x<span class="sc">:</span>x, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
<div class="sourceCode" id="cb1177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1177-1"><a href="transformaciones.html#cb1177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">*</span> x, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
<div class="sourceCode" id="cb1179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1179-1"><a href="transformaciones.html#cb1179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
<div class="sourceCode" id="cb1181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1181-1"><a href="transformaciones.html#cb1181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
<div class="sourceCode" id="cb1183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1183-1"><a href="transformaciones.html#cb1183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">I</span>(x <span class="sc">+</span> x), <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)    I(x + x) 
##   -18.32715    12.43582</code></pre>
<div class="sourceCode" id="cb1185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1185-1"><a href="transformaciones.html#cb1185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x, <span class="at">data =</span> quad_data))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   -18.32715    24.87163</code></pre>
</div>
<div id="ejemplo-con-datos" class="section level3" number="14.2.7">
<h3><span class="header-section-number">14.2.7</span> Ejemplo con datos</h3>
<div class="sourceCode" id="cb1187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1187-1"><a href="transformaciones.html#cb1187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(autompg)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-553-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1188-1"><a href="transformaciones.html#cb1188-1" aria-hidden="true" tabindex="-1"></a>mpg_hp <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> autompg)</span>
<span id="cb1188-2"><a href="transformaciones.html#cb1188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1188-3"><a href="transformaciones.html#cb1188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1188-4"><a href="transformaciones.html#cb1188-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1188-5"><a href="transformaciones.html#cb1188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1188-6"><a href="transformaciones.html#cb1188-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mpg_hp, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1188-7"><a href="transformaciones.html#cb1188-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1188-8"><a href="transformaciones.html#cb1188-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp), <span class="fu">resid</span>(mpg_hp), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1188-9"><a href="transformaciones.html#cb1188-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1188-10"><a href="transformaciones.html#cb1188-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-554-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1189-1"><a href="transformaciones.html#cb1189-1" aria-hidden="true" tabindex="-1"></a>mpg_hp_log <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> autompg)</span>
<span id="cb1189-2"><a href="transformaciones.html#cb1189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1189-3"><a href="transformaciones.html#cb1189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1189-4"><a href="transformaciones.html#cb1189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1189-5"><a href="transformaciones.html#cb1189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1189-6"><a href="transformaciones.html#cb1189-6" aria-hidden="true" tabindex="-1"></a>xplot <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(autompg<span class="sc">$</span>hp), <span class="fu">max</span>(autompg<span class="sc">$</span>hp), <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1189-7"><a href="transformaciones.html#cb1189-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(mpg_hp_log, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">hp =</span> xplot)),</span>
<span id="cb1189-8"><a href="transformaciones.html#cb1189-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1189-9"><a href="transformaciones.html#cb1189-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1189-10"><a href="transformaciones.html#cb1189-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp_log), <span class="fu">resid</span>(mpg_hp_log), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1189-11"><a href="transformaciones.html#cb1189-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1189-12"><a href="transformaciones.html#cb1189-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-555-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1190-1"><a href="transformaciones.html#cb1190-1" aria-hidden="true" tabindex="-1"></a>mpg_hp_log <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> autompg)</span>
<span id="cb1190-2"><a href="transformaciones.html#cb1190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1190-3"><a href="transformaciones.html#cb1190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1190-4"><a href="transformaciones.html#cb1190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1190-5"><a href="transformaciones.html#cb1190-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> hp, <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1190-6"><a href="transformaciones.html#cb1190-6" aria-hidden="true" tabindex="-1"></a>xplot <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(autompg<span class="sc">$</span>hp), <span class="fu">max</span>(autompg<span class="sc">$</span>hp), <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1190-7"><a href="transformaciones.html#cb1190-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xplot, <span class="fu">predict</span>(mpg_hp_log, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">hp =</span> xplot)),</span>
<span id="cb1190-8"><a href="transformaciones.html#cb1190-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb1190-9"><a href="transformaciones.html#cb1190-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1190-10"><a href="transformaciones.html#cb1190-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp_log), <span class="fu">resid</span>(mpg_hp_log), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1190-11"><a href="transformaciones.html#cb1190-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1190-12"><a href="transformaciones.html#cb1190-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-556-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1191-1"><a href="transformaciones.html#cb1191-1" aria-hidden="true" tabindex="-1"></a>mpg_hp_loglog <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(hp), <span class="at">data =</span> autompg)</span>
<span id="cb1191-2"><a href="transformaciones.html#cb1191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1191-3"><a href="transformaciones.html#cb1191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1191-4"><a href="transformaciones.html#cb1191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> <span class="fu">log</span>(hp), <span class="at">data =</span> autompg, <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1191-5"><a href="transformaciones.html#cb1191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mpg_hp_loglog, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1191-6"><a href="transformaciones.html#cb1191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1191-7"><a href="transformaciones.html#cb1191-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mpg_hp_loglog), <span class="fu">resid</span>(mpg_hp_loglog), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb1191-8"><a href="transformaciones.html#cb1191-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residuales&quot;</span>)</span>
<span id="cb1191-9"><a href="transformaciones.html#cb1191-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-557-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1192-1"><a href="transformaciones.html#cb1192-1" aria-hidden="true" tabindex="-1"></a>big_model <span class="ot">=</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">*</span> hp <span class="sc">*</span> domestic, <span class="at">data =</span> autompg)</span></code></pre></div>
<div class="sourceCode" id="cb1193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1193-1"><a href="transformaciones.html#cb1193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(big_model), <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1193-2"><a href="transformaciones.html#cb1193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(big_model), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-559-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1194-1"><a href="transformaciones.html#cb1194-1" aria-hidden="true" tabindex="-1"></a>bigger_model <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(mpg) <span class="sc">~</span> disp <span class="sc">*</span> hp <span class="sc">*</span> domestic <span class="sc">+</span> </span>
<span id="cb1194-2"><a href="transformaciones.html#cb1194-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">I</span>(disp <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(hp <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> autompg)</span>
<span id="cb1194-3"><a href="transformaciones.html#cb1194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bigger_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(mpg) ~ disp * hp * domestic + I(disp^2) + I(hp^2), 
##     data = autompg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.40381 -0.08635 -0.01040  0.09995  0.71365 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       4.276e+00  2.564e-01  16.674   &lt;2e-16 ***
## disp             -5.289e-03  2.565e-03  -2.062   0.0399 *  
## hp               -7.386e-03  3.309e-03  -2.232   0.0262 *  
## domestic         -2.496e-01  2.787e-01  -0.896   0.3710    
## I(disp^2)         8.552e-06  4.141e-06   2.065   0.0396 *  
## I(hp^2)          -1.565e-05  1.679e-05  -0.932   0.3519    
## disp:hp           2.685e-05  3.082e-05   0.871   0.3842    
## disp:domestic    -1.101e-03  2.526e-03  -0.436   0.6631    
## hp:domestic       7.560e-03  3.689e-03   2.049   0.0411 *  
## disp:hp:domestic -2.311e-05  2.662e-05  -0.868   0.3859    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1507 on 373 degrees of freedom
## Multiple R-squared:  0.8107, Adjusted R-squared:  0.8062 
## F-statistic: 177.5 on 9 and 373 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1196-1"><a href="transformaciones.html#cb1196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(bigger_model), <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb1196-2"><a href="transformaciones.html#cb1196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(bigger_model), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="EstadisticaR_files/figure-html/unnamed-chunk-561-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="diagnóstico-de-modelos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="colinealidad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
